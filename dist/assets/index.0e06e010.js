var ao=Object.defineProperty,ro=Object.defineProperties;var io=Object.getOwnPropertyDescriptors;var Dt=Object.getOwnPropertySymbols;var lo=Object.prototype.hasOwnProperty,co=Object.prototype.propertyIsEnumerable;var Ot=(e,o,n)=>o in e?ao(e,o,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[o]=n,Se=(e,o)=>{for(var n in o||(o={}))lo.call(o,n)&&Ot(e,n,o[n]);if(Dt)for(var n of Dt(o))co.call(o,n)&&Ot(e,n,o[n]);return e},It=(e,o)=>ro(e,io(o));import{r as Z,v as uo,d as ce,u as t,o as $,c as M,a,b as G,e as Je,f as _,F as be,g as At,h as fe,i as de,j as oe,k as We,D as Qe,I as Rt,A as Lt,H as Tt,W as Pt,l as De,m as po,n as F,p as Oe,q as ne,s as fo,P as et,N as Et,t as Ut,S as Mt,w as Ht,x as se,y as Bt,Y as go,z as ho,C as mo,B as bo,E as yo,L as vo,G as ko,T as xo,J as wo,U as _o,K as So,M as $o,O as No,Q as Co,V as Do,R as Oo,X as Io,Z as Ft,_ as Ao,$ as ye,a0 as Ro,a1 as tt,a2 as Lo,a3 as O,a4 as ot,a5 as ae,a6 as Ie,a7 as ue,a8 as Ae,a9 as ge,aa as Re,ab as Le,ac as $e,ad as st,ae as Te,af as Pe,ag as To,ah as Po,ai as zt,aj as Ve,ak as jt,al as Wt,am as Eo,an as Ne,ao as Uo,ap as mt,aq as Mo,ar as Ee,as as Ue,at as Me,au as Ho,av as Bo,aw as Fo,ax as zo,ay as jo,az as Wo}from"./vendor.3d7716f8.js";const Vo=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))r(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const b of i.addedNodes)b.tagName==="LINK"&&b.rel==="modulepreload"&&r(b)}).observe(document,{childList:!0,subtree:!0});function n(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerpolicy&&(i.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?i.credentials="include":d.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(d){if(d.ep)return;d.ep=!0;const i=n(d);fetch(d.href,i)}};Vo();function Go(e={}){const{immediate:o=!1,onNeedRefresh:n,onOfflineReady:r,onRegistered:d,onRegisterError:i}=e;let b;const u=async(f=!0)=>{};return"serviceWorker"in navigator&&(b=new uo("/sw.js",{scope:"/"}),b.addEventListener("activated",f=>{f.isUpdate?window.location.reload():r==null||r()}),b.register({immediate:o}).then(f=>{d==null||d(f)}).catch(f=>{i==null||i(f)})),u}function Vt(e={}){const{immediate:o=!0,onNeedRefresh:n,onOfflineReady:r,onRegistered:d,onRegisterError:i}=e,b=Z(!1),u=Z(!1);return{updateServiceWorker:Go({immediate:o,onNeedRefresh(){b.value=!0,n==null||n()},onOfflineReady(){u.value=!0,r==null||r()},onRegistered:d,onRegisterError:i}),offlineReady:u,needRefresh:b}}const Ko={key:0,class:"pwa-toast",role:"alert"},Jo={class:"message"},qo={key:0},Zo={key:1},Xo=ce({setup(e){const{offlineReady:o,needRefresh:n,updateServiceWorker:r}=Vt(),d=async()=>{o.value=!1,n.value=!1};return(i,b)=>t(o)||t(n)?($(),M("div",Ko,[a("div",Jo,[t(o)?($(),M("span",qo," App ready to work offline ")):($(),M("span",Zo," New content available, click on reload button to update. "))]),t(n)?($(),M("button",{key:0,onClick:b[0]||(b[0]=u=>t(r)())},"Reload")):G("",!0),a("button",{onClick:d},"Close")])):G("",!0)}});const Yo=ce({setup(e){return(o,n)=>{const r=Je("router-view");return $(),M(be,null,[_(Xo),_(r)],64)}}}),Gt=()=>navigator.userAgent.indexOf("Mac OS X")!==-1,Qo=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),es=()=>{let e=!1;const o=document.createElement("div");if(CSS.supports("padding-bottom: env(safe-area-inset-bottom)")?(o.style.paddingBottom="env(safe-area-inset-bottom)",e=!0):CSS.supports("padding-bottom: constant(safe-area-inset-bottom)")&&(o.style.paddingBottom="constant(safe-area-inset-bottom)",e=!0),e){document.body.appendChild(o);const n=parseInt(window.getComputedStyle(o).paddingBottom);if(document.body.removeChild(o),n>0)return!0}return!1};function ts(e){return Gt()?e.metaKey:e.ctrlKey}const os=()=>"xxx-xxx-xxx".replace(/[xy]/g,function(e){const o=Math.random()*16|0;return(e=="x"?o:o&3|8).toString(16)}),bt=e=>e[Math.floor(Math.random()*e.length)],ss=()=>bt(["Isaac Newton","Friedrich Nietzsche","Johann Wolfgang von Goethe","Carl Jung","Steve Jobs","Ernesto Guevara","Robert M. Pirsig","Nikola Tesla","Leonardo da Vinci","Archimedes","Johannes Gutenberg","Galileo Galilei","Albert Einstein","Carl Benz","Steve Wozniak","Alfred Nobel","Hedy Lamarr","Ada Lovelace","Stephanie Kwolek","Grace Hopper","Konrad Zuse"]),ns=()=>bt(as()),as=()=>["#00a492","#00b1ff","#ffc711","#F98181","#b7f981","#81eff9","#8183f9","#d181f9","#f9ab81","#f9e181"],rs=e=>{let o="";if(Array.isArray(e))for(let n=0;n<e.length;n++)o+=e[n].text;else o=e;return o},is=e=>new Promise(o=>setTimeout(o,e)),ls=e=>{e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();const o="\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;",n="aaaaeeeeiiiioooouuuunc------";for(let r=0,d=o.length;r<d;r++)e=e.replace(new RegExp(o.charAt(r),"g"),n.charAt(r));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),e},cs=e=>Array.from(e.entries()).map(([o,n])=>Se({clientId:o},n.user));function ds(e,o,n){let r={};const d=e.getMap().get(o);d&&(r=d),r.title=n.title,r.count=3,r.updatedAt=new Date().toISOString(),r.guid||(r.guid=o),r.filled=!0,r.createdAt||(r.createdAt=new Date().toISOString()),e.getMap().set(o,r)}const ve=()=>({isMac:Gt,isMobile:Qo,hasNotch:es,osKey:ts,uuid:os,delay:is,getPlainText:rs,getRandomElement:bt,getRandomUser:ss,getRandomColor:ns,stringToSlug:ls,updateDoc:ds,awarenessStatesToArray:cs}),{uuid:us,getRandomUser:ps,getRandomColor:fs}=ve(),yt="1.2.3",gs="",hs="",ms="",Kt=!1,Jt=[],bs=e=>{E.value.debug&&console.log(e),E.value.debug&&Jt.push(e)},qt={debug:Kt,version:yt,useHocuspocus:!0,serverAddress:hs,serverToken:gs,useWebRtc:!1,signalingServerAddress:ms,localUserName:ps(),localUserId:us(),localUserColor:fs(),localWebRtcPassword:"",localLatestSpace:null,localLatestDocument:null,localLatestNode:null,isSettingsOpen:!1,isInfoOpen:!1,isSelectorOpen:!1,isSearchOpen:!1,isUserOpen:!1,isShareOpen:!1,isProviderOpen:!1,blurredInterface:!1,useLatestDocument:!0,showOtherColors:!0,showOtherUsers:!0,showOtherCursors:!0,useStrongGravity:!0,fixNodesOnDrag:!0,unfixLastNode:!0,zoomInOnNodeClick:!0,followNewlyCreatedNode:!0,followNewlyCreatedNodeMention:!0},E=At("local-lity-states",qt),ys=()=>{E.value=qt},Zt=()=>{E.value.isSelectorOpen=!1,E.value.isSearchOpen=!1,E.value.isSettingsOpen=!1,E.value.isInfoOpen=!1,E.value.isProviderOpen=!1,E.value.isUserOpen=!1,E.value.isShareOpen=!1,E.value.useWebRtc=!1,E.value.version<yt&&(E.value.version=yt,E.value.isInfoOpen=!0),E.value.blurredInterface&&(E.value.blurredInterface=!1,setTimeout(()=>{E.value.blurredInterface=!0},1e3))},vs=()=>{},ks=e=>{E.value.isSelectorOpen=e==="selector"?!E.value.isSelectorOpen:!1,E.value.isSearchOpen=e==="search"?!E.value.isSearchOpen:!1,E.value.isSettingsOpen=e==="settings"?!E.value.isSettingsOpen:!1,E.value.isInfoOpen=e==="info"?!E.value.isInfoOpen:!1,E.value.isProviderOpen=e==="provider"?!E.value.isProviderOpen:!1,E.value.isUserOpen=e==="user"?!E.value.isUserOpen:!1,E.value.isShareOpen=e==="share"?!E.value.isShareOpen:!1},xs=e=>{E.value.isSelectorOpen=!E.value.isSelectorOpen},ws=e=>{E.value.isSearchOpen=!E.value.isSearchOpen},_s=e=>{E.value.isSettingsOpen=!E.value.isSettingsOpen},Ss=e=>{E.value.isInfoOpen=!E.value.isInfoOpen},$s=e=>{E.value.isProviderOpen=!E.value.isProviderOpen},Ns=e=>{E.value.isUserOpen=!E.value.isUserOpen},Cs=e=>{E.value.isShareOpen=!E.value.isShareOpen};Zt();const re=()=>({state:E,debug:Kt,debugLog:Jt,toggleOnly:ks,logger:bs,checkForOpenWindows:vs,toggleSelector:xs,toggleSearch:ws,toggleSettings:_s,toggleProvider:$s,toggleInfo:Ss,toggleUser:Ns,toggleShare:Cs,setDefaults:ys,setAppDefaults:Zt}),{uuid:vt,stringToSlug:Ds}=ve(),ke=At("local-lity-spaces",{spaces:[]}),nt=()=>{const e=fe(),o=de(),n=Z(!1),r=oe(()=>o.params.space),d=oe(()=>o.params.space&&f(o.params.space)?f(o.params.space).url:""),i=oe(()=>o.params.space&&f(o.params.space)?f(o.params.space).token:""),b=()=>{g(),n.value=!0},u=(S,R,j,T)=>{const A=R?Ds(R):vt(),H={id:S||A,name:R||"LocalStorage",url:j||null,token:T||null,index:o.params.document||vt()};ke.value.spaces.push(H)},f=S=>{for(let R=0;R<ke.value.spaces.length;R++)if(ke.value.spaces[R].id===S)return ke.value.spaces[R];return null},I=()=>ke.value.spaces[0],g=()=>{ke.value.spaces.length===0?p():(o.params.space&&(f(o.params.space)||u(o.params.space,"Shared Space",null,null)),o.params.space||C(I()),o.params.space&&!o.params.document&&C(f(o.params.space)))},p=()=>{ke.value.spaces=[],u(),u("causa-lity-cc","Lity.CC (readme only)","wss://causa.lity.cc","READ-ME-ONLY"),u("y","LocalStorage (previous versions)"),o.params.space?f(o.params.space)||u(o.params.space,"Shared Space",null,null):C(I())},w=(S,R)=>{if(S&&R)for(let j=0;j<ke.value.spaces.length;j++)ke.value.spaces[j].id===S&&(ke.value.spaces[j].index=R)},C=S=>{e.push(`/${S.id}/${S.index}/index`)};return{localSpaces:ke,resetSpaces:p,redirect:b,isRedirected:n,spaceId:r,spaceUrl:d,spaceToken:i,setIndex:w,getSpace:f,createSpace:u,setGravity:S=>{const R=S||vt();e.push(`/${o.params.space}/${R}/index`)},createDefaultSpace:g}};nt();const Os=e=>{const o=We({hasLoadedRootDoc:!1}),n=new Qe({guid:e,autoLoad:!0}),r=n.getMap(),d=n.getMap("settings"),i=n.getText("latest"),b=new Rt(e,n),u=Z();return b.once("synced",()=>{o.hasLoadedRootDoc=!0,u.value=Object.entries(r.toJSON());for(let f=0;f<u.value.length;f++)u.value[f][1].filled||r.delete(u.value[f][1].guid);r.observe(()=>{u.value=Object.entries(r.toJSON())})}),{rootState:o,yRootDoc:n,yRootDocs:r,yRootSettings:d,yRootLatestDoc:i,yRootIndexedDb:b,jRootDocs:u}},{awarenessStatesToArray:Is}=ve(),As=e=>{const{state:o,logger:n}=re(),r=We({hocuspocus:{init:!1,connected:!1,authenticated:!1,readOnly:!1,awareness:[]},rtc:{init:!1,connected:!1,readOnly:!1,awareness:[]}});let d,i;const b=new Lt(e),u=(p,w)=>{p&&(d=new Tt({url:p,name:e.guid,document:e,token:w,awareness:b,onAwarenessUpdate:({states:C})=>{r.hocuspocus.awareness=C},onConnect:()=>{r.hocuspocus.connected=!0},onAuthenticated:()=>{},onAuthenticationFailed:()=>{},onMessage:({event:C,message:K})=>{},onClose:({event:C})=>{r.hocuspocus.connected=!1},onDisconnect:({event:C})=>{r.hocuspocus.connected=!1}}),r.hocuspocus.init=!0,d.setAwarenessField("user",{name:o.value.localUserName,color:o.value.localUserColor}))},f=()=>{i=new Pt(e.guid,e,{awareness:b,password:o.value.localWebRtcPassword}),r.rtc.init=!0,r.rtc.connected=!0,i.awareness.setLocalStateField("user",{name:o.value.localUserName,color:o.value.localUserColor}),i.awareness.on("update",()=>{r.rtc.awareness=Is(i.awareness.states)})},I=()=>d.destroy();r.hocuspocus.connected=!1;const g=()=>i.destroy();return r.rtc.connected=!1,De(()=>{d&&I(),i&&g()}),{rootStates:r,rootHocuspocusProvider:d,rootWebRtcProvider:i,rootAwareness:b,provideRootHocuspocus:u,provideRootWebRtc:f,destroyRootHocuspocus:I,destroyRootWebRtc:g}};var kt=(e,o)=>{for(const[n,r]of o)e[n]=r;return e};const Rs={props:{icon:{type:String,required:!0},title:{type:String,required:!0},action:{type:Function,required:!0},isActive:{type:Function,default:null}},data(){return{remixiconUrl:po}}},Ls=["title"],Ts={class:"remix"},Ps=["xlink:href"];function Es(e,o,n,r,d,i){return $(),M("button",{class:F(["menu-item text-black dark:text-white hover:bg-opacity-50 hover:bg-gray-300 dark:hover:bg-gray-800",{"bg-gray-200 dark:bg-gray-900 text-blue-500 dark:text-blue-500":n.isActive?n.isActive():null}]),title:n.title,onClick:o[0]||(o[0]=(...b)=>n.action&&n.action(...b))},[($(),M("svg",Ts,[a("use",{"xlink:href":`${d.remixiconUrl}#ri-${n.icon}`},null,8,Ps)]))],10,Ls)}var Us=kt(Rs,[["render",Es]]);const Ms={components:{MenuItem:Us},props:{editor:{type:Object,required:!0},pane:{type:Object}},data(){return{items:[{icon:"bold",title:"Bold",action:()=>this.editor.chain().focus().toggleBold().run(),isActive:()=>this.editor.isActive("bold")},{icon:"italic",title:"Italic",action:()=>this.editor.chain().focus().toggleItalic().run(),isActive:()=>this.editor.isActive("italic")},{icon:"strikethrough",title:"Strike",action:()=>this.editor.chain().focus().toggleStrike().run(),isActive:()=>this.editor.isActive("strike")},{icon:"code-view",title:"Code",action:()=>this.editor.chain().focus().toggleCode().run(),isActive:()=>this.editor.isActive("code")},{icon:"mark-pen-line",title:"Highlight",action:()=>this.editor.chain().focus().toggleHighlight().run(),isActive:()=>this.editor.isActive("highlight")},{type:"divider"},{icon:"h-1",title:"Heading 1",action:()=>this.editor.chain().focus().toggleHeading({level:1}).run(),isActive:()=>this.editor.isActive("heading",{level:1})},{icon:"h-2",title:"Heading 2",action:()=>this.editor.chain().focus().toggleHeading({level:2}).run(),isActive:()=>this.editor.isActive("heading",{level:2})},{icon:"paragraph",title:"Paragraph",action:()=>this.editor.chain().focus().setParagraph().run(),isActive:()=>this.editor.isActive("paragraph")},{icon:"list-unordered",title:"Bullet List",action:()=>this.editor.chain().focus().toggleBulletList().run(),isActive:()=>this.editor.isActive("bulletList")},{icon:"list-ordered",title:"Ordered List",action:()=>this.editor.chain().focus().toggleOrderedList().run(),isActive:()=>this.editor.isActive("orderedList")},{icon:"list-check-2",title:"Task List",action:()=>this.editor.chain().focus().toggleTaskList().run(),isActive:()=>this.editor.isActive("taskList")},{icon:"code-box-line",title:"Code Block",action:()=>this.editor.chain().focus().toggleCodeBlock().run(),isActive:()=>this.editor.isActive("codeBlock")},{type:"divider"},{icon:"double-quotes-l",title:"Blockquote",action:()=>this.editor.chain().focus().toggleBlockquote().run(),isActive:()=>this.editor.isActive("blockquote")},{icon:"separator",title:"Horizontal Rule",action:()=>this.editor.chain().focus().setHorizontalRule().run()},{type:"divider"},{icon:"text-wrap",title:"Hard Break",action:()=>this.editor.chain().focus().setHardBreak().run()},{icon:"format-clear",title:"Clear Format",action:()=>this.editor.chain().focus().clearNodes().unsetAllMarks().run()},{type:"divider"},{icon:"arrow-go-back-line",title:"Undo",action:()=>this.editor.chain().focus().undo().run()},{icon:"arrow-go-forward-line",title:"Redo",action:()=>this.editor.chain().focus().redo().run()},{type:"divider"}]}}},Hs={class:"pl-3 pr-3"};function Bs(e,o,n,r,d,i){const b=Je("menu-item");return $(),M("div",Hs,[($(!0),M(be,null,Oe(d.items,(u,f)=>($(),M(be,null,[u.type==="divider"?($(),M("span",{key:`divider${f}`,class:"divider w-8"})):($(),ne(b,fo({key:1,key:f},u),null,16))],64))),256))])}var Fs=kt(Ms,[["render",Bs]]);const zs=new et("mention"),js=Et.create({name:"mention",addOptions(){return{HTMLAttributes:{},renderLabel({options:e,node:o}){return`${o.attrs.label}`},suggestion:{char:"@",pluginKey:zs,command:({editor:e,range:o,props:n})=>{var i;const r=e.view.state.selection.$to.nodeAfter;((i=r==null?void 0:r.text)==null?void 0:i.startsWith(" "))&&(o.to+=1),e.chain().focus().insertContentAt(o,[{type:this.name,attrs:n},{type:"text",text:" "}]).run()},allow:({editor:e,range:o})=>{const n=e.state.doc.resolve(o.from),r=e.schema.nodes[this.name];return!!n.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,draggable:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:"span[data-mention]"}]},renderHTML({node:e,HTMLAttributes:o}){return["span",Ut({"data-mention":"",class:"dark:bg-gray-700 dark:text-gray-200"},this.options.HTMLAttributes,o),this.options.renderLabel({options:this.options,node:e})]},renderText({node:e}){return this.options.renderLabel({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:o})=>{let n=!1;const{selection:r}=o,{empty:d,anchor:i}=r;return d?(o.doc.nodesBetween(i-1,i,(b,u)=>{if(b.type.name===this.name)return n=!0,e.insertText(this.options.suggestion.char||"",u,u+b.nodeSize),!1}),n):!1})}},addProseMirrorPlugins(){return[Mt(Se({editor:this.editor},this.options.suggestion)),new Ht({key:new et("handleClick"),props:{handleClick:(e,o,n)=>{var d;const r=(d=n.target)==null?void 0:d.closest("span.mention");if(r){const i=window.location.href.match("(.*)#\\/(.+)\\/");return window.location.href=i[1]+"#/"+i[2]+"/"+r.getAttribute("data-id"),!0}return!1}}})]}});const Ws={props:{items:{type:Array,required:!0},command:{type:Function,required:!0}},data(){return{selectedIndex:0}},watch:{items(){this.selectedIndex=0}},methods:{onKeyDown({event:e}){return e.key==="ArrowUp"?(this.upHandler(),!0):e.key==="ArrowDown"?(this.downHandler(),!0):e.key==="Enter"?(this.enterHandler(),!0):!1},upHandler(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler(){this.selectItem(this.selectedIndex)},selectItem(e){const o=this.items[e];o&&this.command({id:o.id,label:o.label})}}},Vs={class:"items text-sm bg-white dark:bg-black shadow-xl backdrop-filter backdrop-blur2 backdrop-blur-lg font-mono p-0.5"},Gs=["onClick"];function Ks(e,o,n,r,d,i){return $(),M("div",Vs,[($(!0),M(be,null,Oe(n.items,(b,u)=>($(),M("button",{key:u,class:F(["item text-gray-700 dark:text-gray-200 rounded-sm",{"dark:bg-blue-600 bg-blue-300 text-white ring-2 ring-blue-600 ":u===d.selectedIndex}]),onClick:f=>i.selectItem(u)},se(b.label),11,Gs))),128))])}var Js=kt(Ws,[["render",Ks],["__scopeId","data-v-59e8ae84"]]);const{awarenessStatesToArray:qs}=ve(),Xt=()=>{const{state:e,logger:o}=re(),n=We({init:!1,hocuspocus:{init:!1,connected:!1,authenticated:!1,readOnly:!1,awareness:[]},rtc:{init:!1,connected:!1,readOnly:!1,awareness:[]}});let r,d;const i=p=>(d=p,r=new Lt(d),r);let b,u;const f=(p,w)=>!p&&!w?null:(b=new Tt({url:p,name:d.guid,document:d,token:w,awareness:r,onAwarenessUpdate:({states:C})=>{n.hocuspocus.awareness=C},onConnect:()=>{},onAuthenticated:()=>{},onAuthenticationFailed:()=>{},onMessage:({event:C,message:K})=>{},onClose:({event:C})=>{},onDisconnect:({event:C})=>{}}),n.hocuspocus.init=!0,b.setAwarenessField("user",{name:e.value.localUserName,color:e.value.localUserColor}),g(),b),I=()=>(u=new Pt(d.guid,d,{awareness:r,password:e.value.localWebRtcPassword}),n.rtc.init=!0,n.rtc.connected=!0,u.awareness.setLocalStateField("user",{test1:!0,name:e.value.localUserName,color:e.value.localUserColor}),u.awareness.on("update",()=>{n.rtc.awareness=qs(u.awareness.states)}),u),g=()=>{r.setLocalStateField("user",{latestDocument:"route.params.document",latestNode:"route.params.node",test:!0,name:e.value.localUserName,color:e.value.localUserColor})};return{subStates:n,subAwareness:r,subWebRtcProvider:u,subHocuspocusProvider:b,provideAwareness:i,provideSubHocuspocus:f,provideSubWebRtc:I}},Zs=new et("meta");Et.create({name:"meta",addOptions(){return{HTMLAttributes:{},renderLabel({options:e,node:o}){return`${o.attrs.label}`},suggestion:{char:"#",pluginKey:Zs,command:({editor:e,range:o,props:n})=>{var i;const r=e.view.state.selection.$to.nodeAfter;((i=r==null?void 0:r.text)==null?void 0:i.startsWith(" "))&&(o.to+=1),e.chain().focus().insertContentAt(o,[{type:this.name,attrs:n},{type:"text",text:" "}]).run()},allow:({editor:e,range:o})=>{const n=e.state.doc.resolve(o.from),r=e.schema.nodes[this.name];return!!n.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,draggable:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:"span[data-meta]"}]},renderHTML({node:e,HTMLAttributes:o}){return["i",Ut({"data-meta":"",class:"dark:bg-gray-700 dark:text-gray-200 ri-"+e.attrs.label+"-fill"},this.options.HTMLAttributes,o)]},renderText({node:e}){return this.options.renderLabel({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:o})=>{let n=!1;const{selection:r}=o,{empty:d,anchor:i}=r;return d?(o.doc.nodesBetween(i-1,i,(b,u)=>{if(b.type.name===this.name)return n=!0,e.insertText(this.options.suggestion.char||"",u,u+b.nodeSize),!1}),n):!1})}},addProseMirrorPlugins(){return[Mt(Se({editor:this.editor},this.options.suggestion)),new Ht({key:new et("handleClick"),props:{handleClick:(e,o,n)=>{var d;const r=(d=n.target)==null?void 0:d.closest("span.meta");if(r){const i=window.location.href.match("(.*)#\\/(.+)\\/");return window.location.href=i[1]+"#/"+i[2]+"/"+r.getAttribute("data-id"),!0}return!1}}})]}});const Xs=Bt.extend({content:"heading block*"}),{state:Ge,logger:Qi}=re();Xt();const Ys=(e,o,n,r,d,i)=>{const b=de();fe(),Z([]);const{isMobile:u,getPlainText:f,delay:I}=ve(),g=o.getMap("nodes"),p=o.getMap("links"),w=new go,C=g.get(n);let K;const S=[Xs,ho.configure({history:!1,document:!1,codeBlock:!1}),mo.configure({lowlight:bo}),yo.configure({placeholder:({node:c})=>c.type.name==="heading"?C&&C.href?"Type a title for "+C.href:"Type a title for "+n:"/"}),vo,ko,xo,wo,_o,So,$o,No,Co,js.configure({HTMLAttributes:{class:"mention"},suggestion:{allowSpaces:!0,items:({query:c})=>{const h=Object.values(g.toJSON()),y=[];return h.forEach(N=>{const D=N.id!==N.title?f(N.title):N.title;y.push({id:N.id,label:D})}),c.length>0&&y.push({id:Math.floor(new Date().getTime()+Math.random()),label:c}),y.filter(N=>N.label.toLowerCase().includes(c.toLowerCase())).slice(0,10)},render:()=>{let c,h;return{onStart:y=>{c=new Do(Js,{props:y,editor:y.editor}),h=Oo("body",{getReferenceClientRect:y.clientRect,appendTo:()=>document.body,content:c.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate(y){c.updateProps(y),h[0].setProps({getReferenceClientRect:y.clientRect})},onKeyDown(y){var N;return y.event.key==="Escape"?(h[0].hide(),!0):(N=c.ref)==null?void 0:N.onKeyDown(y)},onExit(){h[0].destroy(),c.destroy()}}}}}),Io.configure({document:o,field:n})];r&&Ge.value.showOtherCursors&&S.push(Ft.configure({provider:r,user:{name:Ge.value.localUserName,color:Ge.value.localUserColor}})),d&&!r&&Ge.value.showOtherCursors&&S.push(Ft.configure({provider:d,user:{name:Ge.value.localUserName,color:Ge.value.localUserColor}}));let R=!1;const j=new Ao({autofocus:!1,extensions:S,onCreate({editor:c}){B(c),W(),K=setTimeout(()=>{c.commands.focus("end")},500)},onUpdate({editor:c}){e("onUpdate"),W();function h(y,N){let D={};const L=y.getMap().get(N);L&&(D=L),D.updatedAt=new Date().toISOString(),D.guid||(D.guid=N),D.filled=!0,D.createdAt||(D.createdAt=new Date().toISOString()),y.getMap().set(N,D)}R&&h(i,b.params.document),R||(R=!0),K&&(clearTimeout(K),K=setTimeout(()=>{B(c)},200))},onFocus({editor:c}){e("onFocus"),W()},onBlur({editor:c}){e("onBlur")}}),T=c=>{const h=[];let y;function N(D){if(Array.isArray(D)){for(let L=0;L<D.length;L++)if(Array.isArray(D[L].content))for(let U=0;U<D[L].content.length;U++)if(Array.isArray(D[L].content)&&Array.isArray(D[L].content[U].marks)){if(D[L].content[U]){y={title:void 0,href:void 0},y.title=D[L].content[U].text;for(let P=0;P<D[L].content[U].marks.length;P++)D[L].content[U].marks[P].attrs&&D[L].content[U].marks[P].attrs.href&&(y.href=D[L].content[U].marks[P].attrs.href.replace(/\/$/,""),h.push(y))}}else D[L].content[U].content&&N(D[L].content[U].content)}}return N(c),h},A=c=>{const h=[];let y;function N(D){if(Array.isArray(D)){for(let L=0;L<D.length;L++)if(Array.isArray(D[L].content)){for(let U=0;U<D[L].content.length;U++)if(Array.isArray(D[L].content)){const V=D[L].content[U];V.type==="mention"?(y={title:V.attrs.label,id:V.attrs.id},h.push(y)):V.content&&N(V.content)}}}}return N(c),h};function H(c){c=c.replace(/^\s+|\s+$/g,""),c=c.toLowerCase();const h="\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;",y="aaaaeeeeiiiioooouuuunc------";for(let N=0,D=h.length;N<D;N++)c=c.replace(new RegExp(h.charAt(N),"g"),y.charAt(N));return c=c.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),c}function B(c){let h={id:n,title:n,group:1,created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]};const y=g.get(n);y&&(h=y,h.created||(h.created=new Date().toISOString(),g.set(n,h)));const N=c.getJSON().content;if(N&&N[0]){const D=N[0].content?N[0].content:"";if(D&&f(D)!==f(h.title)&&(h.title=D,g.set(n,h),n==="index"?function(U,V){let P={};const J=U.getMap().get(V);J&&(P=J),P.title=h.title,P.updatedAt=new Date().toISOString(),P.guid||(P.guid=V),P.filled=!0,P.createdAt||(P.createdAt=new Date().toISOString()),U.getMap().set(V,P)}(i,b.params.document):function(U,V){let P={};const J=U.getMap().get(V);J&&(P=J),P.updatedAt=new Date().toISOString(),P.guid||(P.guid=V),P.filled=!0,P.createdAt||(P.createdAt=new Date().toISOString()),U.getMap().set(V,P)}(i,b.params.document)),D||N[0]&&!N[0].content&&h.id!==f(h.title)&&(g.set(n,h),h.href?c.commands.setContent(`<a href="${h.href}">${h.title}</a>`):c.commands.setContent(h.title)),N&&N.length>=1){const L=A(N),U=T(N);for(let V=0;V<L.length;V++){const P=n.toString(),J=L[V].id.toString(),ie=p.get(P+"_"+J),he=g.get(J);!ie&&!he?(g.set(J,{id:J,group:1,title:""+L[V].title+"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[P],links:[P]}),(async()=>{await I(100),p.set(P+"_"+J,{target:J,source:P,value:0})})()):!ie&&he&&(async()=>{await I(100),p.set(P+"_"+J,{target:J,source:P,value:0})})()}for(let V=0;V<U.length;V++){const P=n,J=U[V].href,ie=H(J),he=g.get(ie);if((!he||he.href!==J)&&(g.set(ie,{id:ie,group:1,title:J,created:new Date().toISOString(),updated:new Date().toISOString(),href:J,neighbors:[P],links:[P]}),p.set(ie+"_"+P,{target:P,source:ie,value:0})),he){const xe=n,me=H(J);g.get(me+"_"+xe)||p.set(me+"_"+xe,{target:xe,source:me,value:0})}}}}}function W(){const c=document.getElementsByClassName("ProseMirror")[0];c&&c.clientHeight<=35?e("bottom"):c&&c.clientHeight>=36&&c.clientHeight<=229&&e("middle"),c&&c.clientHeight>=230&&e("top")}return{yNodes:g,yLinks:p,yxmlText:w,currentNode:C,editor:j,getAllLinks:T,getAllMentions:A,stringToSlug:H,managePane:B,changePane:W}};const Qs=a("i",{class:"ri-arrow-left-circle-fill text-2xl"},null,-1),en=[Qs],tn=a("i",{class:"ri-arrow-right-circle-fill text-2xl"},null,-1),on=[tn],sn=a("i",{class:"ri-close-circle-fill text-2xl"},null,-1),nn=[sn],an=ce({props:{yRootDoc:null,yRootDocs:null,jRootDocs:null,ySubDoc:null,ySubDocIndexedDb:null,ySubDocs:null,jSubDocs:null,spaceId:null,docId:null,nodeId:null,hocuspocusProvider:null,webRtcProvider:null,subStates:null,paneVisible:null,paneState:null},emits:["onFocus","onBlur","onUpdate","bottom","middle","top","hide","back","forward","switch"],setup(e,{emit:o}){const n=e,r=()=>{const b=document.getElementsByClassName("editor__content")[0];b.scrollTop<=-50&&o("bottom"),b.scrollTop>=50&&o("top")},{state:d}=re(),{editor:i}=Ys(o,n.ySubDoc,n.nodeId,n.hocuspocusProvider,n.webRtcProvider,n.yRootDoc);return De(()=>{i.destroy()}),(b,u)=>($(),M(be,null,[t(i)?($(),M("div",{key:0,style:{width:"100%","margin-top":"-1px"},class:F(["mt-0 m-0 rounded-t-lg fixed z-20 top-0 flex bg-white dark:bg-lityblack",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(d).blurredInterface}])},[a("button",{class:"relative pt-0 p-1 pl-0 ml-3 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:u[0]||(u[0]=f=>o("back"))},en),a("button",{class:"relative pt-0 p-1 pl-0 ml-1 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:u[1]||(u[1]=f=>o("forward"))},on),_(Fs,{class:"editor__header my-2 w-auto mx-auto overflow-x-scroll whitespace-nowrap",editor:t(i)},null,8,["editor"]),a("button",{class:"relative pt-0 p-1 pr-0 mr-1 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:u[2]||(u[2]=f=>o("switch"))},[a("i",{class:F(["text-2xl",{"ri-arrow-down-circle-fill":e.paneState==="top","ri-arrow-up-circle-fill":e.paneState!=="top"}])},null,2)]),a("button",{class:"relative pt-0 p-1 pr-0 mr-3 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:u[3]||(u[3]=f=>o("hide"))},nn)],2)):G("",!0),t(i)?($(),ne(t(Ro),{key:1,onScroll:r,onClick:u[4]||(u[4]=ye(f=>t(i).commands.focus("end"),["self"])),class:"editor__content dark:text-white fixed top-0 bottom-10 left-0 right-0 overflow-y-scroll p-3 pt-12 select-auto",style:{height:"calc(95%)"},editor:t(i)},null,8,["editor"])):G("",!0)],64))}}),rn={class:"flex flex-col flex-nowrap items-center rounded-t-md rounded-b-md"},ln={class:"relative z-0 inline-flex"},cn=a("input",{id:"input",class:"hidden",type:"text"},null,-1),dn=a("i",{class:"ri-asterisk text-2xl"},null,-1),un=[dn],pn=a("i",{class:"ri-search-line text-2xl"},null,-1),fn=[pn],gn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),hn=a("i",{class:"ri-refresh-line text-2xl"},null,-1),mn=[hn],bn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),yn=a("i",{class:"ri-share-fill text-2xl"},null,-1),vn=[yn],kn=a("i",{class:"ri-add-circle-fill text-2xl"},null,-1),xn=[kn],wn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),_n=a("i",{class:"ri-delete-bin-fill text-2xl"},null,-1),Sn=[_n],$n=a("i",{class:"ri-scissors-fill text-2xl"},null,-1),Nn=[$n],Cn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),Dn=a("i",{class:"ri-arrow-go-back-fill text-2xl"},null,-1),On=[Dn],In=a("i",{class:"ri-arrow-go-forward-fill text-2xl"},null,-1),An=[In],Rn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),Ln=a("i",{class:"ri-settings-5-fill text-2xl"},null,-1),Tn=[Ln],Pn=ce({props:{unlinkingNodes:null,linkingNodes:null,deletingNodes:null},emits:["linkNodes","unlinkNodes","createNode","deleteNode","refreshGraph","undo","redo"],setup(e,{emit:o}){const n=e,r=tt();Lo(r);const{state:d,toggleInfo:i,toggleSettings:b,toggleSearch:u,toggleSelector:f}=re();return(I,g)=>($(),M("div",{style:{width:"22em"},class:F(["transition top-pane rounded-lg transition-all duration-500 ease-in-out bg-white dark:bg-lityblack absolute follower-bar ml-auto mr-auto left-0 right-0 z-10",{"dark:bg-lityblackblur bg-opacity-50 backdrop-filter backdrop-blur":t(d).blurredInterface,blur2:t(r)}])},[a("div",rn,[a("span",ln,[cn,a("button",{class:"tooltip -ml-px pl-1.5 pr-0.5 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[0]||(g[0]=(...p)=>t(f)&&t(f)(...p))},un),a("button",{type:"button",class:"tooltip p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",onClick:g[1]||(g[1]=(...p)=>t(u)&&t(u)(...p))},fn),gn,a("button",{class:"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[2]||(g[2]=p=>o("refreshGraph"))},mn),bn,a("button",{class:F([{"text-black":!n.linkingNodes,"text-blue-500 dark:text-blue-500 animate-pulse":n.linkingNodes},"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[3]||(g[3]=p=>o("linkNodes"))},vn,2),a("button",{class:"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[4]||(g[4]=p=>o("createNode"))},xn),wn,a("button",{class:F([{"text-black":!n.deletingNodes,"text-red-500 dark:text-red-500 animate-pulse":n.deletingNodes},"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[5]||(g[5]=p=>o("deleteNode"))},Sn,2),a("button",{class:F([{"text-black":!n.unlinkingNodes,"text-yellow-500 dark:text-yellow-500 animate-pulse":n.unlinkingNodes},"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[6]||(g[6]=p=>o("unlinkNodes"))},Nn,2),Cn,a("button",{class:F([{"text-black":!n.unlinkingNodes,"text-yellow-500 dark:text-yellow-500 animate-pulse":n.unlinkingNodes},"tooltip -ml-px p-0.5 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[7]||(g[7]=p=>o("undo"))},On,2),a("button",{class:F([{"text-black":!n.unlinkingNodes,"text-yellow-500 dark:text-yellow-500 animate-pulse":n.unlinkingNodes},"tooltip -ml-px p-0.5 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[8]||(g[8]=p=>o("redo"))},An,2),Rn,a("button",{class:"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[9]||(g[9]=(...p)=>t(b)&&t(b)(...p))},Tn)])])],2))}}),En={key:0,class:"font-medium leading-none text-white text-shadow-lg"},Un={key:0,class:""},Mn={key:1,class:"mx-3"},Hn=ce({props:{route:null,state:null},emits:["setStates"],setup(e,{emit:o}){const n=Z(!1);return(r,d)=>{const i=Je("router-link");return $(),ne(i,{onMouseenter:d[0]||(d[0]=b=>n.value=!0),onMouseleave:d[1]||(d[1]=b=>n.value=!1),disabled:!e.state.user.latestDocument,to:`/${e.route.params.space}/${e.state.user.latestDocument}/${e.state.user.latestNode?e.state.user.latestNode:"index"}`,tabindex:"1",onClick:d[2]||(d[2]=b=>o("setStates")),class:F(["inline-flex transition transition-all ease-in-out duration-500 group items-center justify-center h-10 w-10 rounded-full mr-2",{"w-auto":n.value}]),style:ot("background: "+e.state.user.color)},{default:O(()=>[e.state.user&&e.state.user.name?($(),M("span",En,[n.value?G("",!0):($(),M("span",Un,se(e.state.user.name.split(/\s/).reduce((b,u)=>b+=u.slice(0,1),"")),1)),n.value?($(),M("span",Mn,se(e.state.user.name),1)):G("",!0)])):G("",!0)]),_:1},8,["disabled","to","class","style"])}}}),Bn={class:"fixed inset-0 z-50 dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 overflow-y-auto"},Fn={class:"text-center"},zn=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),jn={class:"m-3"};const Wn={key:1,class:"relative mb-3 z-0 w-full inline-flex"},Vn=["onKeydown"],Gn={class:"absolute inset-y-0 right-0 flex py-0.5 pr-1.5"},Kn=a("i",{class:"ri-close-circle-fill text-2xl"},null,-1),Jn=[Kn],qn={key:0,class:"relative mt-3 z-0 overflow-ellipsis w-full overflow-x-scroll"},Zn={role:"list",style:{"max-height":"50vh"}},Xn={style:{"min-width":"300px"},class:"px-2 py-0"},Yn={class:"flex justify-between"},Qn={class:"flex"},ea={class:"flex items-center font-bold text-sm w-64 overflow-ellipsis"},ta=a("div",{class:"mt-2 flex items-center mt-0"},null,-1),oa={class:"mt-1 flex items-center mb-1"},sa={class:"px-2 w-28 text-sm font-medium"},na=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"Links ",-1),aa={class:"px-2 w-48 text-sm font-medium"},ra=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"Created ",-1),ia={class:"w-48 text-sm font-medium"},la=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"Updated ",-1),ca=ce({props:{ySubDoc:null,jSubDocs:null,hocuspocusProvider:null,webRtcProvider:null,subStates:null},setup(e){const o=e;Bt.extend({content:"heading block*"});const n=de(),r=fe(),{state:d,toggleSearch:i}=re(),b=Z([]),u=Z(""),f=oe(()=>d.value.isSearchOpen),I=oe(()=>o.jSubDocs?o.jSubDocs.filter(T=>j(T[1].title).toLowerCase().includes(u.value.toLowerCase())).slice(0,10).sort((T,A)=>j(T.title)>j(A.title)?1:j(A.title)>j(T.title)?-1:0):[]),g=Z(0);ae(u,()=>{g.value=0}),ae(f,()=>{f.value?g.value=0:u.value=""});const p=()=>{g.value=(g.value+I.value.length-1)%I.value.length},w=()=>{g.value=(g.value+1)%I.value.length},C=()=>{u.value=j(I.value[g.value][1].title)},K=()=>{u.value.startsWith("{")?R(u.value):S(I.value[g.value],g.value)},S=(T,A)=>{g.value=A,i(),r.push("/"+n.params.space+"/"+n.params.document+"/"+T[0])},R=T=>{if(T){u.value="";const A=JSON.parse(T);if(A.nodes&&A.links&&A.documents){const H=Object.entries(A.links),B=Object.entries(A.nodes),W=o.ySubDoc.getMap("nodes"),c=o.ySubDoc.getMap("links");for(let h=0;h<B.length;h++)B[h][1].created||(B[h][1].created=new Date),B[h][1].updated||(B[h][1].updated=new Date),W.set(B[h][0],B[h][1]);for(let h=0;h<H.length;h++)c.set(H[h][0],H[h][1]);for(let h=0;h<A.documents.length;h++)o.ySubDoc.getXmlFragment()}}},j=T=>{let A="";if(Array.isArray(T))for(let H=0;H<T.length;H++)A+=T[H].text;else A=T;return A};return Ie(()=>{b.value=o.ySubDoc.getMap("nodes").toJSON()}),(T,A)=>{const H=Je("router-link");return $(),ne(t(Pe),{show:t(d).isSearchOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(i)},{default:O(()=>[a("div",Bn,[a("div",Fn,[_(t(ue),{as:"template",enter:"duration-20 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-20 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0"})]),_:1}),zn,_(t(ue),{as:"template",enter:"ease-out duration-20","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-20","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:bg-lityblack mt-16 pb-3 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-4xl w-full",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(d).blurredInterface}])},[a("div",jn,[(e.subStates.hocuspocus.awareness&&e.subStates.hocuspocus.awareness.length>1,G("",!0)),($(),M("span",Wn,[a("form",{class:"w-full",onSubmit:A[2]||(A[2]=ye(()=>{},["prevent"]))},[Re(a("input",{id:"search",onKeydown:[$e(ye(p,["prevent"]),["up"]),$e(ye(w,["prevent"]),["down"]),$e(ye(C,["prevent"]),["right"]),$e(ye(K,["prevent"]),["enter"])],"onUpdate:modelValue":A[0]||(A[0]=B=>u.value=B),placeholder:"Search for Nodes",autocomplete:"off",autocapitalize:"off",spellcheck:"false",autofocus:"",type:"text",name:"search",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg pr-12"},null,40,Vn),[[Le,u.value]]),a("div",Gn,[a("button",{type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 hover:opacity-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-600",onClick:A[1]||(A[1]=(...B)=>t(i)&&t(i)(...B))},Jn)])],32)])),G("",!0)]),($(),M("div",qn,[a("ul",Zn,[($(!0),M(be,null,Oe(t(I),(B,W)=>($(),M("li",{key:B},[B[1]&&B[1].title?($(),ne(H,{key:0,"active-class":"bg-gray-200 dark:bg-gray-800",class:F(["mb-1 mt-0.5 m-3 block rounded-md mb-0.5 bg-white text-black dark:text-white dark:bg-gray-900 bg-opacity-50 dark:bg-opacity-50 hover:bg-gray-100 dark:hover:bg-gray-800 overflow-x-scroll",{"bg-blue-100 hover:text-black ring-2 ring-blue-600 dark:hover:text-white hover:bg-blue-200 dark:bg-blue-700 dark:hover:bg-blue-800":W===g.value}]),onClick:c=>S(B,W),to:"/"+t(n).params.space+"/"+t(n).params.document+"/"+B[0]},{default:O(()=>[a("div",Xn,[a("div",Yn,[a("div",Qn,[a("p",ea,se(j(B[1].title)),1)]),ta,a("div",oa,[a("p",sa,[na,ge(" "+se(B[1].links.length),1)]),a("p",aa,[ra,_(t(st),{time:B[1].created},{default:O(({timeAgo:c})=>[ge(se(c),1)]),_:2},1032,["time"])]),a("p",ia,[la,_(t(st),{time:B[1].updated},{default:O(({timeAgo:c})=>[ge(se(c),1)]),_:2},1032,["time"])])])])])]),_:2},1032,["class","onClick","to"])):G("",!0)]))),128))])]))],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])}}}),at=tt(),z=We({autoLink:!1,linkingNodes:!1,unlinkingNodes:!1,deletingNodes:!1,firstNode:void 0,secondNode:void 0,jsonDocuments:[]}),{osKey:da}=ve(),{state:qe,logger:el}=re(),ua=(e,o,n,r,d,i)=>{const b="graph";let u;const f=de(),I=fe(),g=oe(()=>f.params.node);oe(()=>f.params.space);const p=To(),w=e.getMap("nodes"),C=e.getMap("links");e.getMap("selected");const K=new Po([w,C]),S=oe(()=>r.hocuspocus.awareness),R=oe(()=>r.rtc.awareness),j=Z(),T={background:"rgba(255,255,255,0)",fontSize:16,lineColor:"#a7bac4",lineWidth:1,particleWidth:1.5,highlightedForeground:qe.value.localUserColor||"#009dff",node:{note:"#00192a",placeholder:"#414141"}},A=zt().domain([0,30]).range([.5,2]).clamp(!0),H=zt().domain([1.2,2]).range([0,1]).clamp(!0),B={background:T.background,fontSize:parseInt(T.fontSize)-2,lineColor:T.lineColor,lineWidth:parseFloat(T.lineWidth),particleWidth:parseFloat(T.particleWidth),highlightedForeground:T.highlightedForeground,node:{note:T.node.note,placeholder:T.node.placeholder}},W={background:"rgba(0,0,0,0)",fontSize:16,lineColor:"#656565",lineWidth:1,particleWidth:1.5,highlightedForeground:qe.value.localUserColor||"#009dff",node:{note:"#eaeaea",placeholder:"#a1a1a1"}},c={selectedNodes:new Set,hoverNode:null,focusNodes:new Set,focusLinks:new Set,hoverNodes:new Set,hoverLinks:new Set,nodeInfo:{},data:{nodes:[],links:[]},style:B},h=s=>{s(c);const l=new Set,m=new Set,k=new Set,x=new Set;if(c.hoverNode){k.add(c.hoverNode);const v=c.nodeInfo[c.hoverNode];v!==void 0&&(v.neighbors.forEach(X=>l.add(X)),v.links.forEach(X=>m.add(X)))}c.selectedNodes&&c.selectedNodes.forEach(v=>{l.add(v);const X=c.nodeInfo[v];X!==void 0&&(X.neighbors.forEach(te=>l.add(te)),X.links.forEach(te=>m.add(te)))}),c.focusNodes=l,c.focusLinks=m,c.hoverNodes=k,c.hoverLinks=x},y={refresh:s=>h(l=>{l.nodeInfo=s.nodes;const m=s.links,k=new Set(Object.keys(l.nodeInfo)),x=new Set;l.data.nodes.forEach((v,X)=>{k.has(v.id)?k.delete(v.id):x.add(X)}),x.forEach(v=>{l.data.nodes.splice(v,1)}),k.forEach(v=>{w.get(v)&&l.data.nodes.push({id:v,y:w.get(v).y,x:w.get(v).x})}),l.data.links=m,l.hoverNode=l.nodeInfo[l.hoverNode]!=null?l.hoverNode:null,l.selectedNodes=new Set(Array.from(l.selectedNodes).filter(v=>l.nodeInfo[v]!=null)),p.graphData(l.data)}),selectNode:(s,l)=>h(m=>{if(l||m.selectedNodes.clear(),s!=null){m.selectedNodes.add(s);const k=p.graphData().nodes;for(const[x,v]of Object.entries(k))if(v.id===s){p.centerAt(v.x,v.y,300),p.zoom(7,300);break}}}),highlightNode:s=>h(l=>{l.hoverNode=s}),updateStyle:s=>{!s||(c.style=It(Se(Se({},B),s),{lineColor:s.lineColor||s.node&&s.node.note||B.lineColor,node:Se(Se({},B.node),s.node)}),p.backgroundColor(c.style.background))}},N=(s,l=!0)=>(Object.values(s.nodes).forEach(m=>{m.neighbors=[],m.links=[]}),l||s.links.forEach(m=>{try{const k=s.nodes[m.source||m.source.id],x=s.nodes[m.target||m.target.id];k&&x&&(k.neighbors.push(x.id),x.neighbors.push(k.id),k.links.push(m),x.links.push(m))}catch(k){console.log(k)}}),s);function D(){const s=[],l=[];C.forEach((m,k,x)=>{l.push(m)});for(let m=0;m<l.length;m++)l[m].source&&l[m].source.id?w.get(l[m].source.id)&&w.get(l[m].target.id)&&s.push({source:l[m].source.id,target:l[m].target.id,value:0}):w.get(l[m].source)&&w.get(l[m].target)&&s.push({source:l[m].source,target:l[m].target,value:0});return s}const L=(s=!1)=>{const l=D(),m=w.toJSON();w.get("index")||(w.set("index",{id:"index",group:1,title:"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]}),y.selectNode("index"));function k(X,te){let Y={};const pe=X.getMap().get(te);pe&&(Y=pe);const Q=Object.entries(m).length;Y.count!==Q&&(Y.count=Q),Y.updatedAt=new Date().toISOString(),Y.guid||(Y.guid=te),Y.filled=!0,Y.createdAt||(Y.createdAt=new Date().toISOString()),Y.count.toString()!==Q.toString()&&X.getMap().set(te,Y)}k(i,f.params.document);const v=N({nodes:m,links:l},s);y.refresh(v),p.d3ReheatSimulation()},U=()=>{p.zoom(p.zoom()+1,300)},V=()=>{p.zoom(p.zoom()-1,300)},P=()=>{p.d3Force("center",Ve(0,0)),p.d3Force("x",jt(0).strength(.1)),p.d3Force("y",Wt(0).strength(.1)),Ye()},J=()=>{p.d3Force("center",Ve(0,0)),p.d3Force("x",jt(0).strength(.01)),p.d3Force("y",Wt(0).strength(.01)),Ye()},ie=s=>{const l=Object.values(w.toJSON()),m=[];for(let k=0;k<l.length;k++)s.toLowerCase()===getPlainText(l[k].title).toLowerCase()&&m.push(l[k].id);return[]},he=s=>{const l=ie(s);return l.length>=1?l[0]:!1},xe=s=>!!w.get(s).getJSON(),me=(s,l,m)=>(w.set(s,{id:s,group:1,title:""+l+"",neighbors:[],links:[]}),s),Be=(s,l)=>(C.set(s+"_"+l,{source:s,target:l,value:0}),s+"_"+l),ee=(s,l)=>{const k=Math.floor(new Date().getTime()+Math.random()).toString();return me(k,s,l)},q=(s,l,m)=>{const x=Math.floor(new Date().getTime()+Math.random()).toString(),v=me(x,l,m);return Be(s,x),v},le=(s,l)=>{z.linkingNodes&&(z.linkingNodes=!1),z.deletingNodes&&(z.deletingNodes=!1),z.unlinkingNodes&&(z.unlinkingNodes=!1);const m=Math.floor(new Date().getTime()+Math.random());let k;if(l){const Y=g.value||null,pe=l.id?l.id.toString():Y,Q=m.toString();k=Q,pe?(w.set(Q,{id:Q,group:1,created:new Date().toISOString(),updated:new Date().toISOString(),title:""+Q+"",neighbors:[pe],links:[pe]}),C.set(pe+"_"+Q,{source:pe,target:Q,value:0})):w.set(Q,{id:Q,group:1,title:""+Q+"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]})}else k=m,w.set(m.toString(),{id:m.toString(),group:1,title:""+m.toString()+"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]});const x=D(),v={nodes:w.toJSON(),links:x},X=w.get(k),te=N(v,!1);y.refresh(te),y.selectNode(k),p.centerAt(X.x,X.y,300),I.push({path:`/${f.params.space}/${f.params.document}/${k}`})},Fe=()=>{p(u).cooldownTicks(50).graphData(c.data).backgroundColor(c.style.background).linkHoverPrecision(8).d3Force("collide",Eo(p.nodeRelSize())).linkWidth(()=>c.style.lineWidth||T.lineWidth).linkDirectionalParticles(1).linkDirectionalParticleWidth(s=>ct(s,c)==="highlighted"?c.style.particleWidth||T.particleWidth:0).nodeCanvasObject((s,l,m)=>{const k=c.nodeInfo[s.id];if(k==null){console.error(`Could not find info for node ${s.id} - skipping`);return}const x=A(k.neighbors.length),{fill:v,border:X}=Xe(s.id,c),te=c.style.fontSize/m*1.1,Y=lt(s.id,c),pe=v.copy({opacity:Y==="regular"?H(m):Y==="highlighted"?1:Math.min(H(m),v.opacity)}),Q=X.copy({opacity:Y==="regular"?H(m):Y==="highlighted"?1:Math.min(H(m),v.opacity)}),we=(_e=>{let je="";const no=[];if(Array.isArray(_e))for(let ht=0;ht<_e.length;ht++)je+=_e[ht].text;else je=_e;return{text:je,marks:no}})(k.title).text,oo=JSON.stringify(k.title).toString(),Nt=/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/gi,ft=we.match(Nt);we.replace(Nt,"");const so=s.id.startsWith("http"),gt=oo.includes("highlight");function Ce(_e,je){return _e.length>je?_e.substr(0,je-1)+"...":_e}Ne(pe).copy({opacity:.3});const Ct=Y==="lessened";ft&&!gt?ze(l).circle(s.x,s.y,x+.5,X).circle(s.x,s.y,x,v).text(Ce(we,48),s.x,s.y+x+1,te,Q):gt&&!ft?ze(l).circle(s.x,s.y,x+.5,X).circle(s.x,s.y,x,v).highlighted(Ce(we,48),s.x,s.y+x+1,te,Q,Ct,H(m)).text(Ce(we,48),s.x,s.y+x+1,te,Q):gt&&ft?ze(l).highlighted(Ce(we,48),s.x,s.y+x,te,Q,Ct,H(m)).text(Ce(we,48),s.x,s.y-x+1,te,Q):so?ze(l).circle(s.x,s.y,x,X).text(Ce(we,48),s.x,s.y+x+1,te,Q):ze(l).circle(s.x,s.y,x+.5,v).circle(s.x,s.y,x,X).text(Ce(we,48),s.x,s.y+x+1,te,Q)}).linkColor(s=>xt(s,c)).nodePointerAreaPaint((s,l,m)=>{const k=6;m.beginPath(),m.arc(s.x,s.y,k,0,2*Math.PI,!1),m.fillStyle=l,m.fill(),m.closePath()}).onNodeHover(s=>{o("onNodeHover",s),y.highlightNode(s==null?void 0:s.id)}).onNodeClick((s,l)=>{if(o("onNodeClick",s),z.unlinkingNodes){dt(s.id);return}if(z.deletingNodes){ut(s.id);return}if(da(l)){const m=w.get(s.id);m.href&&open(m.href)}else s.fx=s.x,s.fy=s.y,z.linkingNodes&&(z.firstNode&&z.firstNode.length>3?_t(z.firstNode,s.id):z.firstNode=s.id),p.centerAt(s.x,s.y,300),y.selectNode(s.id,!1),I.push({path:`/${f.params.space}/${f.params.document}/${s.id}`})}).onLinkRightClick((s,l)=>{o("onLinkRightClick")}).onZoom((s,l)=>{o("onZoom")}).onZoomEnd((s,l)=>{o("onZoomEnd")}).onLinkHover((s,l)=>{o("onLinkHover")}).onLinkClick((s,l)=>{o("onLinkClick")}).onLinkRightClick((s,l)=>{o("onLinkRightClick")}).onEngineTick((s,l)=>{o("onEngineTick")}).onEngineStop((s,l)=>{o("onEngineStop")}).onBackgroundClick(()=>{o("onBackgroundClick"),y.selectNode(void 0,!1),I.push({path:`/${f.params.space}/${f.params.document}`})}).onBackgroundRightClick(s=>{o("onBackgroundRightClick",s),p.screen2GraphCoords(s.x,s.y),le()}).onNodeRightClick(s=>{o("onNodeRightClick",s),le(!1,s)}).onNodeDrag(s=>{o("onNodeDrag",s)}).onNodeDragEnd(s=>{o("onNodeDragEnd",s),s.fx&&s.fy?(s.fx=void 0,s.fy=void 0):(s.fx=s.x,s.fy=s.y)})},Ke=s=>{const l=[],m=r.hocuspocus.awareness.length>1?Object.values(r.hocuspocus.awareness):r.rtc.awareness.length>1?Object.values(r.rtc.awareness):[];if(m)for(let k=0;k<m.length;k++){const x=m[k].user;x&&x.latestDocument&&x.latestNode&&x.latestNode===s&&l.push(x)}return l};function Xe(s,l){var te,Y,pe,Q;const m=l.nodeInfo[s],k=l.style,x=Ne((Y=k.node[(te=m.type)!=null?te:"note"])!=null?Y:k.node.note);let v=Ne((Q=k.node[(pe=m.type)!=null?pe:"note"])!=null?Q:k.node.note);const X=qe.value.showOtherColors?Ke(s):[];switch(X.length>=1&&(v=Ne(X[0].color)),s===g.value&&(v=Ne(qe.value.localUserColor)),lt(s,l)){case"regular":return{fill:x,text:x,border:v};case"lessened":const $t=Ne(x).copy({opacity:.3}),pt=Ne(v).copy({opacity:.3});return{fill:$t,text:pt,border:pt};case"focused":return{fill:Ne(k.highlightedForeground),text:x,border:v};case"highlighted":return{fill:x,text:x,border:v};default:throw new Error("Unknown type for node",s)}}function xt(s,l){const m=l.style;switch(ct(s,l)){case"regular":return m.lineColor;case"highlighted":return m.highlightedForeground;case"focused":return m.highlightedForeground;case"lessened":return Uo(m.lineColor).copy({opacity:.5});default:throw new Error("Unknown type for link",s)}}function lt(s,l){return l.selectedNodes.has(s)?"highlighted":l.hoverNode===s?"focused":l.focusNodes.size===0||l.focusNodes.has(s)?"regular":"lessened"}function ct(s,l){return l.focusNodes.size===0?"regular":l.focusLinks.has(s)?"highlighted":"lessened"}const ze=s=>({circle:function(l,m,k,x){return s.beginPath(),s.arc(l,m,k,0,2*Math.PI,!1),s.fillStyle=x,s.fill(),s.closePath(),this},ring:function(l,m,k,x){return s.beginPath(),s.arc(l,m,k*2,0,2*Math.PI,!1),s.fillStyle=x,s.fill(),s.closePath(),this},text:function(l,m,k,x,v){return s.font=`${x}px Sans-Serif`,s.textAlign="center",s.textBaseline="top",s.fillStyle=v,s.fillText(l,m,k),this},emoji:function(l,m,k,x,v){return s.font=`${x}px Sans-Serif`,s.textAlign="center",s.globalAlpha=.7,s.fillStyle=v,s.fillText(l,m,k),this},highlighted:function(l,m,k,x,v,X,te){s.font=`${x}px Sans-Serif`,s.fillStyle="rgba(255,251,0,"+(te-.2)+")",X&&(s.fillStyle="rgba(255,251,0,"+(te-.2)+")");const Y=s.measureText(l).width;return s.fillRect(m-Y/2,k,Y,parseInt(s.font,0)*1.1),this}}),wt=()=>{I.push(`/${f.params.space}/${f.params.document}/`)},Yt=()=>{z.deletingNodes&&(z.deletingNodes=!1),z.unlinkingNodes&&(z.unlinkingNodes=!1),g.value&&g.value.length>3&&(z.firstNode=g.value),z.linkingNodes=!z.linkingNodes,z.linkingNodes||(z.firstNode=null)},Qt=()=>{z.deletingNodes&&(z.deletingNodes=!1),z.linkingNodes&&(z.linkingNodes=!1),g.value&&g.value.length>3?dt(g.value):z.unlinkingNodes=!z.unlinkingNodes},eo=()=>{z.linkingNodes&&(z.linkingNodes=!1),z.unlinkingNodes&&(z.unlinkingNodes=!1),g.value&&g.value.length>3?ut(g.value):z.deletingNodes=!z.deletingNodes},_t=(s,l)=>{s&&l&&(z.firstNode=void 0,z.secondNode=void 0,C.set(s+"_"+l,{source:s,target:l,value:0})),z.linkingNodes=!1},dt=s=>{s&&(w.forEach((l,m)=>{const k=l.neighbors,x=l.links;for(let v=0;v<k.length;v++)k[v]===s&&k.splice(v,1);for(let v=0;v<x.length;v++)(x[v].source==s||x[v].source.id==s||x[v].target==s||x[v].target.id==s)&&x.splice(v,1)}),C.forEach((l,m)=>{(l.target==s||l.source==s)&&(C.delete(m,1),L(!0))}),L(!1))},ut=s=>{s&&s!="index"?(w.delete(s.toString()),w.forEach((l,m)=>{const k=l.neighbors,x=l.links;for(let v=0;v<k.length;v++)k[v]===s&&k.splice(v,1);for(let v=0;v<x.length;v++)(x[v].source==s||x[v].source.id==s||x[v].target==s||x[v].target.id==s)&&x.splice(v,1)}),L(!1),wt()):o("deleteIndex")},St=()=>{p.graphData().nodes.forEach((s,l,m)=>{s.fx&&s.fy&&(s.fx=void 0,s.fy=void 0)}),L(!1)};function to(){if(p.d3Force("center",Ve(0,0)),p.zoomToFit(300,20),g.value){const s=p.graphData().nodes;for(const[l,m]of Object.entries(s))if(m.id===g.value){p.d3Force("center",Ve(0,0)),p.centerAt(m.x,m.y,300);break}y.selectNode(g.value,!1)}}const Ye=()=>{p&&p._destructor(),Fe(),St(),L(),j.value=Object.entries(w.toJSON()),p.width(window.innerWidth),p.height(window.innerHeight);const s=Z(!0);p.onEngineStop(()=>{const l=p.graphData().nodes;if(s.value)if(l.length>1){if(p.d3Force("center",Ve(0,0)),p.zoomToFit(50,20),s.value=!1,g.value){for(const[m,k]of Object.entries(l))if(k.id===g.value){p.d3Force("center",Ve(0,0)),p.centerAt(k.x,k.y,50);break}y.selectNode(g.value,!1)}}else p.zoomToFit(50,0);p.cooldownTicks(20)}),window.addEventListener("resize",()=>{p.width(window.innerWidth),p.height(window.innerHeight)}),window.addEventListener("orientationchange",function(){p.width(window.innerWidth),p.height(window.innerHeight)})};return Ie(()=>{if(u=document.getElementById(b),u!==void 0){w.observe(()=>{L(),j.value=Object.entries(w.toJSON())}),C.observe(()=>{L()}),ae(g,(l,m)=>{z.autoLink&&C.set(l+"_"+m,{source:l,target:m,value:0})}),ae(S,()=>{}),ae(R,()=>{}),ae(at,()=>{at.value&&y.updateStyle(W),at.value||y.updateStyle(B)});const s=oe(()=>qe.value.useStrongGravity);ae(s,()=>{s.value?P():J()}),Ye(),at.value?y.updateStyle(W):y.updateStyle(B),s.value?P():J()}}),De(()=>{p._destructor()}),ae(g,()=>{g.value?(y.selectNode(g.value,!1),o("show")):(y.selectNode(void 0,!1),o("hide"))}),{galaxyState:z,Actions:y,graph:p,update:h,augmentGraphInfo:N,updateLinks:D,updateAll:L,zoomIn:U,zoomOut:V,gravityOn:P,gravityOff:J,nodesWithTitle:ie,hasNodesWithTitle:he,doesNodeExist:xe,createNodeOrUpdate:me,directLinkNodes:Be,createRootNode:ee,createChildNode:q,doAction:le,initDataviz:Fe,isWithUser:Ke,getNodeColor:Xe,getLinkColor:xt,getNodeState:lt,getLinkState:ct,Draw:ze,unsetID:wt,linkNodes:Yt,unlinkNodes2:Qt,deleteNodes2:eo,linkNodesPermanent:_t,unLinkNodes:dt,deleteNode:ut,unfixAll:St,Escape:to,reRenderGraph:Ye,jsonDocuments:j,yUndoManagerNodes:K}},pa=ce({props:{yRootDoc:null,ySubDoc:null,ySubDocIndexedDb:null,ySubDocs:null,jSubDocs:null,spaceId:null,docId:null,nodeId:null,hocuspocusProvider:null,webRtcProvider:null,subStates:null,rootStates:null,paneVisible:null},emits:["onBackgroundClick","onBackgroundRightClick","onNodeHover","onNodeClick","onNodeRightClick","onNodeDrag","onNodeDragEnd","onLinkRightClick","onZoom","onZoomEnd","onLinkHover","onLinkClick","onLinkRightClick","onEngineTick","onEngineStop","deleteIndex","hide","show"],setup(e,{emit:o}){const n=e,r=tt(),{state:d}=re(),{osKey:i}=ve(),{galaxyState:b,graph:u,computedNodeId:f,gravityOn:I,gravityOff:g,reRenderGraph:p,Escape:w,deleteNodes2:C,unLinkNodes:K,unlinkNodes2:S,doAction:R,linkNodes:j,jsonDocuments:T,zoomIn:A,zoomOut:H,deleteNode:B,yUndoManagerNodes:W}=ua(n.ySubDoc,o,n.docId,n.rootStates,n.hocuspocusProvider,n.yRootDoc);window.rpc&&window.rpc.notify&&mt.listen("tauri://menu",({event:h,payload:y})=>{switch(y){case"Center-Gravity":I();break;case"No-Gravity":g();break;case"Unfix-Gravity":p();break;case"Previous Node":break;case"Next Node":break;case"Exit Node":w();break;case"Delete Node":C();break;case"Cut Node-Links":S();break;case"New Root-Node":R(!1,!1);break;case"New Child-Node":R(!1,{id:n.nodeId});break;case"Link Nodes":j();break}});const c=h=>{h.key==="Escape"&&(h.preventDefault(),w()),h.key==="k"&&i(h)&&(h.preventDefault(),R(!1,{id:n.nodeId})),h.key==="o"&&i(h)&&h.preventDefault(),h.key==="j"&&i(h)&&(h.preventDefault(),R(!1,!0)),h.key==="l"&&i(h)&&(h.preventDefault(),K(n.nodeId)),h.key==="+"&&i(h)&&(h.preventDefault(),A()),h.key==="."&&i(h)&&(h.preventDefault(),d.value.useStrongGravity=!d.value.useStrongGravity),h.key==="-"&&i(h)&&(h.preventDefault(),H()),h.key==="Backspace"&&i(h)&&(h.preventDefault(),B(n.nodeId))};return Ie(()=>{document.addEventListener("keydown",c)}),De(()=>{document.removeEventListener("keydown",c)}),(h,y)=>($(),M(be,null,[_(ca,{"y-sub-doc":e.ySubDoc,"sub-states":e.subStates,"j-sub-docs":e.jSubDocs,"hocuspocus-provider":e.hocuspocusProvider,"web-rtc-provider":e.webRtcProvider},null,8,["y-sub-doc","sub-states","j-sub-docs","hocuspocus-provider","web-rtc-provider"]),_(Pn,{"linking-nodes":t(b).linkingNodes,"unlinking-nodes":t(b).unlinkingNodes,"deleting-nodes":t(b).deletingNodes,onRefreshGraph:y[0]||(y[0]=N=>t(p)()),onUndo:y[1]||(y[1]=N=>t(W).undo()),onRedo:y[2]||(y[2]=N=>t(W).redo()),onLinkNodes:t(j),onUnlinkNodes:t(S),onCreateNode:y[3]||(y[3]=N=>e.nodeId?t(R)(!1,{id:e.nodeId}):t(R)(!1,!0)),onDeleteNode:t(C)},null,8,["linking-nodes","unlinking-nodes","deleting-nodes","onLinkNodes","onUnlinkNodes","onDeleteNode"]),a("div",{id:"graph",class:F([{"dark-bg":t(r)},"select-none fixed top-0 left-0 right-0 bottom-0"])},null,2)],64))}}),fa=e=>{const{isMobile:o,hasNotch:n}=ve(),r=fe(),d=de();let i;const b=oe(()=>d.params.document),u=oe(()=>d.params.node),f=We({paneCreated:!1,paneVisible:!1,paneState:"",backupPaneState:""}),I=()=>{o()&&(i.currentBreak()==="top"||i.moveToBreak("middle"))},g=()=>{f.paneVisible=!0,i.present()},p=()=>{i.hide()},w=H=>{u.value&&i.moveToBreak(H)},C=()=>{i.currentBreak()==="top"?(w("bottom"),f.paneState="bottom"):i.currentBreak()==="middle"?(w("top"),f.paneState="top"):i.currentBreak()==="bottom"&&(w("middle"),f.paneState="middle")},K=()=>{i.isPanePresented()&&!i.isHidden()&&(f.paneVisible=!1,i.hide())},S=()=>{r.push(`/${d.params.space}/${d.params.document}/`)},R=()=>{r.forward()},j=()=>{r.back()},T=()=>{i=new Mo(".editor-pane",{breaks:{top:{enabled:!0,height:window.innerHeight-(n()&&o()?110:50),bounce:!1},middle:{enabled:!0,height:n()&&o()?400:300,bounce:!1},bottom:{enabled:!0,height:n()&&o()?150:100,bounce:!1}},buttonClose:!1,showDraggable:o(),draggableOver:o(),initialBreak:"bottom",dragBy:[".pane .draggable"],clickBottomOpen:!1,fastSwipeClose:!1,fitHeight:!1,fitScreenHeight:!1,bottomOffset:-10,onDidDismiss:()=>{e.value&&b.value&&r.push(`/${e.value}/${b.value}/`),f.paneVisible=!1},onWillPresent:()=>{f.paneVisible=!0},onTransitionEnd:()=>{var H;f.paneState=i.currentBreak()?(H=i.currentBreak())==null?void 0:H.toString():"",i.isPanePresented()?u.value||i.hide():i.present()}}),f.paneCreated=!0,i.isPanePresented()?u.value||i.hide():i.present(),f.backupPaneState&&i.moveToBreak(f.backupPaneState)},A=()=>{var H;f.paneCreated=!1,f.backupPaneState=(H=i.currentBreak())==null?void 0:H.toString(),i.destroy()};return Ie(()=>{T()}),De(()=>{A(),f.paneCreated=!1}),{editorPaneState:f,editorPane:i,moveToFocus:I,showPane:g,hidePane:K,moveTo:w,switchPane:C,hide:p,unsetId:S,goForward:R,goBack:j,destroyPane:A,createPane:T}},ga=(e,o,n)=>{const r=We({hasLoadedSubDoc:!1});fe();const d=de(),i=oe(()=>d.params.node),b=e.getMap();let u;const f=()=>{b.delete(u.guid);const C=u.getMap("nodes"),K=u.getMap("links"),S=C.toJSON(),R=Object.entries(S),j=K.toJSON(),T=Object.entries(j);for(let A=0;A<R.length;A++){const H=u.getXmlFragment(R[A][0]);H.delete(0,H.length),C.delete(R[A][0])}for(let A=0;A<T.length;A++)K.delete(T[A][0])},I=C=>{const K=b.get(C);K?(K.updatedAt=new Date().toString(),b.set(C,K)):b.set(C,{guid:C,title:"Index",createdAt:new Date().toString(),updatedAt:new Date().toString()})};n&&n.length>=1?u=new Qe({guid:n,autoLoad:!0}):u=new Qe({autoLoad:!0});const g=u.getMap("nodes"),p=Z(),w=new Rt(u.guid,u);return w.once("synced",()=>{r.hasLoadedSubDoc=!0,(!n||!i.value)&&I(u.guid),p.value=Object.entries(g.toJSON()),g.observe(()=>{p.value=Object.entries(g.toJSON())})}),{subDocState:r,ySubDoc:u,ySubDocIndexedDb:w,ySubDocs:g,jSubDocs:p,deleteSubDoc:f}},ha={class:"overflow-hidden"},ma=ce({props:{yRootDoc:null,yRootDocIndexedDb:null,yRootDocs:null,jRootDocs:null,spaceId:null,spaceUrl:null,spaceToken:null,docId:null,nodeId:null,hocuspocusProvider:null,webRtcProvider:null,rootStates:null},setup(e){const o=e,n=fe();de();const{state:r,logger:d,toggleSearch:i,checkForOpenWindows:b,toggleOnly:u}=re(),{osKey:f}=ve(),I=Z(),g=Z(),{editorPaneState:p,editorPane:w,destroyPane:C,moveToFocus:K,showPane:S,hidePane:R,moveTo:j,switchPane:T,unsetId:A,goForward:H,goBack:B,createPane:W}=fa(o.spaceId),{subDocState:c,ySubDoc:h,ySubDocIndexedDb:y,ySubDocs:N,jSubDocs:D,deleteSubDoc:L}=ga(o.yRootDoc,o.spaceId,o.docId?o.docId:null),{subStates:U,provideAwareness:V,provideSubHocuspocus:P,provideSubWebRtc:J}=Xt();V(h);const ie=oe(()=>o.nodeId);oe(()=>o.docId);const he=oe(()=>r.value.useWebRtc),xe=oe(()=>r.value.useHocuspocus);Z(!1);const me=tt();he.value&&!g.value&&(g.value=J()),xe.value&&!I.value&&(I.value=P(o.spaceUrl,o.spaceToken)),window.rpc&&window.rpc.notify&&mt.listen("tauri://menu",({event:ee,payload:q})=>{switch(q){case"Open Search":i();break;case"Toggle Editor Breaks":T();break}});const Be=ee=>{if(ee.key==="Escape"&&(ee.preventDefault(),n.push(`/${o.spaceId}/${o.docId}`)),ee.key==="Tab"&&ee.shiftKey&&!ee.altKey&&(ee.preventDefault(),T()),ee.key==="f"&&f(ee)&&(ee.preventDefault(),u("search")),ee.key==="Backspace"&&ee.shiftKey&&f(ee)&&(ee.preventDefault(),L(o.docId)),ee.key==="p"&&f(ee)){ee.preventDefault();const q={nodes:[],links:[],documents:[]};q.nodes=h.getMap("nodes").toJSON(),q.links=h.getMap("links").toJSON();const le=Object.entries(q.nodes);for(let Fe=0;Fe<le.length;Fe++){const Ke=le[Fe][1],Xe=h.getXmlFragment(Ke.id);q.documents.push([Ke.id,JSON.stringify(Xe)])}}};return ae(ie,()=>{ie.value&&ie.value.length>=3?S():R()}),ae(he,()=>{he.value?g.value=J():g.value&&g.value.destroy()}),ae(xe,()=>{xe.value?I.value=P(o.spaceUrl,o.spaceToken):I.value&&I.value.destroy()}),Ie(()=>{document.addEventListener("keydown",Be);let ee;window.addEventListener("resize",()=>{p.paneCreated&&C(),clearTimeout(ee),ee=setTimeout(()=>{W()},200)})}),De(()=>{g.value&&g.value.destroy(),I.value&&I.value.destroy(),document.removeEventListener("keydown",Be)}),(ee,q)=>($(),M("div",ha,[a("div",{class:F(["cupertino-pane editor-pane select-none",{blur:t(r)?t(r).blurredInterface&&!t(me):!1,"blur-dark":t(r)?t(r).blurredInterface&&t(me):!1,dark:t(r)&&!t(r).blurredInterface&&t(me)}])},[t(c).hasLoadedSubDoc&&e.nodeId&&t(p).paneCreated?($(),ne(an,{key:e.spaceId+e.docId+e.nodeId,"y-root-doc":e.yRootDoc,"y-root-docs":e.yRootDocs,"j-root-docs":e.jRootDocs,"y-sub-doc":t(h),"y-sub-doc-indexed-db":t(y),"y-sub-docs":t(N),"j-sub-docs":t(D),"space-id":e.spaceId,"doc-id":e.docId,"node-id":e.nodeId,"hocuspocus-provider":I.value,"web-rtc-provider":g.value,"sub-states":t(U),"pane-visible":t(p).paneVisible,"pane-state":t(p).paneState,onOnFocus:q[0]||(q[0]=le=>t(K)()),onBottom:q[1]||(q[1]=le=>t(j)("bottom")),onMiddle:q[2]||(q[2]=le=>t(j)("middle")),onTop:q[3]||(q[3]=le=>t(j)("top")),onHide:q[4]||(q[4]=le=>t(A)()),onBack:q[5]||(q[5]=le=>t(B)()),onForward:q[6]||(q[6]=le=>t(H)()),onSwitch:q[7]||(q[7]=le=>t(T)())},null,8,["y-root-doc","y-root-docs","j-root-docs","y-sub-doc","y-sub-doc-indexed-db","y-sub-docs","j-sub-docs","space-id","doc-id","node-id","hocuspocus-provider","web-rtc-provider","sub-states","pane-visible","pane-state"])):G("",!0)],2),t(c).hasLoadedSubDoc&&e.docId&&t(p).paneCreated?($(),ne(pa,{key:e.spaceId+e.docId,"y-root-doc":e.yRootDoc,"y-sub-doc":t(h),"y-sub-doc-indexed-db":t(y),"y-sub-docs":t(N),"j-sub-docs":t(D),"space-id":e.spaceId,"doc-id":e.docId,"node-id":e.nodeId,"hocuspocus-provider":I.value,"web-rtc-provider":g.value,"sub-states":t(U),"root-states":e.rootStates,"pane-visible":t(p).paneVisible,onHide:t(R),onShow:t(S),onDeleteIndex:q[8]||(q[8]=le=>{t(L)(o.docId)})},null,8,["y-root-doc","y-sub-doc","y-sub-doc-indexed-db","y-sub-docs","j-sub-docs","space-id","doc-id","node-id","hocuspocus-provider","web-rtc-provider","sub-states","root-states","pane-visible","onHide","onShow"])):G("",!0)]))}}),ba={class:"fixed inset-0 z-50 dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 overflow-y-auto"},ya={class:"text-center"},va=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),ka={class:"m-3"},xa={key:0,class:"pb-4"},wa={key:1,class:"relative z-0 w-full mb-4 inline-flex justify-between"},_a=["onKeydown","placeholder"],Sa={class:"absolute inset-y-0 right-0 flex py-0.5 pr-1.5"},$a=a("i",{class:"ri-question-fill text-2xl"},null,-1),Na=[$a],Ca=a("i",{class:"ri-close-circle-fill text-2xl"},null,-1),Da=[Ca],Oa={class:"relative z-0 w-full inline-flex"},Ia=a("i",{class:"ri-focus-line pr-1.5 text-2xl"},null,-1),Aa=ge(" New Gravity "),Ra=[Ia,Aa],La=ge(" Change Space "),Ta={class:"relative z-0 overflow-ellipsis w-full overflow-x-scroll"},Pa={role:"list"},Ea={style:{"min-width":"300px"},class:"px-2"},Ua={class:"flex justify-between"},Ma={class:"flex"},Ha={class:"mx-1 flex items-center text-sm w-64 font-bold overflow-hidden"},Ba=a("div",{class:"mt-1 flex items-center text-sm sm:mt-0"},null,-1),Fa={class:"mt-1 flex items-center text-sm sm:mt-0"},za={key:0,class:"px-1 w-28 text-sm font-medium"},ja=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"nodes ",-1),Wa={class:"w-48 text-md font-medium"},Va=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"UPDATED ",-1),Ga={class:"px-1 w-48 text-sm font-medium"},Ka=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"CREATED ",-1),Ja=a("p",{class:"opacity-0 px-2 groups-hover:opacity-100"},[a("i",{class:"ri-delete-bin-2-fill text-lg"})],-1),qa=ce({props:{yRootDoc:null,yRootDocIndexedDb:null,jRootDocs:null,hocuspocusProvider:null,webRtcProvider:null,rootStates:null},emits:["createDocument"],setup(e,{emit:o}){const n=e,r=de(),d=fe(),{state:i,toggleSelector:b,toggleProvider:u,toggleShare:f,toggleUser:I,toggleOnly:g}=re(),{getPlainText:p}=ve(),w=Z(""),C=Z(0),K=(W,c)=>{H(W,c)},S=oe(()=>n.jRootDocs?n.jRootDocs.filter(W=>W[1].title&&p(W[1].title).toLowerCase().includes(w.value.toLowerCase())).sort((W,c)=>W.updatedAt>c.updatedAt?-1:W.updatedAt<c.updatedAt?1:0).sort((W,c)=>p(W.title)>p(c.title)?1:p(c.title)>p(W.title)?-1:0):[]),R=()=>{C.value=(C.value+S.value.length-1)%S.value.length},j=()=>{C.value=(C.value+1)%S.value.length},T=()=>{w.value=p(S.value[C.value][1].title)},A=()=>{w.value.startsWith("/")?d.push(w.value):w.value.startsWith("{")?B(w.value):H(S.value[C.value][0],C.value)},H=(W,c)=>{C.value=c,b(),d.push("/"+r.params.space+"/"+W+"/index"),c>=S.value.length},B=W=>{if(W){w.value="";const c=JSON.parse(W);if(c.nodes&&c.links&&c.documents){const h=new Qe;d.push(`/${r.params.space}/${h.guid}/index`);const y=Object.entries(c.links),N=Object.entries(c.nodes),D=h.getMap("nodes"),L=h.getMap("links");for(let U=0;U<N.length;U++)D.set(N[U][0],N[U][1]);for(let U=0;U<y.length;U++)L.set(y[U][0],y[U][1]);for(let U=0;U<c.documents.length;U++);}}};return(W,c)=>{const h=Je("router-link");return $(),ne(t(Pe),{show:t(i).isSelectorOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(b)},{default:O(()=>[a("div",ba,[a("div",ya,[_(t(ue),{as:"template",enter:"duration-20 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-20 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0 backdrop-filter backdrop-blur2"})]),_:1}),va,_(t(ue),{as:"template",enter:"ease-out duration-20","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-20","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:bg-lityblack mt-16 p-0 rounded-lg pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-4xl w-full",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(i).blurredInterface}])},[a("div",ka,[e.rootStates.hocuspocus.awareness&&e.rootStates.hocuspocus.awareness.length>1?($(),M("div",xa,[($(!0),M(be,null,Oe(e.rootStates.hocuspocus.awareness.slice(1),y=>($(),ne(Hn,{key:y.clientId,route:t(r),state:y},null,8,["route","state"]))),128))])):G("",!0),($(),M("span",wa,[a("form",{class:"w-full",onSubmit:c[3]||(c[3]=ye(()=>{},["prevent"]))},[Re(a("input",{id:"search",onKeydown:[$e(ye(R,["prevent"]),["up"]),$e(ye(j,["prevent"]),["down"]),$e(ye(T,["prevent"]),["right"]),$e(ye(A,["prevent"]),["enter"])],"onUpdate:modelValue":c[0]||(c[0]=y=>w.value=y),placeholder:"/"+t(r).params.space+"/"+(t(r).params.document?t(r).params.document+"/"+(t(r).params.node?t(r).params.node:""):""),autocomplete:"off",autocapitalize:"off",spellcheck:"false",autofocus:"",tabindex:"0",type:"text",name:"search",class:"border-0 h-8 bg-white dark:bg-gray-800 dark:text-white bg-opacity-50 dark:bg-opacity-50 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-100 block w-full pl-3 py-5 pr-12 rounded-lg"},null,40,_a),[[Le,w.value]]),a("div",Sa,[a("button",{type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 hover:opacity-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-600",onClick:c[1]||(c[1]=y=>t(g)("info"))},Na),a("button",{type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 hover:opacity-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-600",onClick:c[2]||(c[2]=(...y)=>t(b)&&t(b)(...y))},Da)])],32)])),a("span",Oa,[a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:c[4]||(c[4]=y=>{o("createDocument"),t(b)()})},Ra),a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:c[5]||(c[5]=y=>{t(b)(),t(u)()})},[a("i",{class:F([{"animate animate-pulse text-green-600 dark:text-green-400":e.rootStates.hocuspocus.connected&&t(i).useHocuspocus},"ri-focus-2-line pr-1.5 text-2xl"])},null,2),La]),a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:c[6]||(c[6]=y=>{t(b)(),t(f)()})},[a("i",{class:F([{"animate animate-pulse text-blue-600 dark:text-blue-400":t(i).useWebRtc},"ri-broadcast-line pr-1.5 text-2xl"])},null,2),ge(" "+se(t(i).useWebRtc?"Sharing":"Share")+" P2P ",1)]),a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:c[7]||(c[7]=y=>{t(b)(),t(I)()})},[a("i",{class:"ri-fingerprint-line pr-1.5 text-2xl",style:ot("color: "+t(i).localUserColor)},null,4),ge(" "+se(t(i).localUserName),1)])])]),a("div",Ta,[a("ul",Pa,[($(!0),M(be,null,Oe(t(S),(y,N)=>($(),M("li",{class:"group",key:y[1].id},[y[1]&&y[1].title?($(),ne(h,{key:0,"active-class":"bg-gray-200 dark:bg-gray-800",class:F(["mb-1 mt-1 m-3 block rounded-md bg-white text-black dark:text-white dark:bg-gray-900 bg-opacity-50 dark:bg-opacity-50 group-hover:bg-gray-100 group-hover:bg-opacity-50 dark:group-hover:bg-gray-800 overflow-x-scroll",{"bg-blue-100 group-hover:text-black ring-2 ring-blue-600 dark:group-hover:text-white hover:bg-blue-200 dark:bg-blue-700 dark:group-hover:bg-blue-800":N===C.value}]),to:"/"+t(r).params.space+"/"+y[1].id+"/index",onClick:D=>K(y[0],N)},{default:O(()=>[a("div",Ea,[a("div",Ua,[a("div",Ma,[a("p",Ha,se(t(p)(y[1].title)),1)]),Ba,a("div",Fa,[($(),M("p",za,[ja,ge(" "+se(y[1].count),1)])),a("p",Wa,[Va,_(t(st),{time:y[1].updatedAt},{default:O(({timeAgo:D})=>[ge(se(D),1)]),_:2},1032,["time"])]),a("p",Ga,[Ka,_(t(st),{time:y[1].createdAt},{default:O(({timeAgo:D})=>[ge(se(D),1)]),_:2},1032,["time"])]),Ja])])])]),_:2},1032,["class","to","onClick"])):G("",!0)]))),128))])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])}}});var Za="/assets/icon.43d42a8c.png";const Xa={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},Ya={class:"text-center"},Qa=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),er={class:"grid grid-cols-2 text-black dark:text-white"},tr=a("img",{class:"mx-auto h-32 w-auto",src:Za,alt:"lity logo"},null,-1),or={class:"mx-auto my-auto"},sr=a("h1",{class:"mb-2 leading-1 text-2xl"},[ge("Lity "),a("span",{class:"text-gray-700 dark:text-gray-300"},"Beta")],-1),nr={class:"text-gray-600 dark:text-gray-200"},ar=ce({setup(e){de(),fe();const{state:o,toggleInfo:n}=re();return(r,d)=>($(),ne(t(Pe),{show:t(o).isInfoOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(n)},{default:O(()=>[a("div",Xa,[a("div",Ya,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0"})]),_:1}),Qa,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(o).blurredInterface}])},[a("div",null,[a("div",er,[tr,a("div",or,[sr,a("span",nr,"Version "+se(t(o).version),1)])])]),G("",!0)],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),rr={class:"h-full flex flex-col overflow-hidden dark:text-white text-black"},ir=ce({props:{spaceId:null,spaceUrl:null,spaceToken:null},setup(e){const o=e,n=de(),{state:r,logger:d,toggleOnly:i}=re(),{osKey:b}=ve(),{getSpace:u,setGravity:f,setIndex:I}=nt(),{rootState:g,yRootDoc:p,yRootDocs:w,yRootIndexedDb:C,jRootDocs:K}=Os(o.spaceId),{rootStates:S,rootHocuspocusProvider:R,rootWebRtcProvider:j,rootAwareness:T,provideRootHocuspocus:A,provideRootWebRtc:H,destroyRootWebRtc:B,destroyRootHocuspocus:W}=As(p);u(o.spaceId);const c=oe(()=>r.value.useWebRtc),h=oe(()=>r.value.useHocuspocus);c.value&&H(),h.value&&A(o.spaceUrl,o.spaceToken);const y=oe(()=>n.params.space),N=oe(()=>n.params.document),D=oe(()=>n.params.node);ae(D,()=>{L()}),ae(N,()=>{L(),N.value||f()}),ae(y,()=>{I(o.spaceId,n.params.document)});const L=()=>{T.setLocalStateField("user",{latestNode:D.value?D.value:null,latestDocument:N.value?N.value:null,latestSpace:o.spaceId||null,name:r.value.localUserName,color:r.value.localUserColor}),r.value.localLatestNode=D.value?D.value:null,r.value.localLatestSpace=o.spaceId||null,r.value.localLatestDocument=N.value?N.value:null};window.rpc&&window.rpc.notify&&mt.listen("tauri://menu",({event:V,payload:P})=>{}),ae(c,()=>{c.value?H():B()}),ae(h,()=>{h.value?A(o.spaceUrl,o.spaceToken):W()});const U=V=>{V.key==="p"&&b(V)&&(V.preventDefault(),i("selector"))};return Ie(()=>{document.addEventListener("keydown",U)}),De(()=>{document.removeEventListener("keydown",U)}),(V,P)=>($(),M("div",rr,[_(ar),t(g).hasLoadedRootDoc?($(),ne(qa,{key:0,"y-root-doc":t(p),"y-root-doc-indexed-db":t(C),"hocuspocus-provider":t(R),"web-rtc-provider":t(j),"root-states":t(S),"j-root-docs":t(K),onCreateDocument:t(f)},null,8,["y-root-doc","y-root-doc-indexed-db","hocuspocus-provider","web-rtc-provider","root-states","j-root-docs","onCreateDocument"])):G("",!0),t(g).hasLoadedRootDoc?($(),ne(ma,{"y-root-doc":t(p),"y-root-doc-indexed-db":t(C),"y-root-docs":t(w),"j-root-docs":t(K),key:t(n).params.space+t(n).params.document,"space-id":t(n).params.space,"space-token":e.spaceToken,"space-url":e.spaceUrl,"doc-id":t(n).params.document,"node-id":t(n).params.node,"hocuspocus-provider":t(R),"web-rtc-provider":t(j),"root-states":t(S)},null,8,["y-root-doc","y-root-doc-indexed-db","y-root-docs","j-root-docs","space-id","space-token","space-url","doc-id","node-id","hocuspocus-provider","web-rtc-provider","root-states"])):G("",!0)]))}}),lr={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},cr={class:"text-center"},dr=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),ur={class:"mt-2"},pr=a("h1",{class:"text-2xl text-center"},"Settings ",-1),fr={class:"mt-1"},gr=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," visual ",-1),hr={class:"my-2"},mr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable blurred windows",-1),br=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," collaboration ",-1),yr={class:"my-2"},vr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Show other online users in selectors",-1),kr={class:"my-2"},xr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Dye nodes in user color",-1),wr={class:"my-2"},_r=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Show cursors in nodes",-1),Sr=a("span",{class:"text-sm text-gray-500"},null,-1),$r=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," gravity ",-1),Nr={class:"my-2"},Cr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Use stronger gravity forces ",-1),Dr=a("span",{class:"text-sm mx-2 float-right text-gray-500"},[a("kbd",null,"\u2318"),a("kbd",null,".")],-1),Or=ce({emits:["change"],setup(e,{emit:o}){de(),fe();const{state:n,toggleInfo:r,toggleSettings:d,setDefaults:i}=re();return Z(),Z(),(b,u)=>($(),ne(t(Pe),{show:t(n).isSettingsOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(d)},{default:O(()=>[a("div",lr,[a("div",cr,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0"})]),_:1}),dr,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-3 text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-md w-full",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(n).blurredInterface}])},[a("div",null,[a("div",ur,[pr,a("div",fr,[G("",!0),G("",!0),G("",!0),gr,a("div",hr,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[mr]),_:1}),_(t(Me),{modelValue:t(n).blurredInterface,"onUpdate:modelValue":u[2]||(u[2]=f=>t(n).blurredInterface=f),class:F([t(n).blurredInterface?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(n).blurredInterface?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),br,a("div",yr,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[vr]),_:1}),_(t(Me),{modelValue:t(n).showOtherUsers,"onUpdate:modelValue":u[3]||(u[3]=f=>t(n).showOtherUsers=f),class:F([t(n).showOtherUsers?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(n).showOtherUsers?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),a("div",kr,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[xr]),_:1}),_(t(Me),{modelValue:t(n).showOtherColors,"onUpdate:modelValue":u[4]||(u[4]=f=>t(n).showOtherColors=f),class:F([t(n).showOtherColors?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(n).showOtherColors?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),a("div",wr,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[_r,Sr]),_:1}),_(t(Me),{modelValue:t(n).showOtherCursors,"onUpdate:modelValue":u[5]||(u[5]=f=>t(n).showOtherCursors=f),class:F([t(n).showOtherCursors?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(n).showOtherCursors?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),$r,a("div",Nr,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[Cr]),_:1}),Dr,_(t(Me),{modelValue:t(n).useStrongGravity,"onUpdate:modelValue":u[6]||(u[6]=f=>t(n).useStrongGravity=f),class:F([t(n).useStrongGravity?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(n).useStrongGravity?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),G("",!0),G("",!0),G("",!0),G("",!0),G("",!0),a("div",{onClick:u[12]||(u[12]=f=>{t(i)(),t(d)()}),class:"cursor-pointer text-xs font-sans font-bold m-5 text-gray-500 uppercase text-center tracking-wider"}," reset default ")])])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),Ir={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 inset-0 z-50 overflow-y-auto"},Ar={class:"text-center"},Rr=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),Lr={class:""},Tr={class:"pb-2"},Pr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Synchronize with Server",-1),Er=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"}," (when set)",-1),Ur={key:0,class:"mt-2"},Mr={class:"space-y-2"},Hr=["onClick"],Br={class:"flex dark:text-white text-black items-center"},Fr={class:"text-sm"},zr={as:"p",class:"font-medium text-gray-900 dark:text-gray-100"},jr={key:0,as:"div",class:"text-gray-500"},Wr={class:"sm:inline"},Vr=ge(" "+se(" ")+" "),Gr=a("span",{class:"hidden sm:inline sm:mx-1","aria-hidden":"true"},"\xB7",-1),Kr={key:1,class:""},Jr={class:"my-2 w-full"},qr=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Server Address",-1),Zr={class:"mt-1 relative rounded-md shadow-sm"},Xr=["onUpdate:modelValue"],Yr={class:"my-1"},Qr=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Access Code",-1),ei={class:"mt-1 relative rounded-md shadow-sm"},ti=["onUpdate:modelValue"],oi=a("p",null,"Leave empty if you want this space to remain offline.",-1),si=["onClick"],ni={as:"div",class:"mt-2 flex text-sm sm:mt-0 sm:block sm:ml-4 sm:text-right"},ai={class:"font-medium text-gray-900 dark:text-gray-300"},ri=ce({emits:["change"],setup(e,{emit:o}){const n=de(),r=fe(),{state:d,toggleInfo:i,toggleProvider:b,toggleSelector:u,toggleOnly:f}=re(),{localSpaces:I,resetSpaces:g,getSpace:p}=nt();Z(),Z();const w=Z(I.value.spaces[0]);return(C,K)=>($(),ne(t(Pe),{show:t(d).isProviderOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(b)},{default:O(()=>[a("div",Ir,[a("div",Ar,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0"})]),_:1}),Rr,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(d).blurredInterface}])},[a("div",null,[a("div",Lr,[a("div",Tr,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[Pr,Er]),_:1}),_(t(Me),{modelValue:t(d).useHocuspocus,"onUpdate:modelValue":K[0]||(K[0]=S=>t(d).useHocuspocus=S),class:F([t(d).useHocuspocus?"bg-green-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(d).useHocuspocus?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),($(),M("div",Ur,[a("div",null,[a("div",Mr,[($(!0),M(be,null,Oe(t(I).spaces,S=>($(),M("div",{as:"template",key:S.id,onClick:R=>w.value=S.id},[a("div",{class:F([S.id!==w.value?"border-transparent":"border-gray-300 ring-2 ring-blue-600",S.id===t(n).params.space?" ring-2 ring-blue-600 bg-blue-300 dark:bg-blue-600 bg-opacity-50 dark:bg-opacity-50":"","relative block border rounded-lg shadow-sm px-6 py-4 cursor-pointer sm:flex sm:justify-between focus:outline-none dark:bg-opacity-50 bg-opacity-50"])},[a("div",Br,[a("div",Fr,[a("div",zr,se(S.name),1),S.url?($(),M("div",jr,[a("p",Wr,se(S.url)+" / "+se(S.id),1),Vr,Gr])):G("",!0),w.value===S.id?($(),M("div",Kr,[a("div",Jr,[qr,a("div",Zr,[Re(a("input",{"onUpdate:modelValue":R=>S.url=R,tabindex:"0",type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"wss://causa.lity.cc"},null,8,Xr),[[Le,S.url]])])]),a("div",Yr,[Qr,a("div",ei,[Re(a("input",{"onUpdate:modelValue":R=>S.token=R,type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"xxxx-xxxx-xxxx-xxxx"},null,8,ti),[[Le,S.token]])])]),oi,S.id!==t(n).params.space?($(),M("button",{key:0,type:"button",class:"mt-2 rounded-lg p-3 shadow-xl bg-blue-700 text-white bg-opacity-50",onClick:R=>{t(r).push(`/${S.id}/`),t(f)("selector")}}," Set as current Space ",8,si)):G("",!0)])):G("",!0)])]),a("div",ni,[a("div",ai,"/"+se(S.id),1)]),a("div",{class:F([S.id===t(n).params.space?"border":"border-2",S.id===w.value?"border-white":"border-opacity-50","absolute -inset-px rounded-lg pointer-events-none"]),"aria-hidden":"true"},null,2)],2)],8,Hr))),128))])])])),G("",!0),G("",!0)])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),ii={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},li={class:"text-center"},ci=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),di={class:""},ui={key:0,class:"mt-2"},pi={class:"mt-2"},fi=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Display Name",-1),gi={class:"mt-1 relative rounded-md shadow-sm"},hi={class:"mt-2"},mi=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Color",-1),bi={class:"mt-1 relative rounded-md shadow-sm"},yi={class:"absolute inset-y-0 right-0 flex py-0.5 pr-1.5"},vi={type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 focus:z-10 focus:outline-none"},ki={class:"mt-4"},xi={class:"flex justify-between","aria-label":"Tabs"},wi=["onClick"],_i=ce({emits:["change"],setup(e,{emit:o}){de(),fe();const{state:n,toggleInfo:r,toggleProvider:d,toggleUser:i}=re();Z(),Z();const b=[{color:"#00a492",current:!1},{color:"#00b1ff",current:!1},{color:"#ffc711",current:!1},{color:"#F98181",current:!1},{color:"#b7f981",current:!1},{color:"#81eff9",current:!1},{color:"#8183f9",current:!1},{color:"#d181f9",current:!1},{color:"#f9ab81",current:!1},{color:"#f9e181",current:!1}];return(u,f)=>($(),ne(t(Pe),{show:t(n).isUserOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(i)},{default:O(()=>[a("div",ii,[a("div",li,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0"})]),_:1}),ci,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-80 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(n).blurredInterface}])},[a("div",null,[a("div",di,[($(),M("div",ui,[a("div",pi,[fi,a("div",gi,[Re(a("input",{"onUpdate:modelValue":f[0]||(f[0]=I=>t(n).localUserName=I),type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"Name"},null,512),[[Le,t(n).localUserName]])])]),a("div",hi,[mi,a("div",bi,[Re(a("input",{"onUpdate:modelValue":f[1]||(f[1]=I=>t(n).localUserColor=I),type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"Color"},null,512),[[Le,t(n).localUserColor]]),a("div",yi,[a("button",vi,[a("i",{class:"ri-paint-brush-fill text-2xl",style:ot("color: "+t(n).localUserColor)},null,4)])])])]),a("div",ki,[a("nav",xi,[($(),M(be,null,Oe(b,I=>a("span",{onClick:g=>t(n).localUserColor=I.color,key:I.color,style:ot("cursor: pointer; background: "+I.color),class:F([[I.current?" text-gray-700":"text-gray-500 hover:text-gray-700","transition transition-opacity hover:opacity-50 px-3 py-2 font-medium text-sm rounded-md"],"inline-flex items-center justify-center h-8 w-8 rounded-full"])},null,14,wi)),64))])])]))])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),Si={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},$i={class:"text-center"},Ni=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),Ci={class:""},Di={class:""},Oi={class:"mt-0"},Ii=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Share Gravity",-1),Ai=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"}," (using WebRTC until restart)",-1),Ri={key:0,class:"mt-2"},Li=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Share Link",-1),Ti={class:"mt-1 relative rounded-md shadow-sm"},Pi=["value"],Ei={key:1,class:"mt-2"},Ui=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},[ge("Password"),a("span",{class:"text-sm text-gray-500 dark:text-gray-400"}," (leave empty for an open room)")],-1),Mi={class:"mt-1 relative rounded-md shadow-sm"},Hi=ce({emits:["share","stop-sharing"],setup(e,{emit:o}){de(),fe();const{state:n,toggleShare:r}=re();Z(),Z();const d=Z();return Ie(()=>{const i=window.location.href.match("(.*)#\\/(.+)");i&&i.length>1&&(d.value="https://app.lity.cc/#/"+i[2])}),(i,b)=>($(),ne(t(Pe),{show:t(n).isShareOpen,as:"template"},{default:O(()=>[_(t(Te),{as:"div",onClose:t(r)},{default:O(()=>[a("div",Si,[a("div",$i,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:O(()=>[_(t(Ae),{class:"fixed inset-0"})]),_:1}),Ni,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:O(()=>[a("div",{class:F(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(n).blurredInterface}])},[a("div",null,[a("div",Ci,[a("div",Di,[a("div",Oi,[_(t(Ee),{as:"div",class:"flex justify-between"},{default:O(()=>[_(t(Ue),{as:"span",class:""},{default:O(()=>[Ii,Ai]),_:1}),_(t(Me),{modelValue:t(n).useWebRtc,"onUpdate:modelValue":b[0]||(b[0]=u=>t(n).useWebRtc=u),class:F([t(n).useWebRtc?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:O(()=>[a("span",{"aria-hidden":"true",class:F([t(n).useWebRtc?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),t(n).useWebRtc?($(),M("div",Ri,[Li,a("div",Ti,[a("input",{type:"text",name:"webrtc-password",readonly:"",value:d.value,class:"h-8on bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg select-all",placeholder:"Share Link"},null,8,Pi)])])):G("",!0),t(n).useWebRtc?($(),M("div",Ei,[Ui,a("div",Mi,[Re(a("input",{type:"text",name:"webrtc-password","onUpdate:modelValue":b[1]||(b[1]=u=>t(n).localWebRtcPassword=u),class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"Room Password"},null,512),[[Le,t(n).localWebRtcPassword]])])])):G("",!0)])])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),Bi={class:"w-screen h-screen"},rt={setup(e){const{redirect:o,isRedirected:n,spaceId:r,spaceUrl:d,spaceToken:i}=nt();return o(),(b,u)=>($(),M("div",Bi,[_(Or),_(ri),_(_i),_(Hi),t(n)?($(),ne(ir,{"space-id":t(r),key:t(r),"space-token":t(i),"space-url":t(d)},null,8,["space-id","space-token","space-url"])):G("",!0)]))}},Fi=[{path:"/",component:rt},{path:"/:space",component:rt},{path:"/:space/:document",component:rt},{path:"/:space/:document/:node",component:rt}],zi=Ho({history:Bo(),linkActiveClass:"text-gray-900 font-bold",routes:Fi});var it;(function(e){e.INCREMENT="INCREMENT",e.RESTORE="RESTORE"})(it||(it={}));const ji={[it.INCREMENT](e,o=1){e.count+=o},[it.RESTORE](e,o){o.localUserName&&(e.localUserName=o.localUserName),o.localUserColor&&(e.localUserColor=o.localUserColor),o.serverAddress&&(e.serverAddress=o.serverAddress),o.serverToken&&(e.serverToken=o.serverToken),o.v1&&(e.v1=o.v1)}};var He;(function(e){e.initApp="initApp",e.openInfo="openInfo",e.openSelector="openSelector",e.openSettings="openSettings",e.openSearch="openSearch"})(He||(He={}));const Wi={[He.initApp]({state:e,commit:o,dispatch:n}){},[He.openSelector]({state:e,commit:o,dispatch:n}){e.isSelectorOpen=!e.isSelectorOpen},[He.openInfo]({state:e,commit:o,dispatch:n}){e.isInfoOpen=!e.isInfoOpen},[He.openSettings]({state:e,commit:o,dispatch:n}){e.isSettingsOpen=!e.isSettingsOpen},[He.openSearch]({state:e,commit:o,dispatch:n}){e.isSearchOpen=!e.isSearchOpen}},Vi={isReady(e){return!e.isInitialized}},Gi="1.2.3",Ki={debug:!1,version:Gi,isInitialized:!1,isOffline:!1,count:0,localUserName:"",localUserColor:"",localUserId:"",serverAddress:"",serverToken:"",isSettingsOpen:!1,isInfoOpen:!1,isSelectorOpen:!1,isSearchOpen:!1,useRTC:!1,useHocuspocus:!0},Ji=Fo({state:Ki,getters:Vi,mutations:ji,actions:Wi});const qi=60*60*1e3;Vt({onRegistered(e){e&&setInterval(()=>{e.update()},qi)}});const Zi=zo(),Ze=jo(Yo);Ze.use(Ji);Ze.use(zi);Ze.use(Zi);Ze.directive("katex",{updated(e,o){Wo(e,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"\\[",right:"\\]",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1}]})}});Ze.mount("#app");
