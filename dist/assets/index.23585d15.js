var io=Object.defineProperty,lo=Object.defineProperties;var co=Object.getOwnPropertyDescriptors;var Ot=Object.getOwnPropertySymbols;var uo=Object.prototype.hasOwnProperty,po=Object.prototype.propertyIsEnumerable;var It=(e,o,s)=>o in e?io(e,o,{enumerable:!0,configurable:!0,writable:!0,value:s}):e[o]=s,Ce=(e,o)=>{for(var s in o||(o={}))uo.call(o,s)&&It(e,s,o[s]);if(Ot)for(var s of Ot(o))po.call(o,s)&&It(e,s,o[s]);return e},At=(e,o)=>lo(e,co(o));import{r as X,v as fo,d as le,u as t,o as $,c as T,a,b as K,e as Ke,f as _,F as me,g as Rt,h as ge,i as de,j as oe,k as Be,D as Ye,I as Lt,A as Tt,H as Pt,W as Ut,l as Ae,m as go,n as L,p as Re,q as ne,s as ho,P as Qe,N as Et,t as Mt,S as Ht,w as Bt,x as se,y as Ft,Y as mo,z as bo,C as yo,B as vo,E as ko,L as xo,G as wo,T as _o,J as So,U as $o,K as No,M as Co,O as Do,Q as Oo,V as Io,R as Ao,X as Ro,Z as zt,_ as Lo,$ as be,a0 as To,a1 as gt,a2 as Po,a3 as N,a4 as et,a5 as ce,a6 as Fe,a7 as ue,a8 as Le,a9 as he,aa as ze,ab as We,ac as De,ad as tt,ae as Te,af as Pe,ag as Uo,ah as Wt,ai as jt,aj as je,ak as Vt,al as Gt,am as Eo,an as Oe,ao as Mo,ap as ht,aq as Ho,ar as we,as as _e,at as Se,au as Bo,av as Fo,aw as zo,ax as Wo,ay as jo}from"./vendor.1261b356.js";const Vo=function(){const o=document.createElement("link").relList;if(o&&o.supports&&o.supports("modulepreload"))return;for(const d of document.querySelectorAll('link[rel="modulepreload"]'))r(d);new MutationObserver(d=>{for(const i of d)if(i.type==="childList")for(const y of i.addedNodes)y.tagName==="LINK"&&y.rel==="modulepreload"&&r(y)}).observe(document,{childList:!0,subtree:!0});function s(d){const i={};return d.integrity&&(i.integrity=d.integrity),d.referrerpolicy&&(i.referrerPolicy=d.referrerpolicy),d.crossorigin==="use-credentials"?i.credentials="include":d.crossorigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(d){if(d.ep)return;d.ep=!0;const i=s(d);fetch(d.href,i)}};Vo();function Go(e={}){const{immediate:o=!1,onNeedRefresh:s,onOfflineReady:r,onRegistered:d,onRegisterError:i}=e;let y;const c=async(u=!0)=>{};return"serviceWorker"in navigator&&(y=new fo("/sw.js",{scope:"/"}),y.addEventListener("activated",u=>{u.isUpdate?window.location.reload():r==null||r()}),y.register({immediate:o}).then(u=>{d==null||d(u)}).catch(u=>{i==null||i(u)})),c}function Kt(e={}){const{immediate:o=!0,onNeedRefresh:s,onOfflineReady:r,onRegistered:d,onRegisterError:i}=e,y=X(!1),c=X(!1);return{updateServiceWorker:Go({immediate:o,onNeedRefresh(){y.value=!0,s==null||s()},onOfflineReady(){c.value=!0,r==null||r()},onRegistered:d,onRegisterError:i}),offlineReady:c,needRefresh:y}}const Ko={key:0,class:"pwa-toast",role:"alert"},Jo={class:"message"},qo={key:0},Zo={key:1},Xo=le({setup(e){const{offlineReady:o,needRefresh:s,updateServiceWorker:r}=Kt(),d=async()=>{o.value=!1,s.value=!1};return(i,y)=>t(o)||t(s)?($(),T("div",Ko,[a("div",Jo,[t(o)?($(),T("span",qo," App ready to work offline ")):($(),T("span",Zo," New content available, click on reload button to update. "))]),t(s)?($(),T("button",{key:0,onClick:y[0]||(y[0]=c=>t(r)())},"Reload")):K("",!0),a("button",{onClick:d},"Close")])):K("",!0)}});const Yo=le({setup(e){return(o,s)=>{const r=Ke("router-view");return $(),T(me,null,[_(Xo),_(r)],64)}}}),Jt=()=>navigator.userAgent.indexOf("Mac OS X")!==-1,Qo=()=>/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent),es=()=>{let e=!1;const o=document.createElement("div");if(CSS.supports("padding-bottom: env(safe-area-inset-bottom)")?(o.style.paddingBottom="env(safe-area-inset-bottom)",e=!0):CSS.supports("padding-bottom: constant(safe-area-inset-bottom)")&&(o.style.paddingBottom="constant(safe-area-inset-bottom)",e=!0),e){document.body.appendChild(o);const s=parseInt(window.getComputedStyle(o).paddingBottom);if(document.body.removeChild(o),s>0)return!0}return!1};function ts(e){return Jt()?e.metaKey:e.ctrlKey}const os=()=>"xxx-xxx-xxx".replace(/[xy]/g,function(e){const o=Math.random()*16|0;return(e=="x"?o:o&3|8).toString(16)}),mt=e=>e[Math.floor(Math.random()*e.length)],ss=()=>mt(["Isaac Newton","Friedrich Nietzsche","Johann Wolfgang von Goethe","Carl Jung","Steve Jobs","Ernesto Guevara","Robert M. Pirsig","Nikola Tesla","Leonardo da Vinci","Archimedes","Johannes Gutenberg","Galileo Galilei","Albert Einstein","Carl Benz","Steve Wozniak","Alfred Nobel","Hedy Lamarr","Ada Lovelace","Stephanie Kwolek","Grace Hopper","Konrad Zuse"]),ns=()=>mt(as()),as=()=>["#00a492","#00b1ff","#ffc711","#F98181","#b7f981","#81eff9","#8183f9","#d181f9","#f9ab81","#f9e181"],rs=e=>{let o="";if(Array.isArray(e))for(let s=0;s<e.length;s++)o+=e[s].text;else o=e;return o},is=e=>new Promise(o=>setTimeout(o,e)),ls=e=>{e=e.replace(/^\s+|\s+$/g,""),e=e.toLowerCase();const o="\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;",s="aaaaeeeeiiiioooouuuunc------";for(let r=0,d=o.length;r<d;r++)e=e.replace(new RegExp(o.charAt(r),"g"),s.charAt(r));return e=e.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),e},cs=e=>Array.from(e.entries()).map(([o,s])=>Ce({clientId:o},s.user));function ds(e,o,s){let r={};const d=e.getMap().get(o);d&&(r=d),r.title=s.title,r.count=3,r.updatedAt=new Date().toISOString(),r.guid||(r.guid=o),r.filled=!0,r.createdAt||(r.createdAt=new Date().toISOString()),e.getMap().set(o,r)}const ye=()=>({isMac:Jt,isMobile:Qo,hasNotch:es,osKey:ts,uuid:os,delay:is,getPlainText:rs,getRandomElement:mt,getRandomUser:ss,getRandomColor:ns,stringToSlug:ls,updateDoc:ds,awarenessStatesToArray:cs}),{uuid:us,getRandomUser:ps,getRandomColor:fs}=ye(),bt="1.2.0",gs="",hs="",ms="",qt=!1,Zt=[],bs=e=>{P.value.debug&&console.log(e),P.value.debug&&Zt.push(e)},Xt={debug:qt,version:bt,useHocuspocus:!0,serverAddress:hs,serverToken:gs,useWebRtc:!1,signalingServerAddress:ms,localUserName:ps(),localUserId:us(),localUserColor:fs(),localWebRtcPassword:"",localLatestSpace:null,localLatestDocument:null,localLatestNode:null,isSettingsOpen:!1,isInfoOpen:!1,isSelectorOpen:!1,isSearchOpen:!1,isUserOpen:!1,isShareOpen:!1,isProviderOpen:!1,blurredInterface:!1,useLatestDocument:!0,showOtherColors:!0,showOtherUsers:!0,showOtherCursors:!0,useStrongGravity:!0,fixNodesOnDrag:!0,unfixLastNode:!0,zoomInOnNodeClick:!0,followNewlyCreatedNode:!0,followNewlyCreatedNodeMention:!0},P=Rt("local-lity-states",Xt),ys=()=>{P.value=Xt},Yt=()=>{P.value.isSelectorOpen=!1,P.value.isSearchOpen=!1,P.value.isSettingsOpen=!1,P.value.isInfoOpen=!1,P.value.isProviderOpen=!1,P.value.isUserOpen=!1,P.value.isShareOpen=!1,P.value.useWebRtc=!1,P.value.version<bt&&(P.value.version=bt,P.value.isInfoOpen=!0)},vs=()=>{},ks=e=>{P.value.isSelectorOpen=e==="selector"?!P.value.isSelectorOpen:!1,P.value.isSearchOpen=e==="search"?!P.value.isSearchOpen:!1,P.value.isSettingsOpen=e==="settings"?!P.value.isSettingsOpen:!1,P.value.isInfoOpen=e==="info"?!P.value.isInfoOpen:!1,P.value.isProviderOpen=e==="provider"?!P.value.isProviderOpen:!1,P.value.isUserOpen=e==="user"?!P.value.isUserOpen:!1,P.value.isShareOpen=e==="share"?!P.value.isShareOpen:!1},xs=e=>{P.value.isSelectorOpen=!P.value.isSelectorOpen},ws=e=>{P.value.isSearchOpen=!P.value.isSearchOpen},_s=e=>{P.value.isSettingsOpen=!P.value.isSettingsOpen},Ss=e=>{P.value.isInfoOpen=!P.value.isInfoOpen},$s=e=>{P.value.isProviderOpen=!P.value.isProviderOpen},Ns=e=>{P.value.isUserOpen=!P.value.isUserOpen},Cs=e=>{P.value.isShareOpen=!P.value.isShareOpen};Yt();const ae=()=>({state:P,debug:qt,debugLog:Zt,toggleOnly:ks,logger:bs,checkForOpenWindows:vs,toggleSelector:xs,toggleSearch:ws,toggleSettings:_s,toggleProvider:$s,toggleInfo:Ss,toggleUser:Ns,toggleShare:Cs,setDefaults:ys,setAppDefaults:Yt}),{uuid:yt,stringToSlug:Ds}=ye(),ve=Rt("local-lity-spaces",{spaces:[]}),ot=()=>{const e=ge(),o=de(),s=X(!1),r=oe(()=>o.params.space),d=oe(()=>o.params.space&&u(o.params.space)?u(o.params.space).url:""),i=oe(()=>o.params.space&&u(o.params.space)?u(o.params.space).token:""),y=()=>{g(),s.value=!0},c=(D,R,W,E)=>{const O=R?Ds(R):yt(),F={id:D||O,name:R||"LocalStorage",url:W||null,token:E||null,index:o.params.document||yt()};ve.value.spaces.push(F)},u=D=>{for(let R=0;R<ve.value.spaces.length;R++)if(ve.value.spaces[R].id===D)return ve.value.spaces[R];return null},I=()=>ve.value.spaces[0],g=()=>{ve.value.spaces.length===0?p():(o.params.space&&(u(o.params.space)||c(o.params.space,"Shared Space",null,null)),o.params.space?o.params.space&&!o.params.document&&C(u(o.params.space)):C(I()))},p=()=>{ve.value.spaces=[],c(),c("causa-lity-cc","Lity.CC (readme only)","wss://causa.lity.cc","READ-ME-ONLY"),c("y","LocalStorage (previous versions)"),o.params.space?u(o.params.space)||c(o.params.space,"Shared Space",null,null):C(I())},S=(D,R)=>{for(let W=0;W<ve.value.spaces.length;W++)ve.value.spaces[W].id===D&&(ve.value.spaces[W].index=R)},C=D=>{e.push(`/${D.id}/${D.index}/index`)};return{localSpaces:ve,resetSpaces:p,redirect:y,isRedirected:s,spaceId:r,spaceUrl:d,spaceToken:i,setIndex:S,getSpace:u,createSpace:c,setGravity:D=>{e.push(`/${o.params.space}/${D||yt()}/index`)},createDefaultSpace:g}},{state:al,logger:Os}=ae();ot();const Is=e=>{const o=Be({hasLoadedRootDoc:!1}),s=new Ye({guid:e,autoLoad:!0}),r=s.getMap(),d=s.getMap("settings"),i=s.getText("latest"),y=new Lt(e,s),c=X();return y.once("synced",()=>{Os("useRootDoc: yRootIndexedDb -> synced"),o.hasLoadedRootDoc=!0,c.value=Object.entries(r.toJSON());for(let u=0;u<c.value.length;u++)c.value[u][1].filled||r.delete(c.value[u][1].guid);r.observe(()=>{c.value=Object.entries(r.toJSON())})}),{rootState:o,yRootDoc:s,yRootDocs:r,yRootSettings:d,yRootLatestDoc:i,yRootIndexedDb:y,jRootDocs:c}},{awarenessStatesToArray:As}=ye(),Rs=e=>{const{state:o,logger:s}=ae(),r=Be({hocuspocus:{init:!1,connected:!1,authenticated:!1,readOnly:!1,awareness:[]},rtc:{init:!1,connected:!1,readOnly:!1,awareness:[]}});let d,i;const y=new Tt(e),c=(p,S)=>{s("useRootDocProvider: provideRootHocuspocus"),p&&(d=new Pt({url:p,name:e.guid,document:e,token:S,awareness:y,onAwarenessUpdate:({states:C})=>{r.hocuspocus.awareness=C},onConnect:()=>{r.hocuspocus.connected=!0},onAuthenticated:()=>{},onAuthenticationFailed:()=>{},onMessage:({event:C,message:j})=>{},onClose:({event:C})=>{r.hocuspocus.connected=!1},onDisconnect:({event:C})=>{r.hocuspocus.connected=!1}}),r.hocuspocus.init=!0,d.setAwarenessField("user",{name:o.value.localUserName,color:o.value.localUserColor}))},u=()=>{i=new Ut(e.guid,e,{awareness:y,password:o.value.localWebRtcPassword}),r.rtc.init=!0,r.rtc.connected=!0,i.awareness.setLocalStateField("user",{name:o.value.localUserName,color:o.value.localUserColor}),i.awareness.on("update",()=>{r.rtc.awareness=As(i.awareness.states)})},I=()=>d.destroy();r.hocuspocus.connected=!1;const g=()=>i.destroy();return r.rtc.connected=!1,Ae(()=>{d&&I(),i&&g()}),{rootStates:r,rootHocuspocusProvider:d,rootWebRtcProvider:i,rootAwareness:y,provideRootHocuspocus:c,provideRootWebRtc:u,destroyRootHocuspocus:I,destroyRootWebRtc:g}};var vt=(e,o)=>{for(const[s,r]of o)e[s]=r;return e};const Ls={props:{icon:{type:String,required:!0},title:{type:String,required:!0},action:{type:Function,required:!0},isActive:{type:Function,default:null}},data(){return{remixiconUrl:go}}},Ts=["title"],Ps={class:"remix"},Us=["xlink:href"];function Es(e,o,s,r,d,i){return $(),T("button",{class:L(["menu-item text-black dark:text-white hover:bg-opacity-50 hover:bg-gray-300 dark:hover:bg-gray-800",{"bg-gray-200 dark:bg-gray-900 text-blue-500 dark:text-blue-500":s.isActive?s.isActive():null}]),title:s.title,onClick:o[0]||(o[0]=(...y)=>s.action&&s.action(...y))},[($(),T("svg",Ps,[a("use",{"xlink:href":`${d.remixiconUrl}#ri-${s.icon}`},null,8,Us)]))],10,Ts)}var Ms=vt(Ls,[["render",Es]]);const Hs={components:{MenuItem:Ms},props:{editor:{type:Object,required:!0},pane:{type:Object}},data(){return{items:[{icon:"bold",title:"Bold",action:()=>this.editor.chain().focus().toggleBold().run(),isActive:()=>this.editor.isActive("bold")},{icon:"italic",title:"Italic",action:()=>this.editor.chain().focus().toggleItalic().run(),isActive:()=>this.editor.isActive("italic")},{icon:"strikethrough",title:"Strike",action:()=>this.editor.chain().focus().toggleStrike().run(),isActive:()=>this.editor.isActive("strike")},{icon:"code-view",title:"Code",action:()=>this.editor.chain().focus().toggleCode().run(),isActive:()=>this.editor.isActive("code")},{icon:"mark-pen-line",title:"Highlight",action:()=>this.editor.chain().focus().toggleHighlight().run(),isActive:()=>this.editor.isActive("highlight")},{type:"divider"},{icon:"h-1",title:"Heading 1",action:()=>this.editor.chain().focus().toggleHeading({level:1}).run(),isActive:()=>this.editor.isActive("heading",{level:1})},{icon:"h-2",title:"Heading 2",action:()=>this.editor.chain().focus().toggleHeading({level:2}).run(),isActive:()=>this.editor.isActive("heading",{level:2})},{icon:"paragraph",title:"Paragraph",action:()=>this.editor.chain().focus().setParagraph().run(),isActive:()=>this.editor.isActive("paragraph")},{icon:"list-unordered",title:"Bullet List",action:()=>this.editor.chain().focus().toggleBulletList().run(),isActive:()=>this.editor.isActive("bulletList")},{icon:"list-ordered",title:"Ordered List",action:()=>this.editor.chain().focus().toggleOrderedList().run(),isActive:()=>this.editor.isActive("orderedList")},{icon:"list-check-2",title:"Task List",action:()=>this.editor.chain().focus().toggleTaskList().run(),isActive:()=>this.editor.isActive("taskList")},{icon:"code-box-line",title:"Code Block",action:()=>this.editor.chain().focus().toggleCodeBlock().run(),isActive:()=>this.editor.isActive("codeBlock")},{type:"divider"},{icon:"double-quotes-l",title:"Blockquote",action:()=>this.editor.chain().focus().toggleBlockquote().run(),isActive:()=>this.editor.isActive("blockquote")},{icon:"separator",title:"Horizontal Rule",action:()=>this.editor.chain().focus().setHorizontalRule().run()},{type:"divider"},{icon:"text-wrap",title:"Hard Break",action:()=>this.editor.chain().focus().setHardBreak().run()},{icon:"format-clear",title:"Clear Format",action:()=>this.editor.chain().focus().clearNodes().unsetAllMarks().run()},{type:"divider"},{icon:"arrow-go-back-line",title:"Undo",action:()=>this.editor.chain().focus().undo().run()},{icon:"arrow-go-forward-line",title:"Redo",action:()=>this.editor.chain().focus().redo().run()},{type:"divider"}]}}},Bs={class:"pl-3 pr-3"};function Fs(e,o,s,r,d,i){const y=Ke("menu-item");return $(),T("div",Bs,[($(!0),T(me,null,Re(d.items,(c,u)=>($(),T(me,null,[c.type==="divider"?($(),T("span",{key:`divider${u}`,class:"divider w-8"})):($(),ne(y,ho({key:1,key:u},c),null,16))],64))),256))])}var zs=vt(Hs,[["render",Fs]]);const Ws=new Qe("mention"),js=Et.create({name:"mention",addOptions(){return{HTMLAttributes:{},renderLabel({options:e,node:o}){return`${o.attrs.label}`},suggestion:{char:"@",pluginKey:Ws,command:({editor:e,range:o,props:s})=>{var i;const r=e.view.state.selection.$to.nodeAfter;((i=r==null?void 0:r.text)==null?void 0:i.startsWith(" "))&&(o.to+=1),e.chain().focus().insertContentAt(o,[{type:this.name,attrs:s},{type:"text",text:" "}]).run()},allow:({editor:e,range:o})=>{const s=e.state.doc.resolve(o.from),r=e.schema.nodes[this.name];return!!s.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,draggable:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:"span[data-mention]"}]},renderHTML({node:e,HTMLAttributes:o}){return["span",Mt({"data-mention":"",class:"dark:bg-gray-700 dark:text-gray-200"},this.options.HTMLAttributes,o),this.options.renderLabel({options:this.options,node:e})]},renderText({node:e}){return this.options.renderLabel({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:o})=>{let s=!1;const{selection:r}=o,{empty:d,anchor:i}=r;return d?(o.doc.nodesBetween(i-1,i,(y,c)=>{if(y.type.name===this.name)return s=!0,e.insertText(this.options.suggestion.char||"",c,c+y.nodeSize),!1}),s):!1})}},addProseMirrorPlugins(){return[Ht(Ce({editor:this.editor},this.options.suggestion)),new Bt({key:new Qe("handleClick"),props:{handleClick:(e,o,s)=>{var d;const r=(d=s.target)==null?void 0:d.closest("span.mention");if(r){const i=window.location.href.match("(.*)#\\/(.+)\\/");return window.location.href=i[1]+"#/"+i[2]+"/"+r.getAttribute("data-id"),!0}return!1}}})]}});const Vs={props:{items:{type:Array,required:!0},command:{type:Function,required:!0}},data(){return{selectedIndex:0}},watch:{items(){this.selectedIndex=0}},methods:{onKeyDown({event:e}){return e.key==="ArrowUp"?(this.upHandler(),!0):e.key==="ArrowDown"?(this.downHandler(),!0):e.key==="Enter"?(this.enterHandler(),!0):!1},upHandler(){this.selectedIndex=(this.selectedIndex+this.items.length-1)%this.items.length},downHandler(){this.selectedIndex=(this.selectedIndex+1)%this.items.length},enterHandler(){this.selectItem(this.selectedIndex)},selectItem(e){const o=this.items[e];o&&this.command({id:o.id,label:o.label})}}},Gs={class:"items text-sm bg-white dark:bg-black shadow-xl backdrop-filter backdrop-blur2 backdrop-blur-lg font-mono p-0.5"},Ks=["onClick"];function Js(e,o,s,r,d,i){return $(),T("div",Gs,[($(!0),T(me,null,Re(s.items,(y,c)=>($(),T("button",{key:c,class:L(["item text-gray-700 dark:text-gray-200 rounded-sm",{"dark:bg-blue-600 bg-blue-300 text-white ring-2 ring-blue-600 ":c===d.selectedIndex}]),onClick:u=>i.selectItem(c)},se(y.label),11,Ks))),128))])}var qs=vt(Vs,[["render",Js],["__scopeId","data-v-59e8ae84"]]);const{awarenessStatesToArray:Zs}=ye(),Qt=()=>{const{state:e,logger:o}=ae(),s=Be({init:!1,hocuspocus:{init:!1,connected:!1,authenticated:!1,readOnly:!1,awareness:[]},rtc:{init:!1,connected:!1,readOnly:!1,awareness:[]}});let r,d;const i=p=>(d=p,r=new Tt(d),r);let y,c;const u=(p,S)=>!p&&!S?null:(y=new Pt({url:p,name:d.guid,document:d,token:S,awareness:r,onAwarenessUpdate:({states:C})=>{s.hocuspocus.awareness=C},onConnect:()=>{},onAuthenticated:()=>{},onAuthenticationFailed:()=>{},onMessage:({event:C,message:j})=>{},onClose:({event:C})=>{},onDisconnect:({event:C})=>{}}),s.hocuspocus.init=!0,y.setAwarenessField("user",{name:e.value.localUserName,color:e.value.localUserColor}),g(),y),I=()=>(c=new Ut(d.guid,d,{awareness:r,password:e.value.localWebRtcPassword}),s.rtc.init=!0,s.rtc.connected=!0,c.awareness.setLocalStateField("user",{test1:!0,name:e.value.localUserName,color:e.value.localUserColor}),c.awareness.on("update",()=>{s.rtc.awareness=Zs(c.awareness.states)}),c),g=()=>{r.setLocalStateField("user",{latestDocument:"route.params.document",latestNode:"route.params.node",test:!0,name:e.value.localUserName,color:e.value.localUserColor})};return{subStates:s,subAwareness:r,subWebRtcProvider:c,subHocuspocusProvider:y,provideAwareness:i,provideSubHocuspocus:u,provideSubWebRtc:I}},Xs=new Qe("meta");Et.create({name:"meta",addOptions(){return{HTMLAttributes:{},renderLabel({options:e,node:o}){return`${o.attrs.label}`},suggestion:{char:"#",pluginKey:Xs,command:({editor:e,range:o,props:s})=>{var i;const r=e.view.state.selection.$to.nodeAfter;((i=r==null?void 0:r.text)==null?void 0:i.startsWith(" "))&&(o.to+=1),e.chain().focus().insertContentAt(o,[{type:this.name,attrs:s},{type:"text",text:" "}]).run()},allow:({editor:e,range:o})=>{const s=e.state.doc.resolve(o.from),r=e.schema.nodes[this.name];return!!s.parent.type.contentMatch.matchType(r)}}}},group:"inline",inline:!0,draggable:!0,selectable:!1,atom:!0,addAttributes(){return{id:{default:null,parseHTML:e=>e.getAttribute("data-id"),renderHTML:e=>e.id?{"data-id":e.id}:{}},label:{default:null,parseHTML:e=>e.getAttribute("data-label"),renderHTML:e=>e.label?{"data-label":e.label}:{}}}},parseHTML(){return[{tag:"span[data-meta]"}]},renderHTML({node:e,HTMLAttributes:o}){return["i",Mt({"data-meta":"",class:"dark:bg-gray-700 dark:text-gray-200 ri-"+e.attrs.label+"-fill"},this.options.HTMLAttributes,o)]},renderText({node:e}){return this.options.renderLabel({options:this.options,node:e})},addKeyboardShortcuts(){return{Backspace:()=>this.editor.commands.command(({tr:e,state:o})=>{let s=!1;const{selection:r}=o,{empty:d,anchor:i}=r;return d?(o.doc.nodesBetween(i-1,i,(y,c)=>{if(y.type.name===this.name)return s=!0,e.insertText(this.options.suggestion.char||"",c,c+y.nodeSize),!1}),s):!1})}},addProseMirrorPlugins(){return[Ht(Ce({editor:this.editor},this.options.suggestion)),new Bt({key:new Qe("handleClick"),props:{handleClick:(e,o,s)=>{var d;const r=(d=s.target)==null?void 0:d.closest("span.meta");if(r){const i=window.location.href.match("(.*)#\\/(.+)\\/");return window.location.href=i[1]+"#/"+i[2]+"/"+r.getAttribute("data-id"),!0}return!1}}})]}});const Ys=Ft.extend({content:"heading block*"}),{state:Ve,logger:rl}=ae();Qt();const Qs=(e,o,s,r,d,i)=>{const y=de();ge(),X([]);const{isMobile:c,getPlainText:u,delay:I}=ye(),g=o.getMap("nodes"),p=o.getMap("links"),S=new mo,C=g.get(s);let j;const D=[Ys,bo.configure({history:!1,document:!1,codeBlock:!1}),yo.configure({lowlight:vo}),ko.configure({placeholder:({node:f})=>f.type.name==="heading"?C&&C.href?"Type a title for "+C.href:"Type a title for "+s:"/"}),xo,wo,_o,So,$o,No,Co,Do,Oo,js.configure({HTMLAttributes:{class:"mention"},suggestion:{allowSpaces:!0,items:({query:f})=>{const b=Object.values(g.toJSON()),m=[];return b.forEach(v=>{const A=v.id!==v.title?u(v.title):v.title;m.push({id:v.id,label:A})}),f.length>0&&m.push({id:Math.floor(new Date().getTime()+Math.random()),label:f}),m.filter(v=>v.label.toLowerCase().includes(f.toLowerCase())).slice(0,10)},render:()=>{let f,b;return{onStart:m=>{f=new Io(qs,{props:m,editor:m.editor}),b=Ao("body",{getReferenceClientRect:m.clientRect,appendTo:()=>document.body,content:f.element,showOnCreate:!0,interactive:!0,trigger:"manual",placement:"bottom-start"})},onUpdate(m){f.updateProps(m),b[0].setProps({getReferenceClientRect:m.clientRect})},onKeyDown(m){var v;return m.event.key==="Escape"?(b[0].hide(),!0):(v=f.ref)==null?void 0:v.onKeyDown(m)},onExit(){b[0].destroy(),f.destroy()}}}}}),Ro.configure({document:o,field:s})];r&&Ve.value.showOtherCursors&&D.push(zt.configure({provider:r,user:{name:Ve.value.localUserName,color:Ve.value.localUserColor}})),d&&!r&&Ve.value.showOtherCursors&&D.push(zt.configure({provider:d,user:{name:Ve.value.localUserName,color:Ve.value.localUserColor}}));let R=!1;const W=new Lo({autofocus:!1,extensions:D,onCreate({editor:f}){M(f),H(),j=setTimeout(()=>{f.commands.focus("end")},500)},onUpdate({editor:f}){e("onUpdate"),H();function b(m,v){let A={};const G=m.getMap().get(v);G&&(A=G),A.updatedAt=new Date().toISOString(),A.guid||(A.guid=v),A.filled=!0,A.createdAt||(A.createdAt=new Date().toISOString()),m.getMap().set(v,A)}R&&b(i,y.params.document),R||(R=!0),j&&(clearTimeout(j),j=setTimeout(()=>{M(f)},200))},onFocus({editor:f}){e("onFocus"),H(),f.commands.focus("end")},onBlur({editor:f}){e("onBlur")}}),E=f=>{const b=[];let m;if(Array.isArray(f)){for(let v=0;v<f.length;v++)if(Array.isArray(f[v].content)){for(let A=0;A<f[v].content.length;A++)if(Array.isArray(f[v].content)&&Array.isArray(f[v].content[A].marks)){m={title:void 0,href:void 0},m.title=f[v].content[A].text;for(let G=0;G<f[v].content[A].marks.length;G++)m.href=f[v].content[A].marks[G].attrs.href,b.push(m)}}}return b},O=f=>{const b=[];let m;function v(A){if(Array.isArray(A)){for(let G=0;G<A.length;G++)if(Array.isArray(A[G].content)){for(let U=0;U<A[G].content.length;U++)if(Array.isArray(A[G].content)){const V=A[G].content[U];V.type==="mention"?(m={title:V.attrs.label,id:V.attrs.id},b.push(m)):V.content&&v(V.content)}}}}return v(f),b};function F(f){f=f.replace(/^\s+|\s+$/g,""),f=f.toLowerCase();const b="\xE0\xE1\xE4\xE2\xE8\xE9\xEB\xEA\xEC\xED\xEF\xEE\xF2\xF3\xF6\xF4\xF9\xFA\xFC\xFB\xF1\xE7\xB7/_,:;",m="aaaaeeeeiiiioooouuuunc------";for(let v=0,A=b.length;v<A;v++)f=f.replace(new RegExp(b.charAt(v),"g"),m.charAt(v));return f=f.replace(/[^a-z0-9 -]/g,"").replace(/\s+/g,"-").replace(/-+/g,"-"),f}function M(f){let b={id:s,title:s,group:1,created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]};const m=g.get(s);m&&(b=m,b.created||(b.created=new Date().toISOString(),g.set(s,b)));const v=f.getJSON().content;if(v&&v[0]){const A=v[0].content?v[0].content:"";if(A&&u(A)!==u(b.title)&&(b.title=A,g.set(s,b),s==="index"?function(U,V){let z={};const Z=U.getMap().get(V);Z&&(z=Z),z.title=b.title,z.updatedAt=new Date().toISOString(),z.guid||(z.guid=V),z.filled=!0,z.createdAt||(z.createdAt=new Date().toISOString()),U.getMap().set(V,z)}(i,y.params.document):function(U,V){let z={};const Z=U.getMap().get(V);Z&&(z=Z),z.updatedAt=new Date().toISOString(),z.guid||(z.guid=V),z.filled=!0,z.createdAt||(z.createdAt=new Date().toISOString()),U.getMap().set(V,z)}(i,y.params.document)),A||v[0]&&!v[0].content&&b.id!==u(b.title)&&(g.set(s,b),f.commands.setContent(b.title)),v&&v.length>=1){const G=O(v),U=E(v);for(let V=0;V<G.length;V++){const z=s.toString(),Z=G[V].id.toString(),re=p.get(z+"_"+Z),pe=g.get(Z);!re&&!pe?(g.set(Z,{id:Z,group:1,title:""+G[V].title+"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[z],links:[z]}),(async()=>{await I(100),p.set(z+"_"+Z,{target:Z,source:z,value:0})})()):!re&&pe&&(async()=>{await I(100),p.set(z+"_"+Z,{target:Z,source:z,value:0})})()}for(let V=0;V<U.length;V++){const z=s,Z=U[V].href,re=F(Z),pe=g.get(re);if((!pe||pe.href!==Z)&&(g.set(re,{id:re,group:1,title:""+Z+"",href:Z,neighbors:[z],links:[z]}),p.set(re+"_"+z,{target:z,source:re,value:0})),pe){const ke=s,$e=F(Z);g.get($e+"_"+ke)||p.set($e+"_"+ke,{target:ke,source:$e,value:0})}}}}}function H(){const f=document.getElementsByClassName("ProseMirror")[0];f&&f.clientHeight<=35?e("bottom"):f&&f.clientHeight>=36&&f.clientHeight<=229&&e("middle"),f&&f.clientHeight>=230&&e("top")}return{yNodes:g,yLinks:p,yxmlText:S,currentNode:C,editor:W,getAllLinks:E,getAllMentions:O,stringToSlug:F,managePane:M,changePane:H}};const en=a("i",{class:"ri-arrow-left-circle-fill text-2xl"},null,-1),tn=[en],on=a("i",{class:"ri-arrow-right-circle-fill text-2xl"},null,-1),sn=[on],nn=a("i",{class:"ri-close-circle-fill text-2xl"},null,-1),an=[nn],rn=le({props:{yRootDoc:null,yRootDocs:null,jRootDocs:null,ySubDoc:null,ySubDocIndexedDb:null,ySubDocs:null,jSubDocs:null,spaceId:null,docId:null,nodeId:null,hocuspocusProvider:null,webRtcProvider:null,subStates:null,paneVisible:null,paneState:null},emits:["onFocus","onBlur","onUpdate","bottom","middle","top","hide","back","forward","switch"],setup(e,{emit:o}){const s=e,r=()=>{const y=document.getElementsByClassName("editor__content")[0];y.scrollTop<=-50&&o("bottom"),y.scrollTop>=50&&o("top")},{state:d}=ae(),{editor:i}=Qs(o,s.ySubDoc,s.nodeId,s.hocuspocusProvider,s.webRtcProvider,s.yRootDoc);return Ae(()=>{i.destroy()}),(y,c)=>($(),T(me,null,[t(i)?($(),T("div",{key:0,style:{width:"100%","margin-top":"-1px"},class:L(["mt-0 m-0 rounded-t-lg fixed z-20 top-0 flex bg-white dark:bg-lityblack",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(d).blurredInterface}])},[a("button",{class:"relative pt-0 p-1 pl-0 ml-3 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:c[0]||(c[0]=u=>o("back"))},tn),a("button",{class:"relative pt-0 p-1 pl-0 ml-1 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:c[1]||(c[1]=u=>o("forward"))},sn),_(zs,{class:"editor__header my-2 w-auto mx-auto overflow-x-scroll whitespace-nowrap",editor:t(i)},null,8,["editor"]),a("button",{class:"relative pt-0 p-1 pr-0 mr-1 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:c[2]||(c[2]=u=>o("switch"))},[a("i",{class:L(["text-2xl",{"ri-arrow-down-circle-fill":e.paneState==="top","ri-arrow-up-circle-fill":e.paneState!=="top"}])},null,2)]),a("button",{class:"relative pt-0 p-1 pr-0 mr-3 inline-flex items-center bg-transparent text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:outline-none",type:"button",onClick:c[3]||(c[3]=u=>o("hide"))},an)],2)):K("",!0),t(i)?($(),ne(t(To),{key:1,onScroll:r,onClick:c[4]||(c[4]=be(u=>t(i).commands.focus("end"),["self"])),class:"editor__content dark:text-white fixed top-0 bottom-10 left-0 right-0 overflow-y-scroll p-3 pt-12 select-auto",style:{height:"calc(95%)"},editor:t(i)},null,8,["editor"])):K("",!0)],64))}}),ln={class:"flex flex-col flex-nowrap items-center rounded-t-md rounded-b-md"},cn={class:"relative z-0 inline-flex"},dn=a("input",{id:"input",class:"hidden",type:"text"},null,-1),un=a("i",{class:"ri-asterisk text-2xl"},null,-1),pn=[un],fn=a("i",{class:"ri-search-line text-2xl"},null,-1),gn=[fn],hn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),mn=a("i",{class:"ri-refresh-line text-2xl"},null,-1),bn=[mn],yn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),vn=a("i",{class:"ri-share-fill text-2xl"},null,-1),kn=[vn],xn=a("i",{class:"ri-add-circle-fill text-2xl"},null,-1),wn=[xn],_n=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),Sn=a("i",{class:"ri-delete-bin-fill text-2xl"},null,-1),$n=[Sn],Nn=a("i",{class:"ri-scissors-fill text-2xl"},null,-1),Cn=[Nn],Dn=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),On=a("i",{class:"ri-arrow-go-back-fill text-2xl"},null,-1),In=[On],An=a("i",{class:"ri-arrow-go-forward-fill text-2xl"},null,-1),Rn=[An],Ln=a("span",{class:"bg-gray-100 dark:bg-gray-700 my-2 ml-1 mr-1",style:{width:"1px"}},null,-1),Tn=a("i",{class:"ri-settings-5-fill text-2xl"},null,-1),Pn=[Tn],Un=le({props:{unlinkingNodes:null,linkingNodes:null,deletingNodes:null},emits:["linkNodes","unlinkNodes","createNode","deleteNode","refreshGraph","undo","redo"],setup(e,{emit:o}){const s=e,r=gt();Po(r);const{state:d,toggleInfo:i,toggleSettings:y,toggleSearch:c,toggleSelector:u}=ae();return(I,g)=>($(),T("div",{style:{width:"23em"},class:L(["transition top-pane rounded-lg transition-all duration-500 ease-in-out bg-white dark:bg-lityblack absolute follower-bar ml-auto mr-auto left-0 right-0 z-10",{"dark:bg-lityblackblur bg-opacity-50 backdrop-filter backdrop-blur":t(d).blurredInterface,blur2:t(r)}])},[a("div",ln,[a("span",cn,[dn,a("button",{class:"tooltip -ml-px pl-1.5 pr-1.5 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[0]||(g[0]=(...p)=>t(u)&&t(u)(...p))},pn),a("button",{type:"button",class:"tooltip p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",onClick:g[1]||(g[1]=(...p)=>t(c)&&t(c)(...p))},gn),hn,a("button",{class:"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[2]||(g[2]=p=>o("refreshGraph"))},bn),yn,a("button",{class:L([{"text-black":!s.linkingNodes,"text-blue-500 dark:text-blue-500 animate-pulse":s.linkingNodes},"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[3]||(g[3]=p=>o("linkNodes"))},kn,2),a("button",{class:"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[4]||(g[4]=p=>o("createNode"))},wn),_n,a("button",{class:L([{"text-black":!s.deletingNodes,"text-red-500 dark:text-red-500 animate-pulse":s.deletingNodes},"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[5]||(g[5]=p=>o("deleteNode"))},$n,2),a("button",{class:L([{"text-black":!s.unlinkingNodes,"text-yellow-500 dark:text-yellow-500 animate-pulse":s.unlinkingNodes},"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[6]||(g[6]=p=>o("unlinkNodes"))},Cn,2),Dn,a("button",{class:L([{"text-black":!s.unlinkingNodes,"text-yellow-500 dark:text-yellow-500 animate-pulse":s.unlinkingNodes},"tooltip -ml-px p-0.5 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[7]||(g[7]=p=>o("undo"))},In,2),a("button",{class:L([{"text-black":!s.unlinkingNodes,"text-yellow-500 dark:text-yellow-500 animate-pulse":s.unlinkingNodes},"tooltip -ml-px p-0.5 relative inline-flex items-center text-sm font-medium dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none"]),type:"button",onClick:g[8]||(g[8]=p=>o("redo"))},Rn,2),Ln,a("button",{class:"tooltip -ml-px p-1 relative inline-flex items-center text-sm font-medium text-black dark:text-white opacity-70 hover:opacity-100 focus:z-10 focus:outline-none",type:"button",onClick:g[9]||(g[9]=(...p)=>t(y)&&t(y)(...p))},Pn)])])],2))}}),En={key:0,class:"font-medium leading-none text-white text-shadow-lg"},Mn={key:0,class:""},Hn={key:1,class:"mx-3"},Bn=le({props:{route:null,state:null},emits:["setStates"],setup(e,{emit:o}){const s=X(!1);return(r,d)=>{const i=Ke("router-link");return $(),ne(i,{onMouseenter:d[0]||(d[0]=y=>s.value=!0),onMouseleave:d[1]||(d[1]=y=>s.value=!1),disabled:!e.state.user.latestDocument,to:`/${e.route.params.space}/${e.state.user.latestDocument}/${e.state.user.latestNode?e.state.user.latestNode:"index"}`,tabindex:"1",onClick:d[2]||(d[2]=y=>o("setStates")),class:L(["inline-flex transition transition-all ease-in-out duration-500 group items-center justify-center h-10 w-10 rounded-full mr-2",{"w-auto":s.value}]),style:et("background: "+e.state.user.color)},{default:N(()=>[e.state.user&&e.state.user.name?($(),T("span",En,[s.value?K("",!0):($(),T("span",Mn,se(e.state.user.name.split(/\s/).reduce((y,c)=>y+=c.slice(0,1),"")),1)),s.value?($(),T("span",Hn,se(e.state.user.name),1)):K("",!0)])):K("",!0)]),_:1},8,["disabled","to","class","style"])}}}),Fn={class:"fixed inset-0 z-50 dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 overflow-y-auto"},zn={class:"text-center"},Wn=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),jn={class:"m-3"};const Vn={key:1,class:"relative mb-3 z-0 w-full inline-flex"},Gn=["onKeydown"],Kn={class:"absolute inset-y-0 right-0 flex py-0.5 pr-1.5"},Jn=a("i",{class:"ri-close-circle-fill text-2xl"},null,-1),qn=[Jn],Zn={key:0,class:"relative mt-3 z-0 overflow-ellipsis w-full overflow-x-scroll"},Xn={role:"list",style:{"max-height":"50vh"}},Yn={style:{"min-width":"300px"},class:"px-2 py-0"},Qn={class:"flex justify-between"},ea={class:"flex"},ta={class:"flex items-center font-bold text-sm w-48"},oa=a("div",{class:"mt-2 flex items-center mt-0"},null,-1),sa={class:"mt-1 flex items-center mb-1"},na={class:"px-2 w-28 text-sm font-medium"},aa=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"Links ",-1),ra={class:"px-2 w-48 text-sm font-medium"},ia=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"Created ",-1),la={class:"w-48 text-sm font-medium"},ca=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"Updated ",-1),da=le({props:{ySubDoc:null,jSubDocs:null,hocuspocusProvider:null,webRtcProvider:null,subStates:null},setup(e){const o=e;Ft.extend({content:"heading block*"});const s=de(),r=ge(),{state:d,toggleSearch:i}=ae(),y=X([]),c=X(""),u=oe(()=>d.value.isSearchOpen),I=oe(()=>o.jSubDocs?o.jSubDocs.filter(E=>W(E[1].title).toLowerCase().includes(c.value.toLowerCase())).slice(0,10).sort((E,O)=>W(E.title)>W(O.title)?1:W(O.title)>W(E.title)?-1:0):[]),g=X(0);ce(c,()=>{g.value=0}),ce(u,()=>{u.value?g.value=0:c.value=""});const p=()=>{g.value=(g.value+I.value.length-1)%I.value.length},S=()=>{g.value=(g.value+1)%I.value.length},C=()=>{c.value=W(I.value[g.value][1].title)},j=()=>{c.value.startsWith("{")?R(c.value):D(I.value[g.value],g.value)},D=(E,O)=>{g.value=O,i(),r.push("/"+s.params.space+"/"+s.params.document+"/"+E[0])},R=E=>{if(E){c.value="";const O=JSON.parse(E);if(O.nodes&&O.links&&O.documents){const F=Object.entries(O.links),M=Object.entries(O.nodes),H=o.ySubDoc.getMap("nodes"),f=o.ySubDoc.getMap("links");for(let b=0;b<M.length;b++)M[b][1].created||(M[b][1].created=new Date),M[b][1].updated||(M[b][1].updated=new Date),H.set(M[b][0],M[b][1]);for(let b=0;b<F.length;b++)f.set(F[b][0],F[b][1]);for(let b=0;b<O.documents.length;b++)o.ySubDoc.getXmlFragment()}}},W=E=>{let O="";if(Array.isArray(E))for(let F=0;F<E.length;F++)O+=E[F].text;else O=E;return O};return Fe(()=>{y.value=o.ySubDoc.getMap("nodes").toJSON()}),(E,O)=>{const F=Ke("router-link");return $(),ne(t(Pe),{show:t(d).isSearchOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(i)},{default:N(()=>[a("div",Fn,[a("div",zn,[_(t(ue),{as:"template",enter:"duration-20 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-20 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0"})]),_:1}),Wn,_(t(ue),{as:"template",enter:"ease-out duration-20","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-20","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:bg-lityblack mt-16 pb-3 rounded-lg text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-4xl w-full",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(d).blurredInterface}])},[a("div",jn,[(e.subStates.hocuspocus.awareness&&e.subStates.hocuspocus.awareness.length>1,K("",!0)),($(),T("span",Vn,[a("form",{class:"w-full",onSubmit:O[2]||(O[2]=be(()=>{},["prevent"]))},[ze(a("input",{id:"search",onKeydown:[De(be(p,["prevent"]),["up"]),De(be(S,["prevent"]),["down"]),De(be(C,["prevent"]),["right"]),De(be(j,["prevent"]),["enter"])],"onUpdate:modelValue":O[0]||(O[0]=M=>c.value=M),placeholder:"Search for Nodes",autocomplete:"off",autocapitalize:"off",spellcheck:"false",autofocus:"",type:"text",name:"search",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg pr-12"},null,40,Gn),[[We,c.value]]),a("div",Kn,[a("button",{type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 hover:opacity-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-600",onClick:O[1]||(O[1]=(...M)=>t(i)&&t(i)(...M))},qn)])],32)])),K("",!0)]),($(),T("div",Zn,[a("ul",Xn,[($(!0),T(me,null,Re(t(I),(M,H)=>($(),T("li",{key:M},[M[1]&&M[1].title?($(),ne(F,{key:0,"active-class":"bg-gray-200 dark:bg-gray-800",class:L(["mb-1 mt-0.5 m-3 block rounded-md mb-0.5 bg-white text-black dark:text-white dark:bg-gray-900 bg-opacity-50 dark:bg-opacity-50 hover:bg-gray-100 dark:hover:bg-gray-800 overflow-x-scroll",{"bg-blue-100 hover:text-black ring-2 ring-blue-600 dark:hover:text-white hover:bg-blue-200 dark:bg-blue-700 dark:hover:bg-blue-800":H===g.value}]),onClick:f=>D(M,H),to:"/"+t(s).params.space+"/"+t(s).params.document+"/"+M[0]},{default:N(()=>[a("div",Yn,[a("div",Qn,[a("div",ea,[a("p",ta,se(W(M[1].title)),1)]),oa,a("div",sa,[a("p",na,[aa,he(" "+se(M[1].links.length),1)]),a("p",ra,[ia,_(t(tt),{time:M[1].created},{default:N(({timeAgo:f})=>[he(se(f),1)]),_:2},1032,["time"])]),a("p",la,[ca,_(t(tt),{time:M[1].updated},{default:N(({timeAgo:f})=>[he(se(f),1)]),_:2},1032,["time"])])])])])]),_:2},1032,["class","onClick","to"])):K("",!0)]))),128))])]))],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])}}}),Je=gt(),B=Be({autoLink:!1,linkingNodes:!1,unlinkingNodes:!1,deletingNodes:!1,firstNode:void 0,secondNode:void 0,jsonDocuments:[]}),{osKey:ua}=ye(),{state:qe,logger:pa}=ae(),fa=(e,o,s,r,d,i)=>{const y="graph";let c;const u=de(),I=ge(),g=oe(()=>u.params.node);oe(()=>u.params.space);const p=Uo(),S=e.getMap("nodes"),C=e.getMap("links");e.getMap("selected");const j=new Wt(S),D=new Wt(C),R=oe(()=>r.hocuspocus.awareness),W=oe(()=>r.rtc.awareness),E=X(),O={background:"rgba(255,255,255,0)",fontSize:16,lineColor:"#a7bac4",lineWidth:1,particleWidth:1.5,highlightedForeground:qe.value.localUserColor||"#009dff",node:{note:"#00192a",placeholder:"#414141"}},F=jt().domain([0,30]).range([.5,2]).clamp(!0),M=jt().domain([1.2,2]).range([0,1]).clamp(!0),H={background:O.background,fontSize:parseInt(O.fontSize)-2,lineColor:O.lineColor,lineWidth:parseFloat(O.lineWidth),particleWidth:parseFloat(O.particleWidth),highlightedForeground:O.highlightedForeground,node:{note:O.node.note,placeholder:O.node.placeholder}},f={background:"rgba(0,0,0,0)",fontSize:16,lineColor:"#656565",lineWidth:1,particleWidth:1.5,highlightedForeground:qe.value.localUserColor||"#009dff",node:{note:"#eaeaea",placeholder:"#a1a1a1"}},b={selectedNodes:new Set,hoverNode:null,focusNodes:new Set,focusLinks:new Set,hoverNodes:new Set,hoverLinks:new Set,nodeInfo:{},data:{nodes:[],links:[]},style:H},m=n=>{n(b);const l=new Set,h=new Set,k=new Set,w=new Set;if(b.hoverNode){k.add(b.hoverNode);const x=b.nodeInfo[b.hoverNode];x!==void 0&&(x.neighbors.forEach(ee=>l.add(ee)),x.links.forEach(ee=>h.add(ee)))}b.selectedNodes&&b.selectedNodes.forEach(x=>{l.add(x);const ee=b.nodeInfo[x];ee!==void 0&&(ee.neighbors.forEach(Q=>l.add(Q)),ee.links.forEach(Q=>h.add(Q)))}),b.focusNodes=l,b.focusLinks=h,b.hoverNodes=k,b.hoverLinks=w},v={refresh:n=>m(l=>{l.nodeInfo=n.nodes;const h=n.links,k=new Set(Object.keys(l.nodeInfo)),w=new Set;l.data.nodes.forEach((x,ee)=>{k.has(x.id)?k.delete(x.id):w.add(ee)}),w.forEach(x=>{l.data.nodes.splice(x,1)}),k.forEach(x=>{S.get(x)&&l.data.nodes.push({id:x,y:S.get(x).y,x:S.get(x).x})}),l.data.links=h,l.hoverNode=l.nodeInfo[l.hoverNode]!=null?l.hoverNode:null,l.selectedNodes=new Set(Array.from(l.selectedNodes).filter(x=>l.nodeInfo[x]!=null)),p.graphData(l.data)}),selectNode:(n,l)=>m(h=>{if(l||h.selectedNodes.clear(),n!=null){h.selectedNodes.add(n);const k=p.graphData().nodes;for(const[w,x]of Object.entries(k))if(x.id===n){p.centerAt(x.x,x.y,300),p.zoom(7,300);break}}}),highlightNode:n=>m(l=>{l.hoverNode=n}),updateStyle:n=>{!n||(b.style=At(Ce(Ce({},H),n),{lineColor:n.lineColor||n.node&&n.node.note||H.lineColor,node:Ce(Ce({},H.node),n.node)}),p.backgroundColor(b.style.background))}},A=(n,l=!0)=>(Object.values(n.nodes).forEach(h=>{h.neighbors=[],h.links=[]}),l||n.links.forEach(h=>{try{const k=n.nodes[h.source||h.source.id],w=n.nodes[h.target||h.target.id];k&&w&&(k.neighbors.push(w.id),w.neighbors.push(k.id),k.links.push(h),w.links.push(h))}catch(k){console.log(k)}}),n);function G(){const n=[],l=[];C.forEach((h,k,w)=>{l.push(h)});for(let h=0;h<l.length;h++)l[h].source&&l[h].source.id?S.get(l[h].source.id)&&S.get(l[h].target.id)&&n.push({source:l[h].source.id,target:l[h].target.id,value:0}):S.get(l[h].source)&&S.get(l[h].target)&&n.push({source:l[h].source,target:l[h].target,value:0});return n}const U=(n=!1)=>{const l=G();S.get("index")||(S.set("index",{id:"index",group:1,title:"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]}),v.selectNode("index"));const h=S.toJSON();function k(ee,Q){let te={};const ie=ee.getMap().get(Q);ie&&(te=ie);const q=Object.entries(h).length;te.count!==q&&(te.count=q),te.updatedAt=new Date().toISOString(),te.guid||(te.guid=Q),te.filled=!0,te.createdAt||(te.createdAt=new Date().toISOString()),te.count.toString()!==q.toString()&&ee.getMap().set(Q,te)}k(i,u.params.document);const x=A({nodes:h,links:l},n);v.refresh(x),p.d3ReheatSimulation()},V=()=>{p.zoom(p.zoom()+1,300)},z=()=>{p.zoom(p.zoom()-1,300)},Z=()=>{p.d3Force("center",je(0,0)),p.d3Force("x",Vt(0).strength(.1)),p.d3Force("y",Gt(0).strength(.1)),Xe()},re=()=>{p.d3Force("center",je(0,0)),p.d3Force("x",Vt(0).strength(.01)),p.d3Force("y",Gt(0).strength(.01)),Xe()},pe=n=>{const l=Object.values(S.toJSON()),h=[];for(let k=0;k<l.length;k++)n.toLowerCase()===getPlainText(l[k].title).toLowerCase()&&h.push(l[k].id);return[]},ke=n=>{const l=pe(n);return l.length>=1?l[0]:!1},$e=n=>!!S.get(n).getJSON(),Y=(n,l,h)=>(S.set(n,{id:n,group:1,title:""+l+"",neighbors:[],links:[]}),n),J=(n,l)=>(C.set(n+"_"+l,{source:n,target:l,value:0}),n+"_"+l),fe=(n,l)=>{const k=Math.floor(new Date().getTime()+Math.random()).toString();return Y(k,n,l)},Ge=(n,l,h)=>{const w=Math.floor(new Date().getTime()+Math.random()).toString(),x=Y(w,l,h);return J(n,w),x},Ee=(n,l)=>{B.linkingNodes&&(B.linkingNodes=!1),B.deletingNodes&&(B.deletingNodes=!1),B.unlinkingNodes&&(B.unlinkingNodes=!1);const h=Math.floor(new Date().getTime()+Math.random());let k;if(l){const te=g.value||null,ie=l.id?l.id.toString():te,q=h.toString();k=q,ie?(S.set(q,{id:q,group:1,created:new Date().toISOString(),updated:new Date().toISOString(),title:""+q+"",neighbors:[ie],links:[ie]}),C.set(ie+"_"+q,{source:ie,target:q,value:0})):S.set(q,{id:q,group:1,title:""+q+"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]})}else k=h,S.set(h.toString(),{id:h.toString(),group:1,title:""+h.toString()+"",created:new Date().toISOString(),updated:new Date().toISOString(),neighbors:[],links:[]});const w=G(),x={nodes:S.toJSON(),links:w},ee=S.get(k),Q=A(x,!1);v.refresh(Q),v.selectNode(k),p.centerAt(ee.x,ee.y,300),I.push({path:`/${u.params.space}/${u.params.document}/${k}`})},Ze=()=>{p(c).cooldownTicks(50).graphData(b.data).backgroundColor(b.style.background).linkHoverPrecision(8).d3Force("collide",Eo(p.nodeRelSize())).linkWidth(()=>b.style.lineWidth||O.lineWidth).linkDirectionalParticles(1).linkDirectionalParticleWidth(n=>it(n,b)==="highlighted"?b.style.particleWidth||O.particleWidth:0).nodeCanvasObject((n,l,h)=>{const k=b.nodeInfo[n.id];if(k==null){console.error(`Could not find info for node ${n.id} - skipping`);return}const w=F(k.neighbors.length),{fill:x,border:ee}=xt(n.id,b),Q=b.style.fontSize/h*1.1,te=rt(n.id,b),ie=x.copy({opacity:te==="regular"?M(h):te==="highlighted"?1:Math.min(M(h),x.opacity)}),q=ee.copy({opacity:te==="regular"?M(h):te==="highlighted"?1:Math.min(M(h),x.opacity)}),xe=(Ne=>{let He="";const ro=[];if(Array.isArray(Ne))for(let ft=0;ft<Ne.length;ft++)He+=Ne[ft].text;else He=Ne;return{text:He,marks:ro}})(k.title).text,no=JSON.stringify(k.title).toString(),Ct=/(\u00a9|\u00ae|[\u2000-\u3300]|\ud83c[\ud000-\udfff]|\ud83d[\ud000-\udfff]|\ud83e[\ud000-\udfff])/gi,ut=xe.match(Ct);xe.replace(Ct,"");const ao=n.id.startsWith("http"),pt=no.includes("highlight");function Ie(Ne,He){return Ne.length>He?Ne.substr(0,He-1)+"...":Ne}Oe(ie).copy({opacity:.3});const Dt=te==="lessened";ut&&!pt?Me(l).circle(n.x,n.y,w+.5,q).circle(n.x,n.y,w,ie).text(Ie(xe,48),n.x,n.y+w+1,Q,q):pt&&!ut?Me(l).circle(n.x,n.y,w+.5,q).circle(n.x,n.y,w,ie).highlighted(Ie(xe,48),n.x,n.y+w+1,Q,q,Dt).text(Ie(xe,48),n.x,n.y+w+1,Q,q):pt&&ut?Me(l).highlighted(Ie(xe,48),n.x,n.y+w,Q,q,Dt).text(Ie(xe,48),n.x,n.y-w+1,Q,q):ao?Me(l).circle(n.x,n.y,w,q).text(Ie(xe,48),n.x,n.y+w+1,Q,q):Me(l).circle(n.x,n.y,w+.5,q).circle(n.x,n.y,w,ie).text(Ie(xe,48),n.x,n.y+w+1,Q,q)}).linkColor(n=>wt(n,b)).nodePointerAreaPaint((n,l,h)=>{const k=6;h.beginPath(),h.arc(n.x,n.y,k,0,2*Math.PI,!1),h.fillStyle=l,h.fill(),h.closePath()}).onNodeHover(n=>{o("onNodeHover",n),v.highlightNode(n==null?void 0:n.id)}).onNodeClick((n,l)=>{if(o("onNodeClick",n),B.unlinkingNodes){lt(n.id);return}if(B.deletingNodes){ct(n.id);return}if(ua(l)){const h=S.get(n.id);h.href&&open(h.href)}else n.fx=n.x,n.fy=n.y,B.linkingNodes&&(B.firstNode&&B.firstNode.length>3?St(B.firstNode,n.id):B.firstNode=n.id),p.centerAt(n.x,n.y,300),v.selectNode(n.id,!1),I.push({path:`/${u.params.space}/${u.params.document}/${n.id}`})}).onLinkRightClick((n,l)=>{o("onLinkRightClick")}).onZoom((n,l)=>{o("onZoom")}).onZoomEnd((n,l)=>{o("onZoomEnd")}).onLinkHover((n,l)=>{o("onLinkHover")}).onLinkClick((n,l)=>{o("onLinkClick")}).onLinkRightClick((n,l)=>{o("onLinkRightClick")}).onEngineTick((n,l)=>{o("onEngineTick")}).onEngineStop((n,l)=>{o("onEngineStop")}).onBackgroundClick(()=>{o("onBackgroundClick"),v.selectNode(void 0,!1),I.push({path:`/${u.params.space}/${u.params.document}`})}).onBackgroundRightClick(n=>{o("onBackgroundRightClick",n),p.screen2GraphCoords(n.x,n.y),Ee()}).onNodeRightClick(n=>{o("onNodeRightClick",n),Ee(!1,n)}).onNodeDrag(n=>{o("onNodeDrag",n)}).onNodeDragEnd(n=>{o("onNodeDragEnd",n),n.fx&&n.fy?(n.fx=void 0,n.fy=void 0):(n.fx=n.x,n.fy=n.y)})},kt=n=>{const l=[],h=r.hocuspocus.awareness.length>1?Object.values(r.hocuspocus.awareness):r.rtc.awareness.length>1?Object.values(r.rtc.awareness):[];if(h)for(let k=0;k<h.length;k++){const w=h[k].user;w&&w.latestDocument&&w.latestNode&&w.latestNode===n&&l.push(w)}return l};function xt(n,l){var Q,te,ie,q;const h=l.nodeInfo[n],k=l.style,w=Oe((te=k.node[(Q=h.type)!=null?Q:"note"])!=null?te:k.node.note);let x=Oe((q=k.node[(ie=h.type)!=null?ie:"note"])!=null?q:k.node.note);const ee=qe.value.showOtherColors?kt(n):[];switch(ee.length>=1&&(x=Oe(ee[0].color)),n===g.value&&(x=Oe(qe.value.localUserColor)),rt(n,l)){case"regular":return{fill:w,text:w,border:x};case"lessened":const Nt=Oe(w).copy({opacity:.3}),dt=Oe(x).copy({opacity:.3});return{fill:Nt,text:dt,border:dt};case"focused":return{fill:Oe(k.highlightedForeground),text:w,border:x};case"highlighted":return{fill:w,text:w,border:x};default:throw new Error("Unknown type for node",n)}}function wt(n,l){const h=l.style;switch(it(n,l)){case"regular":return h.lineColor;case"highlighted":return h.highlightedForeground;case"focused":return h.highlightedForeground;case"lessened":return Mo(h.lineColor).copy({opacity:.5});default:throw new Error("Unknown type for link",n)}}function rt(n,l){return l.selectedNodes.has(n)?"highlighted":l.hoverNode===n?"focused":l.focusNodes.size===0||l.focusNodes.has(n)?"regular":"lessened"}function it(n,l){return l.focusNodes.size===0?"regular":l.focusLinks.has(n)?"highlighted":"lessened"}const Me=n=>({circle:function(l,h,k,w){return n.beginPath(),n.arc(l,h,k,0,2*Math.PI,!1),n.fillStyle=w,n.fill(),n.closePath(),this},ring:function(l,h,k,w){return n.beginPath(),n.arc(l,h,k*2,0,2*Math.PI,!1),n.fillStyle=w,n.fill(),n.closePath(),this},text:function(l,h,k,w,x){return n.font=`${w}px Sans-Serif`,n.textAlign="center",n.textBaseline="top",n.fillStyle=x,n.fillText(l,h,k),this},emoji:function(l,h,k,w,x){return n.font=`${w}px Sans-Serif`,n.textAlign="center",n.globalAlpha=.7,n.fillStyle=x,n.fillText(l,h,k),this},highlighted:function(l,h,k,w,x,ee){n.font=`${w}px Sans-Serif`,n.fillStyle="rgba(255,251,0,0.7)",ee&&(n.fillStyle="rgba(255,251,0,0.2)");const Q=n.measureText(l).width;return n.fillRect(h-Q/2,k,Q,parseInt(n.font,0)*1.1),this}}),_t=()=>{I.push(`/${u.params.space}/${u.params.document}/`)},eo=()=>{B.deletingNodes&&(B.deletingNodes=!1),B.unlinkingNodes&&(B.unlinkingNodes=!1),g.value&&g.value.length>3&&(B.firstNode=g.value),B.linkingNodes=!B.linkingNodes,B.linkingNodes||(B.firstNode=null)},to=()=>{B.deletingNodes&&(B.deletingNodes=!1),B.linkingNodes&&(B.linkingNodes=!1),g.value&&g.value.length>3?lt(g.value):B.unlinkingNodes=!B.unlinkingNodes},oo=()=>{B.linkingNodes&&(B.linkingNodes=!1),B.unlinkingNodes&&(B.unlinkingNodes=!1),g.value&&g.value.length>3?ct(g.value):B.deletingNodes=!B.deletingNodes},St=(n,l)=>{n&&l&&(B.firstNode=void 0,B.secondNode=void 0,C.set(n+"_"+l,{source:n,target:l,value:0})),B.linkingNodes=!1},lt=n=>{n&&(S.forEach((l,h)=>{const k=l.neighbors,w=l.links;for(let x=0;x<k.length;x++)k[x]===n&&k.splice(x,1);for(let x=0;x<w.length;x++)(w[x].source==n||w[x].source.id==n||w[x].target==n||w[x].target.id==n)&&w.splice(x,1)}),C.forEach((l,h)=>{(l.target==n||l.source==n)&&(C.delete(h,1),U(!0))}),U(!1))},ct=n=>{n&&n!="index"?(S.delete(n.toString()),S.forEach((l,h)=>{const k=l.neighbors,w=l.links;for(let x=0;x<k.length;x++)k[x]===n&&k.splice(x,1);for(let x=0;x<w.length;x++)(w[x].source==n||w[x].source.id==n||w[x].target==n||w[x].target.id==n)&&w.splice(x,1)}),U(!1),_t()):o("deleteIndex")},$t=()=>{p.graphData().nodes.forEach((n,l,h)=>{n.fx&&n.fy&&(n.fx=void 0,n.fy=void 0)}),U(!1)};function so(){if(p.d3Force("center",je(0,0)),p.zoomToFit(300,20),g.value){const n=p.graphData().nodes;for(const[l,h]of Object.entries(n))if(h.id===g.value){p.d3Force("center",je(0,0)),p.centerAt(h.x,h.y,300);break}v.selectNode(g.value,!1)}}const Xe=()=>{p&&p._destructor(),Ze(),$t(),U(),E.value=Object.entries(S.toJSON()),p.width(window.innerWidth),p.height(window.innerHeight);const n=X(!0);p.onEngineStop(()=>{const l=p.graphData().nodes;if(n.value)if(l.length>1){if(p.d3Force("center",je(0,0)),p.zoomToFit(50,20),n.value=!1,g.value){for(const[h,k]of Object.entries(l))if(k.id===g.value){p.d3Force("center",je(0,0)),p.centerAt(k.x,k.y,50);break}v.selectNode(g.value,!1)}}else p.zoomToFit(50,0);p.cooldownTicks(20)}),window.addEventListener("resize",()=>{p.width(window.innerWidth),p.height(window.innerHeight)}),window.addEventListener("orientationchange",function(){p.width(window.innerWidth),p.height(window.innerHeight)})};return Fe(()=>{if(c=document.getElementById(y),c!==void 0){S.observe(()=>{U(),E.value=Object.entries(S.toJSON())}),C.observe(()=>{U()}),ce(g,(l,h)=>{B.autoLink&&C.set(l+"_"+h,{source:l,target:h,value:0})}),ce(R,()=>{U()}),ce(W,()=>{U()}),ce(Je,()=>{Je.value&&v.updateStyle(f),Je.value||v.updateStyle(H)});const n=oe(()=>qe.value.useStrongGravity);ce(n,()=>{n.value?Z():re()}),pa(Je.value),Xe(),Je.value?v.updateStyle(f):v.updateStyle(H),n.value?Z():re()}}),Ae(()=>{p._destructor()}),ce(g,()=>{g.value?(v.selectNode(g.value,!1),o("show")):(v.selectNode(void 0,!1),o("hide"))}),{galaxyState:B,Actions:v,graph:p,update:m,augmentGraphInfo:A,updateLinks:G,updateAll:U,zoomIn:V,zoomOut:z,gravityOn:Z,gravityOff:re,nodesWithTitle:pe,hasNodesWithTitle:ke,doesNodeExist:$e,createNodeOrUpdate:Y,directLinkNodes:J,createRootNode:fe,createChildNode:Ge,doAction:Ee,initDataviz:Ze,isWithUser:kt,getNodeColor:xt,getLinkColor:wt,getNodeState:rt,getLinkState:it,Draw:Me,unsetID:_t,linkNodes:eo,unlinkNodes2:to,deleteNodes2:oo,linkNodesPermanent:St,unLinkNodes:lt,deleteNode:ct,unfixAll:$t,Escape:so,reRenderGraph:Xe,jsonDocuments:E,yUndoManagerNodes:j,yUndoManagerLinks:D}},ga=le({props:{yRootDoc:null,ySubDoc:null,ySubDocIndexedDb:null,ySubDocs:null,jSubDocs:null,spaceId:null,docId:null,nodeId:null,hocuspocusProvider:null,webRtcProvider:null,subStates:null,rootStates:null,paneVisible:null},emits:["onBackgroundClick","onBackgroundRightClick","onNodeHover","onNodeClick","onNodeRightClick","onNodeDrag","onNodeDragEnd","onLinkRightClick","onZoom","onZoomEnd","onLinkHover","onLinkClick","onLinkRightClick","onEngineTick","onEngineStop","deleteIndex","hide","show"],setup(e,{emit:o}){const s=e,r=gt(),{state:d}=ae(),{osKey:i}=ye(),{galaxyState:y,graph:c,computedNodeId:u,gravityOn:I,gravityOff:g,reRenderGraph:p,Escape:S,deleteNodes2:C,unLinkNodes:j,unlinkNodes2:D,doAction:R,linkNodes:W,jsonDocuments:E,zoomIn:O,zoomOut:F,deleteNode:M,yUndoManagerNodes:H,yUndoManagerLinks:f}=fa(s.ySubDoc,o,s.docId,s.rootStates,s.hocuspocusProvider,s.yRootDoc);window.rpc&&window.rpc.notify&&ht.listen("tauri://menu",({event:m,payload:v})=>{switch(v){case"Center-Gravity":I();break;case"No-Gravity":g();break;case"Unfix-Gravity":p();break;case"Previous Node":break;case"Next Node":break;case"Exit Node":S();break;case"Delete Node":C();break;case"Cut Node-Links":D();break;case"New Root-Node":R(!1,!1);break;case"New Child-Node":R(!1,{id:s.nodeId});break;case"Link Nodes":W();break}});const b=m=>{m.key==="Escape"&&(m.preventDefault(),S()),m.key==="k"&&i(m)&&(m.preventDefault(),R(!1,{id:s.nodeId})),m.key==="o"&&i(m)&&m.preventDefault(),m.key==="j"&&i(m)&&(m.preventDefault(),R(!1,!0)),m.key==="l"&&i(m)&&(m.preventDefault(),j(s.nodeId)),m.key==="+"&&i(m)&&(m.preventDefault(),O()),m.key==="."&&i(m)&&(m.preventDefault(),d.value.useStrongGravity=!d.value.useStrongGravity),m.key==="-"&&i(m)&&(m.preventDefault(),F()),m.key==="Backspace"&&i(m)&&(m.preventDefault(),M(s.nodeId))};return Fe(()=>{document.addEventListener("keydown",b)}),Ae(()=>{document.removeEventListener("keydown",b)}),(m,v)=>($(),T(me,null,[_(da,{"y-sub-doc":e.ySubDoc,"sub-states":e.subStates,"j-sub-docs":e.jSubDocs,"hocuspocus-provider":e.hocuspocusProvider,"web-rtc-provider":e.webRtcProvider},null,8,["y-sub-doc","sub-states","j-sub-docs","hocuspocus-provider","web-rtc-provider"]),_(Un,{"linking-nodes":t(y).linkingNodes,"unlinking-nodes":t(y).unlinkingNodes,"deleting-nodes":t(y).deletingNodes,onRefreshGraph:v[0]||(v[0]=A=>t(p)()),onUndo:v[1]||(v[1]=A=>{t(H).undo(),t(f).undo()}),onRedo:v[2]||(v[2]=A=>{t(H).redo(),t(f).redo()}),onLinkNodes:t(W),onUnlinkNodes:t(D),onCreateNode:v[3]||(v[3]=A=>e.nodeId?t(R)(!1,{id:e.nodeId}):t(R)(!1,!0)),onDeleteNode:t(C)},null,8,["linking-nodes","unlinking-nodes","deleting-nodes","onLinkNodes","onUnlinkNodes","onDeleteNode"]),a("div",{id:"graph",class:L([{"dark-bg":t(r)},"select-none fixed top-0 left-0 right-0 bottom-0"])},null,2)],64))}}),ha=e=>{const{isMobile:o,hasNotch:s}=ye(),r=ge(),d=de();let i;const y=oe(()=>d.params.document),c=oe(()=>d.params.node),u=Be({paneCreated:!1,paneVisible:!1,paneState:"",backupPaneState:""}),I=()=>{o()&&(i.currentBreak()==="top"||i.moveToBreak("middle"))},g=()=>{u.paneVisible=!0,i.present()},p=()=>{i.hide()},S=F=>{c.value&&i.moveToBreak(F)},C=()=>{i.currentBreak()==="top"?(S("bottom"),u.paneState="bottom"):i.currentBreak()==="middle"?(S("top"),u.paneState="top"):i.currentBreak()==="bottom"&&(S("middle"),u.paneState="middle")},j=()=>{i.isPanePresented()&&!i.isHidden()&&(u.paneVisible=!1,i.hide())},D=()=>{r.push(`/${d.params.space}/${d.params.document}/`)},R=()=>{r.forward()},W=()=>{r.back()},E=()=>{i=new Ho(".editor-pane",{breaks:{top:{enabled:!0,height:window.innerHeight-(s()&&o()?110:50),bounce:!1},middle:{enabled:!0,height:300,bounce:!1},bottom:{enabled:!0,height:100,bounce:!1}},buttonClose:!1,showDraggable:o(),draggableOver:o(),initialBreak:"bottom",dragBy:[".pane .draggable"],clickBottomOpen:!1,fastSwipeClose:!1,fitHeight:!1,fitScreenHeight:!1,bottomOffset:-10,onDidDismiss:()=>{e.value&&y.value&&r.push(`/${e.value}/${y.value}/`),u.paneVisible=!1},onWillPresent:()=>{u.paneVisible=!0},onTransitionEnd:()=>{var F;u.paneState=i.currentBreak()?(F=i.currentBreak())==null?void 0:F.toString():"",i.isPanePresented()?c.value||i.hide():i.present()}}),u.paneCreated=!0,i.isPanePresented()?c.value||i.hide():i.present(),u.backupPaneState&&i.moveToBreak(u.backupPaneState)},O=()=>{var F;u.paneCreated=!1,u.backupPaneState=(F=i.currentBreak())==null?void 0:F.toString(),i.destroy()};return Fe(()=>{E()}),Ae(()=>{O(),u.paneCreated=!1}),{editorPaneState:u,editorPane:i,moveToFocus:I,showPane:g,hidePane:j,moveTo:S,switchPane:C,hide:p,unsetId:D,goForward:R,goBack:W,destroyPane:O,createPane:E}},{state:il,logger:ma}=ae(),ba=(e,o,s)=>{const r=Be({hasLoadedSubDoc:!1});ge();const d=de(),i=oe(()=>d.params.node),y=e.getMap();let c;const u=()=>{y.delete(c.guid);const C=c.getMap("nodes"),j=c.getMap("links"),D=C.toJSON(),R=Object.entries(D),W=j.toJSON(),E=Object.entries(W);for(let O=0;O<R.length;O++){const F=c.getXmlFragment(R[O][0]);F.delete(0,F.length),C.delete(R[O][0])}for(let O=0;O<E.length;O++)j.delete(E[O][0])},I=C=>{const j=y.get(C);j?(j.updatedAt=new Date().toString(),y.set(C,j)):y.set(C,{guid:C,title:"Index",createdAt:new Date().toString(),updatedAt:new Date().toString()})};s&&s.length>=1?c=new Ye({guid:s,autoLoad:!0}):c=new Ye({autoLoad:!0});const g=c.getMap("nodes"),p=X(),S=new Lt(c.guid,c);return S.once("synced",()=>{r.hasLoadedSubDoc=!0,(!s||!i.value)&&I(c.guid),ma("useSubDoc: ySubDocIndexedDb -> synced"),p.value=Object.entries(g.toJSON()),g.observe(()=>{p.value=Object.entries(g.toJSON())})}),{subDocState:r,ySubDoc:c,ySubDocIndexedDb:S,ySubDocs:g,jSubDocs:p,deleteSubDoc:u}},ya={class:"cupertino-pane editor-pane select-none"},va=le({props:{yRootDoc:null,yRootDocIndexedDb:null,yRootDocs:null,jRootDocs:null,spaceId:null,spaceUrl:null,spaceToken:null,docId:null,nodeId:null,hocuspocusProvider:null,webRtcProvider:null,rootStates:null},setup(e){const o=e,s=ge();de();const{state:r,logger:d,toggleSearch:i,checkForOpenWindows:y,toggleOnly:c}=ae(),{osKey:u}=ye(),I=X(),g=X(),{editorPaneState:p,editorPane:S,destroyPane:C,moveToFocus:j,showPane:D,hidePane:R,moveTo:W,switchPane:E,unsetId:O,goForward:F,goBack:M,createPane:H}=ha(o.spaceId),{subDocState:f,ySubDoc:b,ySubDocIndexedDb:m,ySubDocs:v,jSubDocs:A,deleteSubDoc:G}=ba(o.yRootDoc,o.spaceId,o.docId?o.docId:null),{subStates:U,provideAwareness:V,provideSubHocuspocus:z,provideSubWebRtc:Z}=Qt();V(b);const re=oe(()=>o.nodeId);oe(()=>o.docId);const pe=oe(()=>r.value.useWebRtc),ke=oe(()=>r.value.useHocuspocus);X(!1),pe.value&&!g.value&&(g.value=Z()),ke.value&&!I.value&&(I.value=z(o.spaceUrl,o.spaceToken)),window.rpc&&window.rpc.notify&&ht.listen("tauri://menu",({event:Y,payload:J})=>{switch(J){case"Open Search":i();break;case"Toggle Editor Breaks":E();break}});const $e=Y=>{if(Y.key==="Escape"&&(Y.preventDefault(),s.push(`/${o.spaceId}/${o.docId}`)),Y.key==="Tab"&&Y.shiftKey&&!Y.altKey&&(Y.preventDefault(),E()),Y.key==="f"&&u(Y)&&(Y.preventDefault(),c("search")),Y.key==="Backspace"&&Y.shiftKey&&u(Y)&&(Y.preventDefault(),G(o.docId)),Y.key==="p"&&u(Y)){Y.preventDefault();const J={nodes:[],links:[],documents:[]};J.nodes=b.getMap("nodes").toJSON(),J.links=b.getMap("links").toJSON();const fe=Object.entries(J.nodes);for(let Ge=0;Ge<fe.length;Ge++){const Ee=fe[Ge][1],Ze=b.getXmlFragment(Ee.id);J.documents.push([Ee.id,JSON.stringify(Ze)])}}};return ce(re,()=>{re.value&&re.value.length>=3?D():R()}),ce(pe,()=>{pe.value?g.value=Z():g.value&&g.value.destroy()}),ce(ke,()=>{ke.value?I.value=z(o.spaceUrl,o.spaceToken):I.value&&I.value.destroy()}),Fe(()=>{document.addEventListener("keydown",$e),r.value.blurredInterface=!r.value.blurredInterface,r.value.blurredInterface=!r.value.blurredInterface;let Y;window.addEventListener("resize",()=>{p.paneCreated&&C(),clearTimeout(Y),Y=setTimeout(()=>{H()},200)})}),Ae(()=>{g.value&&g.value.destroy(),I.value&&I.value.destroy(),document.removeEventListener("keydown",$e)}),(Y,J)=>($(),T("div",{class:L(["overflow-hidden",{blur:t(r)?t(r).blurredInterface:!0}])},[a("div",ya,[t(f).hasLoadedSubDoc&&e.nodeId&&t(p).paneCreated?($(),ne(rn,{key:e.spaceId+e.docId+e.nodeId,"y-root-doc":e.yRootDoc,"y-root-docs":e.yRootDocs,"j-root-docs":e.jRootDocs,"y-sub-doc":t(b),"y-sub-doc-indexed-db":t(m),"y-sub-docs":t(v),"j-sub-docs":t(A),"space-id":e.spaceId,"doc-id":e.docId,"node-id":e.nodeId,"hocuspocus-provider":I.value,"web-rtc-provider":g.value,"sub-states":t(U),"pane-visible":t(p).paneVisible,"pane-state":t(p).paneState,onOnFocus:J[0]||(J[0]=fe=>t(j)()),onBottom:J[1]||(J[1]=fe=>t(W)("bottom")),onMiddle:J[2]||(J[2]=fe=>t(W)("middle")),onTop:J[3]||(J[3]=fe=>t(W)("top")),onHide:J[4]||(J[4]=fe=>t(O)()),onBack:J[5]||(J[5]=fe=>t(M)()),onForward:J[6]||(J[6]=fe=>t(F)()),onSwitch:J[7]||(J[7]=fe=>t(E)())},null,8,["y-root-doc","y-root-docs","j-root-docs","y-sub-doc","y-sub-doc-indexed-db","y-sub-docs","j-sub-docs","space-id","doc-id","node-id","hocuspocus-provider","web-rtc-provider","sub-states","pane-visible","pane-state"])):K("",!0)]),t(f).hasLoadedSubDoc&&e.docId&&t(p).paneCreated?($(),ne(ga,{key:e.spaceId+e.docId,"y-root-doc":e.yRootDoc,"y-sub-doc":t(b),"y-sub-doc-indexed-db":t(m),"y-sub-docs":t(v),"j-sub-docs":t(A),"space-id":e.spaceId,"doc-id":e.docId,"node-id":e.nodeId,"hocuspocus-provider":I.value,"web-rtc-provider":g.value,"sub-states":t(U),"root-states":e.rootStates,"pane-visible":t(p).paneVisible,onHide:t(R),onShow:t(D),onDeleteIndex:J[8]||(J[8]=fe=>{t(G)(o.docId)})},null,8,["y-root-doc","y-sub-doc","y-sub-doc-indexed-db","y-sub-docs","j-sub-docs","space-id","doc-id","node-id","hocuspocus-provider","web-rtc-provider","sub-states","root-states","pane-visible","onHide","onShow"])):K("",!0)],2))}}),ka={class:"fixed inset-0 z-50 dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 overflow-y-auto"},xa={class:"text-center"},wa=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),_a={class:"m-3"},Sa={key:0,class:"pb-4"},$a={key:1,class:"relative z-0 w-full mb-4 inline-flex justify-between"},Na=["onKeydown"],Ca={class:"absolute inset-y-0 right-0 flex py-0.5 pr-1.5"},Da=a("i",{class:"ri-question-fill text-2xl"},null,-1),Oa=[Da],Ia=a("i",{class:"ri-close-circle-fill text-2xl"},null,-1),Aa=[Ia],Ra={class:"relative z-0 w-full inline-flex"},La=a("i",{class:"ri-focus-line pr-1.5 text-2xl"},null,-1),Ta=he(" New Gravity "),Pa=[La,Ta],Ua=he(" Change Space "),Ea={class:"relative z-0 overflow-ellipsis w-full overflow-x-scroll"},Ma={role:"list"},Ha={style:{"min-width":"300px"},class:"px-2"},Ba={class:"flex justify-between"},Fa={class:"flex"},za={class:"mx-1 flex items-center text-sm w-64 font-bold"},Wa=a("div",{class:"mt-1 flex items-center text-sm sm:mt-0"},null,-1),ja={class:"mt-1 flex items-center text-sm sm:mt-0"},Va={key:0,class:"px-1 w-28 text-sm font-medium"},Ga=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"nodes ",-1),Ka={class:"w-48 text-md font-medium"},Ja=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"UPDATED ",-1),qa={class:"px-1 w-48 text-sm font-medium"},Za=a("span",{class:"uppercase font-bold text-gray-700 dark:text-gray-300 text-xs mr-2"},"CREATED ",-1),Xa=a("p",{class:"opacity-0 px-2 groups-hover:opacity-100"},[a("i",{class:"ri-delete-bin-2-fill text-lg"})],-1),Ya=le({props:{yRootDoc:null,yRootDocIndexedDb:null,jRootDocs:null,hocuspocusProvider:null,webRtcProvider:null,rootStates:null},emits:["createDocument"],setup(e,{emit:o}){const s=e,r=de(),d=ge(),{state:i,toggleSelector:y,toggleProvider:c,toggleShare:u,toggleUser:I,toggleOnly:g}=ae(),{getPlainText:p}=ye(),S=X(""),C=X(0),j=(H,f)=>{F(H,f)},D=oe(()=>s.jRootDocs?s.jRootDocs.filter(H=>H[1].title&&p(H[1].title).toLowerCase().includes(S.value.toLowerCase())).sort((H,f)=>H.updatedAt>f.updatedAt?-1:H.updatedAt<f.updatedAt?1:0).sort((H,f)=>p(H.title)>p(f.title)?1:p(f.title)>p(H.title)?-1:0):[]),R=()=>{C.value=(C.value+D.value.length-1)%D.value.length},W=()=>{C.value=(C.value+1)%D.value.length},E=()=>{S.value=p(D.value[C.value][1].title)},O=()=>{S.value.startsWith("/")?d.push(S.value):S.value.startsWith("{")?M(S.value):F(D.value[C.value][0],C.value)},F=(H,f)=>{C.value=f,y(),d.push("/"+r.params.space+"/"+H+"/index"),f>=D.value.length},M=H=>{if(H){S.value="";const f=JSON.parse(H);if(f.nodes&&f.links&&f.documents){const b=new Ye;d.push(`/${r.params.space}/${b.guid}/index`);const m=Object.entries(f.links),v=Object.entries(f.nodes),A=b.getMap("nodes"),G=b.getMap("links");for(let U=0;U<v.length;U++)A.set(v[U][0],v[U][1]);for(let U=0;U<m.length;U++)G.set(m[U][0],m[U][1]);for(let U=0;U<f.documents.length;U++);}}};return(H,f)=>{const b=Ke("router-link");return $(),ne(t(Pe),{show:t(i).isSelectorOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(y)},{default:N(()=>[a("div",ka,[a("div",xa,[_(t(ue),{as:"template",enter:"duration-20 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-20 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0 backdrop-filter backdrop-blur2"})]),_:1}),wa,_(t(ue),{as:"template",enter:"ease-out duration-20","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-20","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:bg-lityblack mt-16 p-0 rounded-lg pb-4 text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-4xl w-full",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(i).blurredInterface}])},[a("div",_a,[e.rootStates.hocuspocus.awareness&&e.rootStates.hocuspocus.awareness.length>1?($(),T("div",Sa,[($(!0),T(me,null,Re(e.rootStates.hocuspocus.awareness,m=>($(),ne(Bn,{key:m.clientId,route:t(r),state:m},null,8,["route","state"]))),128))])):K("",!0),($(),T("span",$a,[a("form",{class:"w-full",onSubmit:f[3]||(f[3]=be(()=>{},["prevent"]))},[ze(a("input",{id:"search",onKeydown:[De(be(R,["prevent"]),["up"]),De(be(W,["prevent"]),["down"]),De(be(E,["prevent"]),["right"]),De(be(O,["prevent"]),["enter"])],"onUpdate:modelValue":f[0]||(f[0]=m=>S.value=m),placeholder:"Search for Gravities",autocomplete:"off",autocapitalize:"off",spellcheck:"false",autofocus:"",tabindex:"0",type:"text",name:"search",class:"border-0 h-8 bg-white dark:bg-gray-800 dark:text-white bg-opacity-50 dark:bg-opacity-50 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-100 block w-full pl-3 py-5 pr-12 rounded-lg"},null,40,Na),[[We,S.value]]),a("div",Ca,[a("button",{type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 hover:opacity-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-600",onClick:f[1]||(f[1]=m=>t(g)("info"))},Oa),a("button",{type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 hover:opacity-50 focus:z-10 focus:outline-none focus:ring-1 focus:ring-blue-600",onClick:f[2]||(f[2]=(...m)=>t(y)&&t(y)(...m))},Aa)])],32)])),a("span",Ra,[a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:f[4]||(f[4]=m=>{o("createDocument"),t(y)()})},Pa),a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:f[5]||(f[5]=m=>{t(y)(),t(c)()})},[a("i",{class:L([{"animate animate-pulse text-green-600 dark:text-green-400":e.rootStates.hocuspocus.connected&&t(i).useHocuspocus},"ri-focus-2-line pr-1.5 text-2xl"])},null,2),Ua]),a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:f[6]||(f[6]=m=>{t(y)(),t(u)()})},[a("i",{class:L([{"animate animate-pulse text-blue-600 dark:text-blue-400":t(i).useWebRtc},"ri-broadcast-line pr-1.5 text-2xl"])},null,2),he(" "+se(t(i).useWebRtc?"Sharing":"Share")+" P2P ",1)]),a("button",{type:"button",class:"ml-1 p-1 pr-3 relative inline-flex items-center text-sm font-medium text-gray-900 dark:text-gray-100 hover:opacity-70 focus:z-10 focus:outline-none",onClick:f[7]||(f[7]=m=>{t(y)(),t(I)()})},[a("i",{class:"ri-fingerprint-line pr-1.5 text-2xl",style:et("color: "+t(i).localUserColor)},null,4),he(" "+se(t(i).localUserName),1)])])]),a("div",Ea,[a("ul",Ma,[($(!0),T(me,null,Re(t(D),(m,v)=>($(),T("li",{class:"group",key:m[1].id},[m[1]&&m[1].title?($(),ne(b,{key:0,"active-class":"bg-gray-200 dark:bg-gray-800",class:L(["mb-1 mt-1 m-3 block rounded-md bg-white text-black dark:text-white dark:bg-gray-900 bg-opacity-50 dark:bg-opacity-50 group-hover:bg-gray-100 group-hover:bg-opacity-50 dark:group-hover:bg-gray-800 overflow-x-scroll",{"bg-blue-100 group-hover:text-black ring-2 ring-blue-600 dark:group-hover:text-white hover:bg-blue-200 dark:bg-blue-700 dark:group-hover:bg-blue-800":v===C.value}]),to:"/"+t(r).params.space+"/"+m[1].id+"/index",onClick:A=>j(m[0],v)},{default:N(()=>[a("div",Ha,[a("div",Ba,[a("div",Fa,[a("p",za,se(t(p)(m[1].title)),1)]),Wa,a("div",ja,[($(),T("p",Va,[Ga,he(" "+se(m[1].count),1)])),a("p",Ka,[Ja,_(t(tt),{time:m[1].updatedAt},{default:N(({timeAgo:A})=>[he(se(A),1)]),_:2},1032,["time"])]),a("p",qa,[Za,_(t(tt),{time:m[1].createdAt},{default:N(({timeAgo:A})=>[he(se(A),1)]),_:2},1032,["time"])]),Xa])])])]),_:2},1032,["class","to","onClick"])):K("",!0)]))),128))])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"])}}});var Qa="/assets/icon.43d42a8c.png";const er={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},tr={class:"text-center"},or=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),sr={class:"grid grid-cols-2 text-black dark:text-white"},nr=a("img",{class:"mx-auto h-32 w-auto",src:Qa,alt:"lity logo"},null,-1),ar={class:"mx-auto my-auto"},rr=a("h1",{class:"mb-2 leading-1 text-2xl"},[he("Lity "),a("span",{class:"text-gray-700 dark:text-gray-300"},"Beta")],-1),ir={class:"text-gray-600 dark:text-gray-200"},lr=a("div",{class:"mx-auto my-auto"},[a("h3",{class:"leading-1 text-center text-2xl"},"Click outside the window to close it!")],-1),cr=le({setup(e){de(),ge();const{state:o,toggleInfo:s}=ae();return(r,d)=>($(),ne(t(Pe),{show:t(o).isInfoOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(s)},{default:N(()=>[a("div",er,[a("div",tr,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0"})]),_:1}),or,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(o).blurredInterface}])},[a("div",null,[a("div",sr,[nr,a("div",ar,[rr,a("span",ir,"Version "+se(t(o).version),1)])]),lr]),K("",!0)],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),dr={class:"h-full flex flex-col overflow-hidden dark:text-white text-black"},ur=le({props:{spaceId:null,spaceUrl:null,spaceToken:null},setup(e){const o=e,s=de(),{state:r,logger:d,toggleOnly:i}=ae(),{osKey:y}=ye(),{getSpace:c,setGravity:u,setIndex:I}=ot(),{rootState:g,yRootDoc:p,yRootDocs:S,yRootIndexedDb:C,jRootDocs:j,createDocument:D}=Is(o.spaceId),{rootStates:R,rootHocuspocusProvider:W,rootWebRtcProvider:E,rootAwareness:O,provideRootHocuspocus:F,provideRootWebRtc:M,destroyRootWebRtc:H,destroyRootHocuspocus:f}=Rs(p);c(o.spaceId);const b=oe(()=>r.value.useWebRtc),m=oe(()=>r.value.useHocuspocus);b.value&&M(),m.value&&F(o.spaceUrl,o.spaceToken);const v=oe(()=>s.params.document),A=oe(()=>s.params.node);ce(A,()=>{G()}),ce(v,()=>{G(),I(o.spaceId,s.params.document)});const G=()=>{O.setLocalStateField("user",{latestNode:A.value?A.value:null,latestDocument:v.value?v.value:null,latestSpace:o.spaceId||null,name:r.value.localUserName,color:r.value.localUserColor})};window.rpc&&window.rpc.notify&&ht.listen("tauri://menu",({event:V,payload:z})=>{}),ce(b,()=>{b.value?M():H()}),ce(m,()=>{m.value?F(o.spaceUrl,o.spaceToken):f()});const U=V=>{V.key==="p"&&y(V)&&(V.preventDefault(),i("selector"))};return Fe(()=>{d("AppRootDoc component initialized. Attaching event listener."),document.addEventListener("keydown",U)}),Ae(()=>{document.removeEventListener("keydown",U)}),(V,z)=>($(),T("div",dr,[_(cr),t(g).hasLoadedRootDoc?($(),ne(Ya,{key:0,"y-root-doc":t(p),"y-root-doc-indexed-db":t(C),"hocuspocus-provider":t(W),"web-rtc-provider":t(E),"root-states":t(R),"j-root-docs":t(j),onCreateDocument:t(u)},null,8,["y-root-doc","y-root-doc-indexed-db","hocuspocus-provider","web-rtc-provider","root-states","j-root-docs","onCreateDocument"])):K("",!0),t(g).hasLoadedRootDoc?($(),ne(va,{"y-root-doc":t(p),"y-root-doc-indexed-db":t(C),"y-root-docs":t(S),"j-root-docs":t(j),key:t(s).params.space+t(s).params.document,"space-id":t(s).params.space,"space-token":e.spaceToken,"space-url":e.spaceUrl,"doc-id":t(s).params.document,"node-id":t(s).params.node,"hocuspocus-provider":t(W),"web-rtc-provider":t(E),"root-states":t(R)},null,8,["y-root-doc","y-root-doc-indexed-db","y-root-docs","j-root-docs","space-id","space-token","space-url","doc-id","node-id","hocuspocus-provider","web-rtc-provider","root-states"])):K("",!0)]))}}),pr={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},fr={class:"text-center"},gr=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),hr={class:"mt-2"},mr=a("h1",{class:"text-2xl text-center"},"Settings ",-1),br={key:0,class:"mt-1"},yr=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," general ",-1),vr={class:"my-2"},kr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Reopen last document on start",-1),xr={class:"my-2"},wr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Create new document on start",-1),_r=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," visual ",-1),Sr={class:"my-2"},$r=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Enable blurred windows",-1),Nr=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," collaboration ",-1),Cr={class:"my-2"},Dr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Show other online users in selectors",-1),Or={class:"my-2"},Ir=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Dye nodes in user color",-1),Ar={class:"my-2"},Rr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Show cursors in nodes",-1),Lr=a("span",{class:"text-sm text-gray-500"},null,-1),Tr=a("div",{class:"text-xs font-sans font-bold text-gray-500 dark:text-gray-400 uppercase text-center tracking-wider"}," gravity ",-1),Pr={class:"my-2"},Ur=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Use stronger gravity forces ",-1),Er=a("span",{class:"text-sm mx-2 float-right text-gray-500"},[a("kbd",null,"\u2318"),a("kbd",null,".")],-1),Mr=le({emits:["change"],setup(e,{emit:o}){de(),ge();const{state:s,toggleInfo:r,toggleSettings:d,setDefaults:i}=ae();return X(),X(),(y,c)=>($(),ne(t(Pe),{show:t(s).isSettingsOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(d)},{default:N(()=>[a("div",pr,[a("div",fr,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0"})]),_:1}),gr,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-3 text-left overflow-hidden shadow-xl transform transition-all sm:align-middle sm:max-w-md w-full",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(s).blurredInterface}])},[a("div",null,[a("div",hr,[mr,($(),T("div",br,[yr,a("div",vr,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[kr]),_:1}),_(t(Se),{modelValue:t(s).useLatestDocument,"onUpdate:modelValue":c[0]||(c[0]=u=>t(s).useLatestDocument=u),class:L([t(s).useLatestDocument?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).useLatestDocument?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),a("div",xr,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[wr]),_:1}),_(t(Se),{modelValue:t(s).useLatestDocument,"onUpdate:modelValue":c[1]||(c[1]=u=>t(s).useLatestDocument=u),class:L([t(s).useLatestDocument?"bg-gray-200 dark:bg-gray-800":"bg-blue-600","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).useLatestDocument?"translate-x-0":"translate-x-5","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),_r,a("div",Sr,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[$r]),_:1}),_(t(Se),{modelValue:t(s).blurredInterface,"onUpdate:modelValue":c[2]||(c[2]=u=>t(s).blurredInterface=u),class:L([t(s).blurredInterface?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).blurredInterface?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),Nr,a("div",Cr,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[Dr]),_:1}),_(t(Se),{modelValue:t(s).showOtherUsers,"onUpdate:modelValue":c[3]||(c[3]=u=>t(s).showOtherUsers=u),class:L([t(s).showOtherUsers?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).showOtherUsers?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),a("div",Or,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[Ir]),_:1}),_(t(Se),{modelValue:t(s).showOtherColors,"onUpdate:modelValue":c[4]||(c[4]=u=>t(s).showOtherColors=u),class:L([t(s).showOtherColors?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).showOtherColors?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),a("div",Ar,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[Rr,Lr]),_:1}),_(t(Se),{modelValue:t(s).showOtherCursors,"onUpdate:modelValue":c[5]||(c[5]=u=>t(s).showOtherCursors=u),class:L([t(s).showOtherCursors?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).showOtherCursors?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),Tr,a("div",Pr,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[Ur]),_:1}),Er,_(t(Se),{modelValue:t(s).useStrongGravity,"onUpdate:modelValue":c[6]||(c[6]=u=>t(s).useStrongGravity=u),class:L([t(s).useStrongGravity?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).useStrongGravity?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),K("",!0),K("",!0),K("",!0),K("",!0),K("",!0),a("div",{onClick:c[12]||(c[12]=u=>{t(i)(),t(d)()}),class:"cursor-pointer text-xs font-sans font-bold m-3 text-gray-500 uppercase text-center tracking-wider"}," defaults ")]))])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),Hr={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 inset-0 z-50 overflow-y-auto"},Br={class:"text-center"},Fr=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),zr={class:""},Wr={class:"pb-2"},jr=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Synchronize with Server",-1),Vr=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"}," (when set)",-1),Gr={key:0,class:"mt-2"},Kr={class:"space-y-2"},Jr=["onClick"],qr={class:"flex dark:text-white text-black items-center"},Zr={class:"text-sm"},Xr={as:"p",class:"font-medium text-gray-900 dark:text-gray-100"},Yr={key:0,as:"div",class:"text-gray-500"},Qr={class:"sm:inline"},ei=he(" "+se(" ")+" "),ti=a("span",{class:"hidden sm:inline sm:mx-1","aria-hidden":"true"},"\xB7",-1),oi={key:1,class:""},si={class:"my-2 w-full"},ni=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Server Address",-1),ai={class:"mt-1 relative rounded-md shadow-sm"},ri=["onUpdate:modelValue"],ii={class:"my-1"},li=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Access Code",-1),ci={class:"mt-1 relative rounded-md shadow-sm"},di=["onUpdate:modelValue"],ui=a("p",null,"Leave empty if you want this space to remain offline.",-1),pi=["onClick"],fi={as:"div",class:"mt-2 flex text-sm sm:mt-0 sm:block sm:ml-4 sm:text-right"},gi={class:"font-medium text-gray-900 dark:text-gray-300"},hi=le({emits:["change"],setup(e,{emit:o}){const s=de(),r=ge(),{state:d,toggleInfo:i,toggleProvider:y,toggleSelector:c,toggleOnly:u}=ae(),{localSpaces:I,resetSpaces:g,getSpace:p}=ot();X(),X();const S=X(I.value.spaces[0]);return(C,j)=>($(),ne(t(Pe),{show:t(d).isProviderOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(y)},{default:N(()=>[a("div",Hr,[a("div",Br,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0"})]),_:1}),Fr,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(d).blurredInterface}])},[a("div",null,[a("div",zr,[a("div",Wr,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[jr,Vr]),_:1}),_(t(Se),{modelValue:t(d).useHocuspocus,"onUpdate:modelValue":j[0]||(j[0]=D=>t(d).useHocuspocus=D),class:L([t(d).useHocuspocus?"bg-green-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-green-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(d).useHocuspocus?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),($(),T("div",Gr,[a("div",null,[a("div",Kr,[($(!0),T(me,null,Re(t(I).spaces,D=>($(),T("div",{as:"template",key:D.id,onClick:R=>S.value=D.id},[a("div",{class:L([D.id!==S.value?"border-transparent":"border-gray-300 ring-2 ring-blue-600",D.id===t(s).params.space?" bg-blue-300 dark:bg-blue-600 bg-opacity-50 dark:bg-opacity-50":"","relative block border rounded-lg shadow-sm px-6 py-4 cursor-pointer sm:flex sm:justify-between focus:outline-none dark:bg-opacity-50 bg-opacity-50"])},[a("div",qr,[a("div",Zr,[a("div",Xr,se(D.name),1),D.url?($(),T("div",Yr,[a("p",Qr,se(D.url)+" / "+se(D.id),1),ei,ti])):K("",!0),S.value===D.id?($(),T("div",oi,[a("div",si,[ni,a("div",ai,[ze(a("input",{"onUpdate:modelValue":R=>D.url=R,tabindex:"0",type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"wss://causa.lity.cc"},null,8,ri),[[We,D.url]])])]),a("div",ii,[li,a("div",ci,[ze(a("input",{"onUpdate:modelValue":R=>D.token=R,type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"xxxx-xxxx-xxxx-xxxx"},null,8,di),[[We,D.token]])])]),ui,D.id!==t(s).params.space?($(),T("button",{key:0,type:"button",class:"mt-2 rounded-lg p-3 shadow-xl bg-blue-700 text-white bg-opacity-50",onClick:R=>{t(r).push(`/${D.id}/`),t(u)("selector")}}," Set as current Space ",8,pi)):K("",!0)])):K("",!0)])]),a("div",fi,[a("div",gi,"/"+se(D.id),1)]),a("div",{class:L([D.id===t(s).params.space?"border":"border-2",D.id===S.value?"border-white":"border-opacity-50","absolute -inset-px rounded-lg pointer-events-none"]),"aria-hidden":"true"},null,2)],2)],8,Jr))),128))])])])),K("",!0),K("",!0)])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),mi={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},bi={class:"text-center"},yi=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),vi={class:""},ki={key:0,class:"mt-2"},xi={class:"mt-2"},wi=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Display Name",-1),_i={class:"mt-1 relative rounded-md shadow-sm"},Si={class:"mt-2"},$i=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Color",-1),Ni={class:"mt-1 relative rounded-md shadow-sm"},Ci={class:"absolute inset-y-0 right-0 flex py-0.5 pr-1.5"},Di={type:"button",class:"-ml-px p-1 relative inline-flex items-center text-sm font-medium text-gray-600 dark:text-gray-200 focus:z-10 focus:outline-none"},Oi={class:"mt-4"},Ii={class:"flex justify-between","aria-label":"Tabs"},Ai=["onClick"],Ri=le({emits:["change"],setup(e,{emit:o}){de(),ge();const{state:s,toggleInfo:r,toggleProvider:d,toggleUser:i}=ae();X(),X();const y=[{color:"#00a492",current:!1},{color:"#00b1ff",current:!1},{color:"#ffc711",current:!1},{color:"#F98181",current:!1},{color:"#b7f981",current:!1},{color:"#81eff9",current:!1},{color:"#8183f9",current:!1},{color:"#d181f9",current:!1},{color:"#f9ab81",current:!1},{color:"#f9e181",current:!1}];return(c,u)=>($(),ne(t(Pe),{show:t(s).isUserOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(i)},{default:N(()=>[a("div",mi,[a("div",bi,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0"})]),_:1}),yi,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-80 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(s).blurredInterface}])},[a("div",null,[a("div",vi,[($(),T("div",ki,[a("div",xi,[wi,a("div",_i,[ze(a("input",{"onUpdate:modelValue":u[0]||(u[0]=I=>t(s).localUserName=I),type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"Name"},null,512),[[We,t(s).localUserName]])])]),a("div",Si,[$i,a("div",Ni,[ze(a("input",{"onUpdate:modelValue":u[1]||(u[1]=I=>t(s).localUserColor=I),type:"text",name:"lity-server",class:"h-8 bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg",placeholder:"Color"},null,512),[[We,t(s).localUserColor]]),a("div",Ci,[a("button",Di,[a("i",{class:"ri-paint-brush-fill text-2xl",style:et("color: "+t(s).localUserColor)},null,4)])])])]),a("div",Oi,[a("nav",Ii,[($(),T(me,null,Re(y,I=>a("span",{onClick:g=>t(s).localUserColor=I.color,key:I.color,style:et("cursor: pointer; background: "+I.color),class:L([[I.current?" text-gray-700":"text-gray-500 hover:text-gray-700","transition transition-opacity hover:opacity-50 px-3 py-2 font-medium text-sm rounded-md"],"inline-flex items-center justify-center h-8 w-8 rounded-full"])},null,14,Ai)),64))])])]))])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),Li={class:"fixed dark:bg-gray-900 bg-white bg-opacity-50 dark:bg-opacity-50 backdrop-filter backdrop-blur2 inset-0 z-50 overflow-y-auto"},Ti={class:"text-center"},Pi=a("span",{class:"hidden sm:inline-block sm:align-middle sm:h-screen","aria-hidden":"true"},"\u200B",-1),Ui={class:""},Ei={class:""},Mi={class:"mt-0"},Hi=a("span",{class:"text-sm font-medium text-gray-900 dark:text-gray-100"},"Share Gravity",-1),Bi=a("span",{class:"text-sm text-gray-500 dark:text-gray-400"}," (using WebRTC until restart)",-1),Fi={key:0,class:"mt-2"},zi=a("label",{for:"company-website",class:"block text-sm font-medium text-gray-700 dark:text-gray-200"},"Share Link",-1),Wi={class:"mt-1 relative rounded-md shadow-sm"},ji=["value"];const Vi=le({emits:["share","stop-sharing"],setup(e,{emit:o}){de(),ge();const{state:s,toggleShare:r}=ae();X(),X();const d=X(),i=window.location.href.match("(.*)#\\/(.+)\\/");return i&&i.length>1&&(d.value="https://dev.lity.cc/#/"+i[2]),(y,c)=>($(),ne(t(Pe),{show:t(s).isShareOpen,as:"template"},{default:N(()=>[_(t(Te),{as:"div",onClose:t(r)},{default:N(()=>[a("div",Li,[a("div",Ti,[_(t(ue),{as:"template",enter:"duration-50 ease-out","enter-from":"opacity-0","enter-to":"opacity-50",leave:"duration-50 ease-in","leave-from":"opacity-100","leave-to":"opacity-0"},{default:N(()=>[_(t(Le),{class:"fixed inset-0"})]),_:1}),Pi,_(t(ue),{as:"template",enter:"ease-out duration-50","enter-from":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95","enter-to":"opacity-100 translate-y-0 sm:scale-100",leave:"ease-in duration-50","leave-from":"opacity-100 translate-y-0 sm:scale-100","leave-to":"opacity-0 translate-y-4 sm:translate-y-0 sm:scale-95"},{default:N(()=>[a("div",{class:L(["inline-block align-bottom bg-white dark:text-white dark:bg-lityblack rounded-lg mt-16 px-4 pt-5 pb-4 text-left overflow-hidden shadow-xl transform transition-all m-3 sm:align-middle sm:max-w-md sm:w-full sm:p-6",{"bg-opacity-50 dark:bg-lityblackblur backdrop-filter backdrop-blur":t(s).blurredInterface}])},[a("div",null,[a("div",Ui,[a("div",Ei,[a("div",Mi,[_(t(we),{as:"div",class:"flex justify-between"},{default:N(()=>[_(t(_e),{as:"span",class:""},{default:N(()=>[Hi,Bi]),_:1}),_(t(Se),{modelValue:t(s).useWebRtc,"onUpdate:modelValue":c[0]||(c[0]=u=>t(s).useWebRtc=u),class:L([t(s).useWebRtc?"bg-blue-600":"bg-gray-200 dark:bg-gray-800","relative inline-flex flex-shrink-0 h-6 w-11 border-2 border-transparent rounded-full cursor-pointer transition-colors ease-in-out duration-200 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500"])},{default:N(()=>[a("span",{"aria-hidden":"true",class:L([t(s).useWebRtc?"translate-x-5":"translate-x-0","pointer-events-none inline-block h-5 w-5 rounded-full bg-white shadow transform ring-0 transition ease-in-out duration-200"])},null,2)]),_:1},8,["modelValue","class"])]),_:1})]),t(s).useWebRtc?($(),T("div",Fi,[zi,a("div",Wi,[a("input",{type:"text",name:"webrtc-password",readonly:"",value:d.value,class:"h-8on bg-white border-0 dark:bg-white dark:text-white bg-opacity-50 dark:bg-opacity-5 focus:ring-2 focus:ring-blue-600 text-lg shadow-lg bg-opacity-1 block w-full pl-3 py-5 rounded-lg select-all",placeholder:"Room Password"},null,8,ji)])])):K("",!0),(t(s).useWebRtc,K("",!0))])])])],2)]),_:1})])])]),_:1},8,["onClose"])]),_:1},8,["show"]))}}),Gi={class:"w-screen h-screen"},st={setup(e){const{redirect:o,isRedirected:s,spaceId:r,spaceUrl:d,spaceToken:i}=ot();return o(),(y,c)=>($(),T("div",Gi,[_(Mr),_(hi),_(Ri),_(Vi),t(s)?($(),ne(ur,{"space-id":t(r),key:t(r),"space-token":t(i),"space-url":t(d)},null,8,["space-id","space-token","space-url"])):K("",!0)]))}},Ki=[{path:"/",component:st},{path:"/:space",component:st},{path:"/:space/:document",component:st},{path:"/:space/:document/:node",component:st}],Ji=Bo({history:Fo(),linkActiveClass:"text-gray-900 font-bold",routes:Ki});var nt;(function(e){e.INCREMENT="INCREMENT",e.RESTORE="RESTORE"})(nt||(nt={}));const qi={[nt.INCREMENT](e,o=1){e.count+=o},[nt.RESTORE](e,o){o.localUserName&&(e.localUserName=o.localUserName),o.localUserColor&&(e.localUserColor=o.localUserColor),o.serverAddress&&(e.serverAddress=o.serverAddress),o.serverToken&&(e.serverToken=o.serverToken),o.v1&&(e.v1=o.v1)}};var Ue;(function(e){e.initApp="initApp",e.openInfo="openInfo",e.openSelector="openSelector",e.openSettings="openSettings",e.openSearch="openSearch"})(Ue||(Ue={}));const Zi={[Ue.initApp]({state:e,commit:o,dispatch:s}){},[Ue.openSelector]({state:e,commit:o,dispatch:s}){e.isSelectorOpen=!e.isSelectorOpen},[Ue.openInfo]({state:e,commit:o,dispatch:s}){e.isInfoOpen=!e.isInfoOpen},[Ue.openSettings]({state:e,commit:o,dispatch:s}){e.isSettingsOpen=!e.isSettingsOpen},[Ue.openSearch]({state:e,commit:o,dispatch:s}){e.isSearchOpen=!e.isSearchOpen}},Xi={isReady(e){return!e.isInitialized}},Yi="1.2.0",Qi={debug:!1,version:Yi,isInitialized:!1,isOffline:!1,count:0,localUserName:"",localUserColor:"",localUserId:"",serverAddress:"",serverToken:"",isSettingsOpen:!1,isInfoOpen:!1,isSelectorOpen:!1,isSearchOpen:!1,useRTC:!1,useHocuspocus:!0},el=zo({state:Qi,getters:Xi,mutations:qi,actions:Zi});const tl=60*60*1e3;Kt({onRegistered(e){e&&setInterval(()=>{e.update()},tl)}});const ol=Wo(),at=jo(Yo);at.use(el);at.use(Ji);at.use(ol);at.mount("#app");
